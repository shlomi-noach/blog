<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	
	xmlns:georss="http://www.georss.org/georss"
	xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
	
	>
<channel>
	<title>
	Comments on: A MyISAM backup is blocking as read-only, including mysqldump backup	</title>
	<atom:link href="https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup/feed" rel="self" type="application/rss+xml" />
	<link>https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup</link>
	<description>Blog by Shlomi Noach</description>
	<lastBuildDate>Mon, 06 Jun 2011 05:34:24 +0000</lastBuildDate>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.3.3</generator>
			<item>
				<title>
				By: Kevin				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup/comment-page-1#comment-42633</link>
		<dc:creator><![CDATA[Kevin]]></dc:creator>
		<pubDate>Mon, 06 Jun 2011 05:34:24 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2441#comment-42633</guid>
					<description><![CDATA[mysqlhotcopy is the fastest way with myisam though.. Such a shame there is nothing better.
In my country, i see some commercial websites that regularly close their site at 5am for about 1 hour, i presume they use MyIsam and are doing dumps.. I don&#039;t understand why some of them use it if they have the money to buy powerful enough systems to use Innodb with big databases (especially because innodb is so much better).
But in the case of a normal user, MyIsam is still the best choice when dealing with huge databases as it is much faster. The only pain in the *** is mysqldump.
I often check your site and hope that you publish a *magical* tool to work around this issue but it seems this is a hopeless problem lol.]]></description>
		<content:encoded><![CDATA[<p>mysqlhotcopy is the fastest way with myisam though.. Such a shame there is nothing better.<br />
In my country, i see some commercial websites that regularly close their site at 5am for about 1 hour, i presume they use MyIsam and are doing dumps.. I don&#8217;t understand why some of them use it if they have the money to buy powerful enough systems to use Innodb with big databases (especially because innodb is so much better).<br />
But in the case of a normal user, MyIsam is still the best choice when dealing with huge databases as it is much faster. The only pain in the *** is mysqldump.<br />
I often check your site and hope that you publish a *magical* tool to work around this issue but it seems this is a hopeless problem lol.</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: shlomi				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup/comment-page-1#comment-13815</link>
		<dc:creator><![CDATA[shlomi]]></dc:creator>
		<pubDate>Wed, 19 May 2010 12:04:53 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2441#comment-13815</guid>
					<description><![CDATA[See excerpt from mysqlhotcopy code:

[perl]
    # flush tables to make on-disk copy uptodate
    $start = time;
    $dbh-&#062;do(&#034;FLUSH TABLES /*!32323 $hc_tables */&#034;);
    printf &#034;Flushed tables ($hc_tables) in %d seconds.\n&#034;, time-$start unless $opt{quiet};
    $dbh-&#062;do( &#034;FLUSH LOGS&#034; ) if ( $opt{flushlog} );
    $dbh-&#062;do( &#034;RESET MASTER&#034; ) if ( $opt{resetmaster} );
    $dbh-&#062;do( &#034;RESET SLAVE&#034; ) if ( $opt{resetslave} );

    if ( $opt{record_log_pos} ) {
	record_log_pos( $dbh, $opt{record_log_pos} );
	$dbh-&#062;do(&#034;FLUSH TABLES /*!32323 $hc_tables */&#034;);
    }
[/perl]
]]></description>
		<content:encoded><![CDATA[<p>See excerpt from mysqlhotcopy code:</p>
<pre class="brush: perl; title: ; notranslate">
    # flush tables to make on-disk copy uptodate
    $start = time;
    $dbh-&gt;do(&quot;FLUSH TABLES /*!32323 $hc_tables */&quot;);
    printf &quot;Flushed tables ($hc_tables) in %d seconds.\n&quot;, time-$start unless $opt{quiet};
    $dbh-&gt;do( &quot;FLUSH LOGS&quot; ) if ( $opt{flushlog} );
    $dbh-&gt;do( &quot;RESET MASTER&quot; ) if ( $opt{resetmaster} );
    $dbh-&gt;do( &quot;RESET SLAVE&quot; ) if ( $opt{resetslave} );

    if ( $opt{record_log_pos} ) {
	record_log_pos( $dbh, $opt{record_log_pos} );
	$dbh-&gt;do(&quot;FLUSH TABLES /*!32323 $hc_tables */&quot;);
    }
</pre>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: shlomi				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup/comment-page-1#comment-13814</link>
		<dc:creator><![CDATA[shlomi]]></dc:creator>
		<pubDate>Wed, 19 May 2010 12:02:33 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2441#comment-13814</guid>
					<description><![CDATA[mysqlhotcopy is wrongly named. It should have been named mysqlwarmcopy.
It puts a read lock on all tables, along with flushing them, then does a file system copy.]]></description>
		<content:encoded><![CDATA[<p>mysqlhotcopy is wrongly named. It should have been named mysqlwarmcopy.<br />
It puts a read lock on all tables, along with flushing them, then does a file system copy.</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: Kostja Osipov				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup/comment-page-1#comment-13813</link>
		<dc:creator><![CDATA[Kostja Osipov]]></dc:creator>
		<pubDate>Wed, 19 May 2010 11:45:54 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2441#comment-13813</guid>
					<description><![CDATA[What about mysqlhotcopy?]]></description>
		<content:encoded><![CDATA[<p>What about mysqlhotcopy?</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: shlomi				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup/comment-page-1#comment-13811</link>
		<dc:creator><![CDATA[shlomi]]></dc:creator>
		<pubDate>Wed, 19 May 2010 10:59:22 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2441#comment-13811</guid>
					<description><![CDATA[@Pierre-Yves,

A few possibilities:
1. Corruption of data while writing/reading from relay logs. Google patches #4 added binary logs checksum, which solve this issue. but this is not available yet in MySQL.

2. Unsafe queries issued on the master, e.g.: 
DELETE FROM t WHERE a LIKE &#039;x%&#039; LIMIT 20;
In what order are rows being deleted? Depends on the storage engine, and depends on internal storing of rows. This query can delete different rows on master and slave.

3. Issues with unflushed binlogs in case of crash; or with open temp tables on slave in case of stopped slave; or with unflushed master.info file, etc. Some changes in 5.5 will solve many potential problems.

4. Someone issuing a query by mistake on the slave, thereby making it different than the master.

5. Just... bugs in the replication mechanism. Don&#039;t get me wrong, I&#039;m not saying replication is not good - but it can be susceptible to bugs.]]></description>
		<content:encoded><![CDATA[<p>@Pierre-Yves,</p>
<p>A few possibilities:<br />
1. Corruption of data while writing/reading from relay logs. Google patches #4 added binary logs checksum, which solve this issue. but this is not available yet in MySQL.</p>
<p>2. Unsafe queries issued on the master, e.g.:<br />
DELETE FROM t WHERE a LIKE &#8216;x%&#8217; LIMIT 20;<br />
In what order are rows being deleted? Depends on the storage engine, and depends on internal storing of rows. This query can delete different rows on master and slave.</p>
<p>3. Issues with unflushed binlogs in case of crash; or with open temp tables on slave in case of stopped slave; or with unflushed master.info file, etc. Some changes in 5.5 will solve many potential problems.</p>
<p>4. Someone issuing a query by mistake on the slave, thereby making it different than the master.</p>
<p>5. Just&#8230; bugs in the replication mechanism. Don&#8217;t get me wrong, I&#8217;m not saying replication is not good &#8211; but it can be susceptible to bugs.</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: Pierre-Yves				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup/comment-page-1#comment-13810</link>
		<dc:creator><![CDATA[Pierre-Yves]]></dc:creator>
		<pubDate>Wed, 19 May 2010 10:33:19 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2441#comment-13810</guid>
					<description><![CDATA[&quot;then either use replication – and take the risk of the slave not being in complete sync with the master&quot;

could you explain why the slave would not be in complete sync? (we have seen it happen) but why?]]></description>
		<content:encoded><![CDATA[<p>&#8220;then either use replication – and take the risk of the slave not being in complete sync with the master&#8221;</p>
<p>could you explain why the slave would not be in complete sync? (we have seen it happen) but why?</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: Mark Robson				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/a-myisam-backup-is-blocking-as-read-only-including-mysqldump-backup/comment-page-1#comment-13784</link>
		<dc:creator><![CDATA[Mark Robson]]></dc:creator>
		<pubDate>Tue, 18 May 2010 21:29:54 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2441#comment-13784</guid>
					<description><![CDATA[Yeah, that&#039;s right.

Also note that FLUSH TABLES, which sounds fairly harmless (i.e. it writes unwritten changes to disc), actually also flushes CLEAN blocks out of the key buffer, which means that after your backup finishes, your database read-performance will suck for some time as the key buffer will be totally cold.

There is no way of flushing only dirty blocks from the key buffer (which get kept indefinitely if you have DELAY_KEY_WRITE=1) - if you do a flush, it throws out clean ones too.]]></description>
		<content:encoded><![CDATA[<p>Yeah, that&#8217;s right.</p>
<p>Also note that FLUSH TABLES, which sounds fairly harmless (i.e. it writes unwritten changes to disc), actually also flushes CLEAN blocks out of the key buffer, which means that after your backup finishes, your database read-performance will suck for some time as the key buffer will be totally cold.</p>
<p>There is no way of flushing only dirty blocks from the key buffer (which get kept indefinitely if you have DELAY_KEY_WRITE=1) &#8211; if you do a flush, it throws out clean ones too.</p>
]]></content:encoded>
						</item>
			</channel>
</rss>
