<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	
	xmlns:georss="http://www.georss.org/georss"
	xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
	
	>
<channel>
	<title>
	Comments on: How often should you use OPTIMIZE TABLE? &#8211; followup	</title>
	<atom:link href="https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup/feed" rel="self" type="application/rss+xml" />
	<link>https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup</link>
	<description>Blog by Shlomi Noach</description>
	<lastBuildDate>Tue, 04 Aug 2015 10:02:47 +0000</lastBuildDate>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.3.3</generator>
			<item>
				<title>
				By: shlomi				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup/comment-page-1#comment-322508</link>
		<dc:creator><![CDATA[shlomi]]></dc:creator>
		<pubDate>Tue, 04 Aug 2015 10:02:47 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2882#comment-322508</guid>
					<description><![CDATA[Rick,
The data is real, the table is real. Unfortunately this is 5-year old data and I do not have access to it anymore.]]></description>
		<content:encoded><![CDATA[<p>Rick,<br />
The data is real, the table is real. Unfortunately this is 5-year old data and I do not have access to it anymore.</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: Rick James				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup/comment-page-1#comment-322214</link>
		<dc:creator><![CDATA[Rick James]]></dc:creator>
		<pubDate>Wed, 29 Jul 2015 22:20:11 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2882#comment-322214</guid>
					<description><![CDATA[Look at the index and leaf node page counts for `s` after OPTIMIZE.  705 non-leaf nodes.  That&#039;s a &quot;fanout&quot; of about 7:1.  That&#039;s terrible.  I would expect something like 400:1 since the index is BINARY(16)+INT = 20 bytes plus overhead.

So, either the stats are bogus, or the optimize does a lousy job of packing, or there are a lot of preallocated (but not yet used) blocks.  I wonder which it is?]]></description>
		<content:encoded><![CDATA[<p>Look at the index and leaf node page counts for `s` after OPTIMIZE.  705 non-leaf nodes.  That&#8217;s a &#8220;fanout&#8221; of about 7:1.  That&#8217;s terrible.  I would expect something like 400:1 since the index is BINARY(16)+INT = 20 bytes plus overhead.</p>
<p>So, either the stats are bogus, or the optimize does a lousy job of packing, or there are a lot of preallocated (but not yet used) blocks.  I wonder which it is?</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: shlomi				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup/comment-page-1#comment-22823</link>
		<dc:creator><![CDATA[shlomi]]></dc:creator>
		<pubDate>Fri, 10 Dec 2010 19:08:06 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2882#comment-22823</guid>
					<description><![CDATA[@Jason,

It is safe, in that the table is completely locked down for the duration of the ALTER operation. You can&#039;t read from it, you can&#039;t even look at it.

If you can guarantee no one will access this table, it also makes for an online operation. Otherwise, it is often undesired to work out on a working server, as so many connections get locked down, as well as table cache.]]></description>
		<content:encoded><![CDATA[<p>@Jason,</p>
<p>It is safe, in that the table is completely locked down for the duration of the ALTER operation. You can&#8217;t read from it, you can&#8217;t even look at it.</p>
<p>If you can guarantee no one will access this table, it also makes for an online operation. Otherwise, it is often undesired to work out on a working server, as so many connections get locked down, as well as table cache.</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: Jason				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup/comment-page-1#comment-22810</link>
		<dc:creator><![CDATA[Jason]]></dc:creator>
		<pubDate>Fri, 10 Dec 2010 17:12:46 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2882#comment-22810</guid>
					<description><![CDATA[Is it safe to run OPTIMIZE TABLE while the database is in use by an application?  Or does it need to be taken down and brought up with the &quot;skip-networking&quot; option so no can connect to it?]]></description>
		<content:encoded><![CDATA[<p>Is it safe to run OPTIMIZE TABLE while the database is in use by an application?  Or does it need to be taken down and brought up with the &#8220;skip-networking&#8221; option so no can connect to it?</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: shlomi				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup/comment-page-1#comment-18493</link>
		<dc:creator><![CDATA[shlomi]]></dc:creator>
		<pubDate>Tue, 05 Oct 2010 09:38:53 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2882#comment-18493</guid>
					<description><![CDATA[Daniel,
For InnoDB tables, OPTIMIZE maps to ALTER TABLE.
see &lt;a href=&quot;http://dev.mysql.com/doc/refman/5.1/en/optimize-table.html&quot; rel=&quot;nofollow&quot;&gt;manual&lt;/a&gt;]]></description>
		<content:encoded><![CDATA[<p>Daniel,<br />
For InnoDB tables, OPTIMIZE maps to ALTER TABLE.<br />
see <a href="http://dev.mysql.com/doc/refman/5.1/en/optimize-table.html" rel="nofollow">manual</a></p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: Daniël van Eeden				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup/comment-page-1#comment-18488</link>
		<dc:creator><![CDATA[Daniël van Eeden]]></dc:creator>
		<pubDate>Tue, 05 Oct 2010 08:57:50 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2882#comment-18488</guid>
					<description><![CDATA[What about a &#039;ALTER TABLE...ENGINE=InnoDB&#039; instead of a OPTIMIZE TABLE to reclaim space?]]></description>
		<content:encoded><![CDATA[<p>What about a &#8216;ALTER TABLE&#8230;ENGINE=InnoDB&#8217; instead of a OPTIMIZE TABLE to reclaim space?</p>
]]></content:encoded>
						</item>
						<item>
				<title>
				By: Morgan Tocker				</title>
				<link>https://shlomi-noach.github.io/blog/mysql/how-often-should-you-use-optimize-table-followup/comment-page-1#comment-18443</link>
		<dc:creator><![CDATA[Morgan Tocker]]></dc:creator>
		<pubDate>Mon, 04 Oct 2010 14:03:37 +0000</pubDate>
		<guid isPermaLink="false">https://shlomi-noach.github.io/blog/?p=2882#comment-18443</guid>
					<description><![CDATA[Hi Shlomi,

A couple of things to note:

- I would recommend using xtrabackup --stats to make an assessment on fragmentation.  See: http://www.mysqlperformanceblog.com/2009/09/14/statistics-of-innodb-tables-and-indexes-available-in-xtrabackup/

- I don&#039;t think it matters that you are truncating from the end of your primary key versus midway through a primary key.

(More related to the original blog post) What fragmentation OPTIMIZE will not help with, is if ID is monotonic, but (s), (name) and (origin) are not - or worst case are in complete opposite order.  As optimize creates it&#039;s temporary table, it will not pre-sort these indexes before creating them - so you have a trickle load of data that causes page splits straight away.]]></description>
		<content:encoded><![CDATA[<p>Hi Shlomi,</p>
<p>A couple of things to note:</p>
<p>&#8211; I would recommend using xtrabackup &#8211;stats to make an assessment on fragmentation.  See: <a href="http://www.mysqlperformanceblog.com/2009/09/14/statistics-of-innodb-tables-and-indexes-available-in-xtrabackup/" rel="nofollow ugc">http://www.mysqlperformanceblog.com/2009/09/14/statistics-of-innodb-tables-and-indexes-available-in-xtrabackup/</a></p>
<p>&#8211; I don&#8217;t think it matters that you are truncating from the end of your primary key versus midway through a primary key.</p>
<p>(More related to the original blog post) What fragmentation OPTIMIZE will not help with, is if ID is monotonic, but (s), (name) and (origin) are not &#8211; or worst case are in complete opposite order.  As optimize creates it&#8217;s temporary table, it will not pre-sort these indexes before creating them &#8211; so you have a trickle load of data that causes page splits straight away.</p>
]]></content:encoded>
						</item>
			</channel>
</rss>
