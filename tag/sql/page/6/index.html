<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	

	<title>SQL – Page 6 – code.openark.org</title>
<link rel="dns-prefetch" href="//secure.gravatar.com">
<link rel="dns-prefetch" href="//s.w.org">



<link rel="stylesheet" id="wp-block-library-css" href="https://shlomi-noach.github.io/blog/wp-includes/css/dist/block-library/style.min.css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="wp-polls-css" href="https://shlomi-noach.github.io/blog/wp-content/plugins/wp-polls/polls-css.css" media="all">
<style id="wp-polls-inline-css">
.wp-polls .pollbar {
	margin: 1px;
	font-size: 6px;
	line-height: 8px;
	height: 8px;
	background-image: url('https://shlomi-noach.github.io/blog/wp-content/plugins/wp-polls/images/default/pollbg.gif');
	border: 1px solid #c8c8c8;
}

</style>
<link rel="stylesheet" id="openark-primer-style-css" href="https://shlomi-noach.github.io/blog/wp-content/themes/openark-primer/style.css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="https://shlomi-noach.github.io/blog/wp-content/plugins/jetpack/css/jetpack.css" media="all">
<script src="https://shlomi-noach.github.io/blog/wp-includes/js/jquery/jquery.js"></script>
<script src="https://shlomi-noach.github.io/blog/wp-includes/js/jquery/jquery-migrate.min.js"></script>



<style data-context="foundation-flickity-css">/*! Flickity v2.0.2
http://flickity.metafizzy.co
---------------------------------------------- */.flickity-enabled{position:relative}.flickity-enabled:focus{outline:0}.flickity-viewport{overflow:hidden;position:relative;height:100%}.flickity-slider{position:absolute;width:100%;height:100%}.flickity-enabled.is-draggable{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.flickity-enabled.is-draggable .flickity-viewport{cursor:move;cursor:-webkit-grab;cursor:grab}.flickity-enabled.is-draggable .flickity-viewport.is-pointer-down{cursor:-webkit-grabbing;cursor:grabbing}.flickity-prev-next-button{position:absolute;top:50%;width:44px;height:44px;border:none;border-radius:50%;background:#fff;background:hsla(0,0%,100%,.75);cursor:pointer;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.flickity-prev-next-button:hover{background:#fff}.flickity-prev-next-button:focus{outline:0;box-shadow:0 0 0 5px #09f}.flickity-prev-next-button:active{opacity:.6}.flickity-prev-next-button.previous{left:10px}.flickity-prev-next-button.next{right:10px}.flickity-rtl .flickity-prev-next-button.previous{left:auto;right:10px}.flickity-rtl .flickity-prev-next-button.next{right:auto;left:10px}.flickity-prev-next-button:disabled{opacity:.3;cursor:auto}.flickity-prev-next-button svg{position:absolute;left:20%;top:20%;width:60%;height:60%}.flickity-prev-next-button .arrow{fill:#333}.flickity-page-dots{position:absolute;width:100%;bottom:-25px;padding:0;margin:0;list-style:none;text-align:center;line-height:1}.flickity-rtl .flickity-page-dots{direction:rtl}.flickity-page-dots .dot{display:inline-block;width:10px;height:10px;margin:0 8px;background:#333;border-radius:50%;opacity:.25;cursor:pointer}.flickity-page-dots .dot.is-selected{opacity:1}</style><style data-context="foundation-slideout-css">.slideout-menu{position:fixed;left:0;top:0;bottom:0;right:auto;z-index:0;width:256px;overflow-y:auto;-webkit-overflow-scrolling:touch;display:none}.slideout-menu.pushit-right{left:auto;right:0}.slideout-panel{position:relative;z-index:1;will-change:transform}.slideout-open,.slideout-open .slideout-panel,.slideout-open body{overflow:hidden}.slideout-open .slideout-menu{display:block}.pushit{display:none}</style>
<link rel="dns-prefetch" href="//v0.wordpress.com">


<meta property="og:type" content="website">
<meta property="og:title" content="SQL – Page 6 – code.openark.org">
<meta property="og:url" content="https://shlomi-noach.github.io/blog/tag/sql">
<meta property="og:site_name" content="code.openark.org">
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg">
<meta property="og:locale" content="en_US">


<style>.ios7.web-app-mode.has-fixed header{ background-color: rgba(242,101,34,.88);}</style></head>

<body class="archive paged tag tag-sql tag-21 paged-6 tag-paged-6 hfeed no-sidebar">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#primary">Skip to content</a>

	<header id="masthead" class="site-header">
		<div class="site-branding">
							<p class="site-title"><a href="https://shlomi-noach.github.io/blog/" rel="home">code.openark.org</a></p>
								<p class="site-description">Blog by Shlomi Noach</p>
			
			<nav id="site-navigation" class="main-navigation">
				<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">primary-menu</button>
				<div class="menu-primary-menu-container"><ul id="menu-primary-menu" class="menu"><li id="menu-item-8109" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8109"><a href="https://shlomi-noach.github.io/blog/archives">archives</a></li>
<li id="menu-item-8050" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8050"><a href="https://shlomi-noach.github.io/blog/presentations">presentations</a></li>
<li id="menu-item-8055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8055"><a href="https://shlomi-noach.github.io/blog/about">about</a></li>
<li id="menu-item-8071" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8071"><a href="https://github.com/shlomi-noach"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a></li>
<li id="menu-item-8074" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8074"><a href="https://www.linkedin.com/in/shlominoach"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg></a></li>
<li id="menu-item-8072" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8072"><a href="https://twitter.com/ShlomiNoach"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z"></path></svg></a></li>
<li id="menu-item-8073" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8073"><a href="https://shlomi-noach.github.io/blog/feed"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-12.832 20c-1.197 0-2.168-.969-2.168-2.165s.971-2.165 2.168-2.165 2.167.969 2.167 2.165-.97 2.165-2.167 2.165zm5.18 0c-.041-4.029-3.314-7.298-7.348-7.339v-3.207c5.814.041 10.518 4.739 10.561 10.546h-3.213zm5.441 0c-.021-7.063-5.736-12.761-12.789-12.792v-3.208c8.83.031 15.98 7.179 16 16h-3.211z"></path></svg></a></li>
</ul></div>			</nav>
		</div>
	</header>

	<main id="primary" class="site-main">

		
			<header class="page-header">
				<h1 class="page-title">Tag: SQL</h1>			</header>

			
<article id="post-1666" class="post-1666 post type-post status-publish format-standard hentry category-mysql tag-data-types tag-indexing tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/useful-temporal-functions-queries" rel="bookmark">Useful temporal functions & queries</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/data-types" rel="tag">Data Types</a><a href="https://shlomi-noach.github.io/blog/tag/indexing" rel="tag">Indexing</a><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/useful-temporal-functions-queries" rel="bookmark"><time class="entry-date published updated" datetime="2009-12-08T11:46:24+02:00">December 8, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>Here’s a complication of some common and useful time & date calculations and equations. Some, though very simple, are often misunderstood, leading to inefficient or incorrect implementations.</p>
<p>There are many ways to solve such problems. I’ll present my favorites.</p>
<h4>Querying for time difference</h4>
<p>Given two timestamps: <em>ts1</em> (older) and <em>ts2</em> (newer), how much time has passed between them?</p>
<p>One can use <strong>TIMEDIFF()</strong> & <strong>DATEDIFF()</strong>, or compare two <strong>UNIX_TIMESTAMP()</strong> values. My personal favorite is to use <strong>TIMESTAMPDIFF()</strong>. Reason being that I’m usually interested in a specific metric, like the number of hours which have passed, or the number of days, disregarding the smaller minute/second resolution. Which allows one to:</p>
<blockquote>
<pre>SELECT TIMESTAMPDIFF(HOUR, ts1, ts2)</pre>
</blockquote>
<p>Take, for example:</p>
<blockquote>
<pre>SELECT TIMESTAMPDIFF(MONTH, '2008-10-07 00:00:00', '2009-12-06 00:00:00')</pre>
</blockquote>
<p>The function correctly identifies the number of days per month, and provides with <strong>13</strong>, being the truncated number of full months.</p>
<h4>Doing arithmetics</h4>
<p>One can use <strong>TIMESTAMPADD()</strong>, or <strong>DATE_SUB()</strong>, but, again, when dealing with specific resolutions, I find “<strong>+ INTERVAL</strong>” to be the most convenient:</p>
<blockquote>
<pre>SELECT ts1 + INTERVAL 10 HOUR</pre>
</blockquote>
<p> <a href="https://shlomi-noach.github.io/blog/mysql/useful-temporal-functions-queries#more-1666" class="more-link">Continue reading »<span class="screen-reader-text"> “Useful temporal functions & queries”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/useful-temporal-functions-queries#respond">Leave a Comment<span class="screen-reader-text"> on Useful temporal functions & queries</span></a></span>	</footer>
</article>

<article id="post-1400" class="post-1400 post type-post status-publish format-standard hentry category-mysql tag-graphs tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/sql-multi-line-chart" rel="bookmark">SQL multi line chart</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/graphs" rel="tag">Graphs</a><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/sql-multi-line-chart" rel="bookmark"><time class="entry-date published" datetime="2009-11-03T12:44:13+02:00">November 3, 2009</time><time class="updated" datetime="2009-11-03T14:15:18+02:00">November 3, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>Time for another charting SQL query. I wish to present a single-query generated multi-line/area chart. I’ll walk through some of the steps towards making this happen. By the end of this post I’ll present some real-data charts, area charts and colored charts.</p>
<blockquote>
<pre>+---------+-----------------------------------------------------------------------------------+
| y_scale | chart                                                                             |
+---------+-----------------------------------------------------------------------------------+
| 1       | ****---------#######----------------------------------------*******--------###### |
| 0.88    | ----***---###-------##-----------------------------------***-------***---##------ |
| 0.75    | -------**#------------##-------------------------------**-------------*##-------- |
| 0.63    | ------##-*--------------##----------------------------*--------------##**-------- |
| 0.5     | -@@@@@@@@@@@@@@@----------#-----@@@@@@@@@@@@@@@@----**---------@@@@@@@@@@@@@@@@-- |
| 0.38    | ----#-------*--------------##----------------------*---------------#-------*----- |
| 0.25    | --##---------*---------------#--------------------*--------------##---------*---- |
| 0.13    | -#------------**--------------#-----------------**--------------#------------*--- |
| 0       | @---------------*--------------##--------------*---------------#--------------**- |
| -0.12   | -----------------*---------------#------------*--------------##-----------------* |
| -0.25   | ------------------*---------------#---------**--------------#-------------------- |
| -0.37   | -------------------**--------------#-------*---------------#--------------------- |
| -0.5    | ----------------@@@@@@@@@@@@@@@@----##----*-----@@@@@@@@@@@@@@@----------------@@ |
| -0.62   | ----------------------**--------------#-**--------------#------------------------ |
| -0.75   | ------------------------**------------**#-------------##------------------------- |
| -0.87   | --------------------------**-------***---###-------###--------------------------- |
| -1      | ----------------------------*******---------#######------------------------------ |
|         | v:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::v |
|         | 0                                                                               8 |
|         |     # sin(x)                                                                      |
|         |     * cos(x)                                                                      |
|         |     @ sign(tan(x))/2                                                              |
+---------+-----------------------------------------------------------------------------------+</pre>
</blockquote>
<h4> <a href="https://shlomi-noach.github.io/blog/mysql/sql-multi-line-chart#more-1400" class="more-link">Continue reading »<span class="screen-reader-text"> “SQL multi line chart”</span></a></h4>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/sql-multi-line-chart#comments">4 Comments<span class="screen-reader-text"> on SQL multi line chart</span></a></span>	</footer>
</article>

<article id="post-895" class="post-895 post type-post status-publish format-standard hentry category-mysql tag-information_schema tag-innodb tag-performance tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/how-to-calculate-a-good-innodb-log-file-size-recap" rel="bookmark">How to calculate a good InnoDB log file size – recap</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/information_schema" rel="tag">INFORMATION_SCHEMA</a><a href="https://shlomi-noach.github.io/blog/tag/innodb" rel="tag">InnoDB</a><a href="https://shlomi-noach.github.io/blog/tag/performance" rel="tag">Performance</a><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/how-to-calculate-a-good-innodb-log-file-size-recap" rel="bookmark"><time class="entry-date published" datetime="2009-10-20T21:04:40+02:00">October 20, 2009</time><time class="updated" datetime="2009-12-16T09:09:31+02:00">December 16, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>Following Baron Schwartz’ post: <a href="http://www.mysqlperformanceblog.com/2008/11/21/how-to-calculate-a-good-innodb-log-file-size/">How to calculate a good InnoDB log file size</a>, which shows how to make an estimate for the InnoDB log file size, and based on <a href="https://shlomi-noach.github.io/blog/mysql/sql-querying-for-status-difference-over-time">SQL: querying for status difference over time</a>, I’ve written a query to run on MySQL 5.1, which, upon sampling 60 seconds of status, estimates the InnoDB transaction log bytes that are expected to be written in the period of 1 hour.</p>
<p><em>Recap</em>: this information can be useful if you’re looking for a good <strong>innodb_log_file_size</strong> value, such that will not pose too much I/O (smaller values will make for more frequent flushes), not will make for a too long recovery time (larger values mean more transactions to recover upon crash).</p>
<p>It is assumed that the 60 seconds period represents an average system load, not some activity spike period. Edit the sleep time and factors as you will to sample longer or shorter periods. <a href="https://shlomi-noach.github.io/blog/mysql/how-to-calculate-a-good-innodb-log-file-size-recap#more-895" class="more-link">Continue reading »<span class="screen-reader-text"> “How to calculate a good InnoDB log file size – recap”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/how-to-calculate-a-good-innodb-log-file-size-recap#comments">11 Comments<span class="screen-reader-text"> on How to calculate a good InnoDB log file size – recap</span></a></span>	</footer>
</article>

<article id="post-945" class="post-945 post type-post status-publish format-standard hentry category-mysql tag-information_schema tag-monitoring tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/sql-querying-for-status-difference-over-time" rel="bookmark">SQL: querying for status difference over time</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/information_schema" rel="tag">INFORMATION_SCHEMA</a><a href="https://shlomi-noach.github.io/blog/tag/monitoring" rel="tag">Monitoring</a><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/sql-querying-for-status-difference-over-time" rel="bookmark"><time class="entry-date published updated" datetime="2009-10-20T11:31:43+02:00">October 20, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>The InnoDB plugin has a nice <strong>INFORMATION_SCHEMA</strong> concept: resetting tables. For example, the <strong>INNODB_CMP</strong> table lists information about compression operation. A similar table, <strong>INNODB_CMP_RESET</strong>, provides the same information, but resets the values. The latter can be used to measure, for example, number of compression operations over time.</p>
<p>I wish to present a SQL trick which does the same, without need for resetting tables. Suppose you have some status table, and you wish to measure the change in status per second, per minute etc. The trick is to query for the value twice in the same query, with some pause in between, and make the difference calculation.</p>
<p>For sake of simplicity, I’ll demonstrate using 5.1’s <strong>INFORMATION_SCHEMA.GLOBAL_STATUS</strong>. Please refer to <a href="https://shlomi-noach.github.io/blog/mysql/information_schema-global_status-watch-out">INFORMATION_SCHEMA.GLOBAL_STATUS: watch out</a> for some discussion on this.</p>
<p> <a href="https://shlomi-noach.github.io/blog/mysql/sql-querying-for-status-difference-over-time#more-945" class="more-link">Continue reading »<span class="screen-reader-text"> “SQL: querying for status difference over time”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/sql-querying-for-status-difference-over-time#comments">1 Comment<span class="screen-reader-text"> on SQL: querying for status difference over time</span></a></span>	</footer>
</article>

<article id="post-1330" class="post-1330 post type-post status-publish format-standard hentry category-mysql tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join-revisited" rel="bookmark">SQL: ranking without self join, revisited</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join-revisited" rel="bookmark"><time class="entry-date published" datetime="2009-09-25T04:02:08+02:00">September 25, 2009</time><time class="updated" datetime="2009-09-25T15:20:52+02:00">September 25, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>This post follows <a title="Link to SQL: Ranking without self join" rel="bookmark" href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join">SQL: Ranking without self join</a> and <a title="Link to On user variables evaluation order" rel="bookmark" href="https://shlomi-noach.github.io/blog/mysql/on-user-variables-evaluation-order">On user variables evaluation order</a>. I wish to share some insights with regard to user variables evaluation, as well as provide <em>yet another</em> ranking solution, which attempts to overcome the uncertainty factor with user variables.</p>
<p>There will be hand waving in this post (albeit empirical hand waving). Stop here if you don’t like hand waving. Continue if you feel curious or wish to contradict my assumptions.</p>
<h4>Recap</h4>
<p>The order of evaluation of user variables is undefined. The documentation has some contradicting example (bug <a href="http://bugs.mysql.com/bug.php?id=47514">47514</a>), but states that variables should not be read and assigned in different parts of the same statement (just <em>what is</em> a different part? Bug <a href="http://bugs.mysql.com/bug.php?id=47516">47516</a>).</p>
<h4>Looking for a solution</h4>
<p>There doesn’t seem to be a problem with reading and assigning variables in the very same part of the statement. For example, <strong>SELECT @a := @a+1</strong>… is exactly such a case.</p>
<p> <a href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join-revisited#more-1330" class="more-link">Continue reading »<span class="screen-reader-text"> “SQL: ranking without self join, revisited”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join-revisited#comments">9 Comments<span class="screen-reader-text"> on SQL: ranking without self join, revisited</span></a></span>	</footer>
</article>

<article id="post-1293" class="post-1293 post type-post status-publish format-standard hentry category-mysql tag-execution-plan tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join" rel="bookmark">SQL: Ranking without self join</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/execution-plan" rel="tag">Execution plan</a><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join" rel="bookmark"><time class="entry-date published updated" datetime="2009-09-14T18:16:11+02:00">September 14, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>The common way of solving the classic SQL problem of ranking, involves a  self join. I wish to present a different solution, which only iterates the table once, and provides the same output.</p>
<h4>The ranking problem</h4>
<p>Given a table with names and scores (e.g. students exams scores), add rank for each row, such that the rank identifies her position among other rows. Rows with identical scores should receive the same rank (e.g. both contenders got the silver medal).</p>
<p>Consider the following table (download <a href="https://shlomi-noach.github.io/blog/wp-content/uploads/2009/09/score.sql">score.sql</a>):</p>
<blockquote>
<pre>mysql> select * from score;
+----------+--------------+-------+
| score_id | student_name | score |
+----------+--------------+-------+
|        1 | Wallace      |    95 |
|        2 | Gromit       |    97 |
|        3 | Shaun        |    85 |
|        4 | McGraw       |    92 |
|        5 | Preston      |    92 |
+----------+--------------+-------+
5 rows in set (0.00 sec)</pre>
</blockquote>
<p>We wish to present ranks in some way similar to:</p>
<blockquote>
<pre>+----------+--------------+-------+------+
| score_id | student_name | score | rank |
+----------+--------------+-------+------+
|        2 | Gromit       |    97 |    1 |
|        1 | Wallace      |    95 |    2 |
|        4 | McGraw       |    92 |    3 |
|        5 | Preston      |    92 |    3 |
|        3 | Shaun        |    85 |    4 |
+----------+--------------+-------+------+</pre>
</blockquote>
<p> <a href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join#more-1293" class="more-link">Continue reading »<span class="screen-reader-text"> “SQL: Ranking without self join”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/sql-ranking-without-self-join#comments">35 Comments<span class="screen-reader-text"> on SQL: Ranking without self join</span></a></span>	</footer>
</article>

<article id="post-1148" class="post-1148 post type-post status-publish format-standard hentry category-mysql tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/generating-numbers-out-of-seemingly-thin-air" rel="bookmark">Generating numbers out of seemingly thin air</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/generating-numbers-out-of-seemingly-thin-air" rel="bookmark"><time class="entry-date published" datetime="2009-09-01T08:40:24+02:00">September 1, 2009</time><time class="updated" datetime="2009-09-01T08:45:06+02:00">September 1, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>In some of my previous posts I’ve used a <strong>numbers</strong> table, like one holding values <strong>1, 2, 3, …, 255</strong>. Such table can be used for string walking, joining with other tables, performing iterations.</p>
<p>The existence of number tables has always been a little pain. Yes, they’re very, <em>very</em> simple, but they <em>need to be there</em>. So if you just need to script some SQL query, you may find that you need to create such tables. Ummm… this means you need to have privileges (at least <strong>CREATE TEMPORARY</strong> and <strong>INSERT</strong>, if not <strong>CREATE</strong>).</p>
<p>The other day, Baron Schwartz posted <a href="http://www.xaprb.com/blog/2009/08/09/how-to-round-to-the-nearest-whole-multiple-or-fraction-in-sql/">How to round to the nearest whole multiple or fraction in SQL</a>. In an offhand way, he generated some random numbers using the <strong>mysql.help_topic</strong> table. I then realized that post solved something I’ve been looking for: using a sure-to-exist table on any MySQL installation.</p>
<p> <a href="https://shlomi-noach.github.io/blog/mysql/generating-numbers-out-of-seemingly-thin-air#more-1148" class="more-link">Continue reading »<span class="screen-reader-text"> “Generating numbers out of seemingly thin air”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/generating-numbers-out-of-seemingly-thin-air#comments">9 Comments<span class="screen-reader-text"> on Generating numbers out of seemingly thin air</span></a></span>	</footer>
</article>

<article id="post-1093" class="post-1093 post type-post status-publish format-standard hentry category-mysql tag-graphs tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/sql-pie-chart" rel="bookmark">SQL pie chart</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/graphs" rel="tag">Graphs</a><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/sql-pie-chart" rel="bookmark"><time class="entry-date published updated" datetime="2009-08-12T12:49:41+02:00">August 12, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>My other half says I’m losing it. But I think that as an enthusiast kernel developer she doesn’t have the right to criticize people. (“I like user space better!” – she exclaims upon reading this).</p>
<p>Shown below is a (single query) SQL-generated pie chart. I will walk through the steps towards making this happen, and conclude with what, I hope you’ll agree, are real-world, useful usage samples.</p>
<blockquote>
<pre>+----------------------------------------------------------------------+
| pie_chart                                                            |
+----------------------------------------------------------------------+
|                                                                      |
|                         ;;;;;;;;;;;;;;;;;;;;;                        |
|                  oooooooo;;;;;;;;;;;;;;;;;;;;;;;;;;;                 |
|             oooooooooooooo;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;            |
|          ooooooooooooooooo                 ;;;;;;;;;;;;#####         |
|        oooooooooooooo                           ;#############       |
|       oooooooooooo                                 ############      |
|      oooooooooooo                                   ############     |
|      ooooooooooo                                     ###########     |
|      oooooooooooo                                   ::::::::::::     |
|       oooooooooooo                                 ::::::::::::      |
|        ooooooooo:::::                           ::::::::::::::       |
|          o::::::::::::::::                 :::::::::::::::::         |
|             :::::::::::::::::::::::::::::::::::::::::::::            |
|                  :::::::::::::::::::::::::::::::::::                 |
|                         :::::::::::::::::::::                        |
|                                                                      |
| ##  red: 1 (10%)                                                     |
| ;;  blue: 2 (20%)                                                    |
| oo  orange: 3 (30%)                                                  |
| ::  white: 4 (40%)                                                   |
+----------------------------------------------------------------------+</pre>
</blockquote>
<h4>Requirements</h4>
<p>We need a generic query, which returns at least these two columns: <strong>name_column</strong> and <strong>value_column</strong>. For example, the following query will do: <a href="https://shlomi-noach.github.io/blog/mysql/sql-pie-chart#more-1093" class="more-link">Continue reading »<span class="screen-reader-text"> “SQL pie chart”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/sql-pie-chart#comments">80 Comments<span class="screen-reader-text"> on SQL pie chart</span></a></span>	</footer>
</article>

<article id="post-1097" class="post-1097 post type-post status-publish format-standard hentry category-mysql tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/sql-graphics" rel="bookmark">SQL graphics</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/sql-graphics" rel="bookmark"><time class="entry-date published updated" datetime="2009-08-11T14:24:32+02:00">August 11, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>SQL is not meant to generate graphics, for sure; but I see some cases where generating non-tabular output can be desirable, as I will show in future posts.</p>
<p>I’d like to explain the basics of working SQL graphics: it is actually possible to do whatever you like. How?</p>
<h4>Coordinates system</h4>
<p>We’ll now develop a coordinates system using SQL. By producing this, I will have proven my point that anything is possible, and will provide an additional proof of concept.</p>
<p>To start with generating coordinates, I’ll need a helper table: a numbers table (<a href="https://shlomi-noach.github.io/blog/wp-content/uploads/2009/08/tinyint_asc.sql">tinyint_asc</a>, example, with numbers ranging 0..255).</p>
<p>We’ll strive to produce a 10×10 coordinate matrix. To do this, we’ll self-join the numbers table against itself, and use a helper variable to set the size of the matrix. <a href="https://shlomi-noach.github.io/blog/mysql/sql-graphics#more-1097" class="more-link">Continue reading »<span class="screen-reader-text"> “SQL graphics”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/sql-graphics#comments">6 Comments<span class="screen-reader-text"> on SQL graphics</span></a></span>	</footer>
</article>

<article id="post-1050" class="post-1050 post type-post status-publish format-standard hentry category-mysql tag-graphs tag-sql">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/auto-scaling-scaled-sql-graphs-concluded" rel="bookmark">Auto scaling, scaled SQL graphs concluded</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/graphs" rel="tag">Graphs</a><a href="https://shlomi-noach.github.io/blog/tag/sql" rel="tag">SQL</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/auto-scaling-scaled-sql-graphs-concluded" rel="bookmark"><time class="entry-date published updated" datetime="2009-07-28T14:38:08+02:00">July 28, 2009</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>I wasn’t sure I was to go this far. After catching breath the following have been added to <a href="https://shlomi-noach.github.io/blog/mysql/generic-auto-scaling-scaled-sql-graphs">Generic, auto scaling, scaled SQL graphs</a>, and these will conclude my current hacks:</p>
<ul>
<li>Displaying X-axis min/max values.</li>
<li>Support for Y-axis values precision.</li>
<li>Support for pre-defined scale range.</li>
</ul>
<p>The addition of the above makes for presentable, usable graphs. See also sample graphs at the end of this post.</p>
<h4>Step 8: adding X-axis values</h4>
<p>I add minimum/maximum X-scale values to the graph. What was just <strong>ordering_column</strong> before, now turns to be the <strong>x</strong> in the <strong>y = f(x)</strong> function. <a href="https://shlomi-noach.github.io/blog/mysql/auto-scaling-scaled-sql-graphs-concluded#more-1050" class="more-link">Continue reading »<span class="screen-reader-text"> “Auto scaling, scaled SQL graphs concluded”</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/auto-scaling-scaled-sql-graphs-concluded#comments">8 Comments<span class="screen-reader-text"> on Auto scaling, scaled SQL graphs concluded</span></a></span>	</footer>
</article>

	<nav class="navigation posts-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Posts navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://shlomi-noach.github.io/blog/tag/sql/page/7">Older posts</a></div><div class="nav-next"><a href="https://shlomi-noach.github.io/blog/tag/sql/page/5">Newer posts</a></div></div>
	</nav>
	</main>


	<footer id="colophon" class="site-footer">
		<div class="site-info">
			<a href="https://wordpress.org/">
				Powered by WordPress			</a>
			<span class="sep"> | </span>
				Theme: <a href="http://openark.org">openark-primer</a> by <a href="http://underscores.me/">Underscores.me</a>.		</div>
	</footer>
</div>

	<div style="display:none">
	</div>
<script>
var pollsL10n = {"ajax_url":"https:\/\/shlomi-noach.github.io\/blog\/wp-admin\/admin-ajax.php","text_wait":"Your last request is still being processed. Please wait a while ...","text_valid":"Please choose a valid poll answer.","text_multiple":"Maximum number of choices allowed: ","show_loading":"1","show_fading":"1"};
</script>
<script src="https://shlomi-noach.github.io/blog/wp-content/plugins/wp-polls/polls-js.js"></script>
<script src="https://secure.gravatar.com/js/gprofiles.js?ver=2020Junaa"></script>
<script>
var WPGroHo = {"my_hash":""};
</script>
<script src="https://shlomi-noach.github.io/blog/wp-content/plugins/jetpack/modules/wpgroho.js"></script>
<script src="https://shlomi-noach.github.io/blog/wp-content/themes/openark-primer/js/navigation.js"></script>
<script src="https://shlomi-noach.github.io/blog/wp-content/themes/openark-primer/js/skip-link-focus-fix.js"></script>
<script type="text/javascript" src="https://stats.wp.com/e-202024.js" async="async" defer></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:8.2.1',blog:'32412571',post:'0',tz:'2',srv:'code.openark.org'} ]);
	_stq.push([ 'clickTrackerInit', '32412571', '0' ]);
</script>

</body>
</html>
