<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.16" />

  <title>code.openark.org</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/blog/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/blog/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  
  <link rel="alternate" type="application/rss+xml" title="code.openark.org" href="/blog/index.xml" />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/blogimg/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <a class="pure-menu-heading brand" href="/blog">openark.org</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/page/about"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
      <li class="pure-menu-item">
        <a class="pure-menu-link" href="/blog/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">
    <li class="pure-menu-item">
      <a class="pure-menu-link">
        Shlomi Noach
        
          <div class="avatar-container">
        	  <div class="avatar-img-border">
                <img class="avatar-img" src="/blog/images/shlomi-noach.png" alt="code.openark.org" />
        	  </div>
        	</div>
        
      </a>
    </li>

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/shlomi-noach" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/ShlomiNoach" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/shlominoach" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>





  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>code.openark.org</h1>
  <h2>Software musings by Shlomi Noach</h2>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="/blog/mysql/mysql-conference-2009-daily-summary-wednesday/">MySQL Conference 2009 daily summary: Wednesday</a></h2>

    <div class="post-meta">

  <div>

    <time>24 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blogtags/mysqlconf">mysqlconf</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Busy day again: today the Percona conference joined the regular schedule, so more stuff to attend!</p>
<p>What did I attend?</p>
<p>Maria In Depth, Monty Widenius, MontyProgram AB (Percona conference): Monty was discussing Maria performance-wise as opposed to his later session which was feature-wise). He did delve just a little bit into the decision making issues in MySQL and in his new company. He also spoke (and I believe this took the most weight of the session, even if not the most time) of his new company, what he wants to achieve and how.</p>
<p><a href="http://www.mysqlconf.com/mysql2009/public/schedule/detail/6876">Build Your Own MySQL Time Machine</a>, (Sun Microsystems), Mats Kindahl (Sun Microsystems). A web based utility for creating online backups and performing a point in time restoration was presented. The system is based on MySQL 6.0&rsquo;s new backup mechanism, and runs on a slave. The presenters showed how easy it would be to say &ldquo;I would like to restore data to as it was yesterday 14:56pm&rdquo;. Hope to see such final product in the future!</p>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mysql-conference-2009-daily-summary-wednesday/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/mysql-conference-2009-daily-summary-tuesday/">MySQL Conference 2009 daily summary: Tuesday</a></h2>

    <div class="post-meta">

  <div>

    <time>22 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blogtags/mysqlconf">mysqlconf</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Tuesday: day of the announcements and of numerous sessions. Busy day!</p>
<p>The day started with the <a href="http://www.mysqlconf.com/mysql2009/public/schedule/detail/8233">State of the Dolphin</a> by Karen Padir (Sun Microsystems). She threw in some announcement, among which were MySQL 5.4, MySQL Cluster 7.0, better release cycles (matching the Enterprise), better code import from the community. Anyway, there is already a lot of talk about that.</p>
<p>Later on, <a href="http://www.mysqlconf.com/mysql2009/public/schedule/detail/7996">This is Not a Web App: The Evolution of a MySQL Deployment at Google</a>, Mark Callaghan (Google) was a very interesting session, in which Mark described the needs for an enterprise database Google and (mysterious) others had, and the steps taken to modify MySQL in this direction. Mark explained the build &amp; test process they use at Google, teased the MySQL Query Analyzer guys (&ldquo;it&rsquo;s amazing what you can do with sed &amp; awk, actually&rdquo;) - though expressed his appreciation of their work, and mentioned various contributors and collaborators. It was an interesting session, very wide in scope, I think.</p>
<p>The rest of my schedule for the day was:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mysql-conference-2009-daily-summary-tuesday/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/mysql-conference-2009-community-awards/">MySQL Conference 2009 Community Awards</a></h2>

    <div class="post-meta">

  <div>

    <time>22 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blogtags/mysqlconf">mysqlconf</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>OK. That was a surprise!</p>
<p>In retrospective, there have been some hints along the way. But I don&rsquo;t get hints. I&rsquo;m the kind of man who, when watching a complicated movie, needs his girlfriend to explain him what goes on.</p>
<p>I was utterly astonished and honored to find my name on the screen, and have me being one of three people called to accept the MySQL Community Award for 2009.</p>
<p>Let me tell you: it is <em>heavy</em>! And it doesn&rsquo;t fit in my bag, either, so I hang around carrying this big heavy box in both hands&hellip;</p>
<p>I guess this calls for a short Oscar speech, a written one.</p>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mysql-conference-2009-community-awards/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/mysql-users-conference-2009-daily-summary-monday/">MySQL Conference 2009 daily summary: Monday</a></h2>

    <div class="post-meta">

  <div>

    <time>21 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blogtags/mysqlconf">mysqlconf</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>[See  <a rel="nofollow" href="http://forge.mysql.com/wiki/MySQLConf2009MondayNotes"><a href="http://forge.mysql.com/wiki/MySQLConf2009MondayNotes">http://forge.mysql.com/wiki/MySQLConf2009MondayNotes</a></a>]</p>
<p>Monday: day of tutorials. Plenty of interesting tutorials on the Conference itself, plus a session with Mark Callaghan - it was hard to choose. I settled for two tutorials, which turned out to be three.</p>
<p><a href="http://www.mysqlconf.com/mysql2009/public/schedule/detail/5364">Practical MySQL Plugin Development</a>: As a C/C++/Java developer, I am very interested in the plugin API. I have used UDF before, and these turned out to be extremely helpful, and solved me a lot of headache. With the new plugin API I was expecting to learn how to properly write INFORMATION_SCHEMA tables, functions and engines.</p>
<p class="fn">Wasn&rsquo;t it possible to learn all this on the web? Sure, but this presentation was delivered by Roland Bouman and Sergei Golubchik, and I was anxious to hear from their experience. Well, that&rsquo;s what the conference is all about, isn&rsquo;t it?</p>
<p class="fn">The session was very good. Roland &amp; Sergei covered the basics of the Plugin API, the general ideas, then went on to present the specific implementations: daemon plugins, INFORMATION_SCHEMA, FULLTEXT. The session was accompanied by convincing and enlighting examples. For example, a QUERY_CACHE_TABLE: an INFORMATION_SCHEMA table which lists which queries are currently in the query cache, along with the number of used blocks etc.</p>
<p class="fn"></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mysql-users-conference-2009-daily-summary-monday/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/a-note-on-barons-command-line-tip-for-comparing-result-sets/">A note on Baron&#39;s command line tip for comparing result sets</a></h2>

    <div class="post-meta">

  <div>

    <time>16 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
    
  </div>

</div>


  </header>

  <p>
  A while ago Baron Schwartz published a MySQL command-line tip: compare result sets. A "SELECT * FROM world", for example, can be checksummed, compared with another checksum made on a replica, or otherwise another table which is supposed to contains the exact same data. I just wanted to note that if you're dealing with a MyISAM table, a simple "SELECT * FROM" will not necessarily be too useful, since MyISAM can store rows in any particular order: two different settings of concurrent_insert, or perhaps an OPTIMIZEd table, can make for different ordering, hence different checksums.
  </p>

  
  <footer>
    <a href="/blog/mysql/a-note-on-barons-command-line-tip-for-comparing-result-sets/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/why-of-the-week/">&#34;Why?&#34; of the week</a></h2>

    <div class="post-meta">

  <div>

    <time>13 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>As progress on <a title="oak-online-alter-table" href="http://code.openark.org/forge/openark-kit/oak-online-alter-table">oak-online-alter-table</a> goes on, I&rsquo;m encountering more and more limitations, for which I must find workarounds. Here&rsquo;s two:</p>
<h4>CREATE TABLE &hellip; LIKE &hellip;</h4>
<p>It works well, but it doesn&rsquo;t copy any foreign key constraints. So, if the original table is this:</p>
<blockquote>
<pre>CREATE TABLE <code>dept_emp</code> (
  <code>emp_no</code> int(11) NOT NULL,
  <code>dept_no</code> char(4) NOT NULL,
  <code>from_date</code> date NOT NULL,
  <code>to_date</code> date NOT NULL,
  PRIMARY KEY  (<code>emp_no</code>,<code>dept_no</code>),
  KEY <code>emp_no</code> (<code>emp_no</code>),
  KEY <code>dept_no</code> (<code>dept_no</code>),
  CONSTRAINT <code>dept_emp_ibfk_1</code> FOREIGN KEY (<code>emp_no</code>) REFERENCES <code>employees</code> (<code>emp_no</code>) ON DELETE CASCADE,
  CONSTRAINT <code>dept_emp_ibfk_2</code> FOREIGN KEY (<code>dept_no</code>) REFERENCES <code>departments</code> (<code>dept_no</code>) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=latin1</pre>
</blockquote>
<p>Then <strong>CREATE TABLE dept_emp_shadow LIKE dept_emp</strong> results with:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/why-of-the-week/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/the-depth-of-an-index-primer/">The depth of an index: primer</a></h2>

    <div class="post-meta">

  <div>

    <time>09 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blogtags/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blogtags/indexing">Indexing</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blogtags/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blogtags/myisam">MyISAM</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>InnoDB and MyISAM use B+ and B trees for indexes (InnoDB also has internal hash index).</p>
<p>In both these structures, the depth of the index is an important factor. When looking for an indexed row, a search is made on the index, from root to leaves.</p>
<p>Assuming the index is not in memory, the depth of the index represents the minimal cost (in I/O operation) for an index based lookup. Of course, most of the time we expect large portions of the indexes to be cached in memory. Even so, the depth of the index is an important factor. The deeper the index is, the worse it performs: there are simply more lookups on index nodes.</p>
<p>What affects the depth of an index?</p>
<p>There are quite a few structural issues, but it boils down to two important factors:</p>
<ol>
<li>The number of rows in the table: obviously, more rows leads to larger index, larger indexes grow in depth.</li>
<li>The size of the indexed column(s). An index on an INT column can be expected to be shallower than an index on a CHAR(32) column (on a very small number of rows they may have the same depth, so we&rsquo;ll assume a large number of rows).</li>
</ol>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/the-depth-of-an-index-primer/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/7-ways-to-convince-mysql-to-use-the-right-index/">7 ways to convince MySQL to use the right index</a></h2>

    <div class="post-meta">

  <div>

    <time>02 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blogtags/books">Books</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blogtags/execution-plan">Execution plan</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blogtags/indexing">Indexing</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blogtags/sql">SQL</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blogtags/syntax">Syntax</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Sometimes MySQL gets it wrong. It doesn&rsquo;t use the right index.</p>
<p>It happens that MySQL generates a query plan which is really bad (EXPLAIN says it&rsquo;s going to explore some 10,000,000 rows), when another plan (soon to show how was generated) says: &ldquo;Sure, I can do that with 100 rows using a key&rdquo;.</p>
<h4>A true story</h4>
<p>A customer had issues with his database. Queries were taking 15 minutes to complete, and the db in general was not responsive. Looking at the slow query log, I found the criminal query. Allow me to bring you up to speed:</p>
<p>A table is defined like this:</p>
<blockquote>
<pre>CREATE TABLE t (
  id INT UNSIGNED AUTO_INCREMENT,
  type INT UNSIGNED,
  level TINYINT unsigned,
  &hellip;
  PRIMARY KEY(id),
  KEY <code>type</code> (type)
) ENGINE=InnoDB;</pre>
</blockquote>
<p>The offending query was this:</p>
<blockquote>
<pre>SELECT id FROM data
WHERE type=12345 AND level &gt; 3
ORDER BY id</pre>
</blockquote>
<p>The facts were:</p>
<ul>
<li><code>t</code> has about 10,000,000 rows.</li>
<li>The index on <code>type</code> is selective: about 100 rows per value on average.</li>
<li>The query took a long time to complete.</li>
<li>EXPLAIN has shown that MySQL uses the PRIMARY KEY, hence searches 10,000,000 rows, filtered &ldquo;using where&rdquo;.</li>
<li>The <em>other</em> EXPLAIN has shown that by using the <code>type</code> key, only 110 rows are expected, to be filtered &ldquo;using where&rdquo;, then sorted &ldquo;using filesort&rdquo;</li>
</ul>
<p>So MySQL acknowledged it was generating the wrong plan. The <em>other</em> plan was better by its own standards.</p>
<h4>Solving the problem</h4>
<p>Let&rsquo;s walk through 7 ways to solve the problem, starting with the more aggressive solutions, refining to achieve desired behavior through subtle changes.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/7-ways-to-convince-mysql-to-use-the-right-index/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/online-alter-table-now-available-in-openark-kit/">Online ALTER TABLE now available in openark kit</a></h2>

    <div class="post-meta">

  <div>

    <time>24 Mar 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blogtags/openark-kit">openark kit</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>A new utility in <a title="openark kit home page" href="http://code.openark.org/forge/openark-kit">openark kit</a> allows for online ALTER TABLE operation. That is, the modification of table structure without locking down the entire table for the duration of the operation. The <a title="oak-online-alter-table utility" href="http://openarkkit.googlecode.com/svn/trunk/openarkkit/doc/html/oak-online-alter-table.html">oak-online-alter-table</a> utility works under the following restrictions:</p>
<ul>
<li>The table has at least one single-column UNIQUE KEY <em>[<em>]</em></li>
<li>Altered table shares a single-column UNIQUE KEY with the original table <em>[</em>]</em></li>
<li>No &lsquo;AFTER&rsquo; triggers are defined on the table (the utility creates its own triggers for the duration of the operation)</li>
<li>The table has no FOREIGN KEYs <em>[<em>][#]</em></li>
<li>Table name is no longer than 57 characters</li>
</ul>
<p><em>[</em>]: Restriction is scheduled to be removed or partly removed.</em></p>
<p><em>[#]: &lsquo;Child-side&rsquo; foreign keys may actually work, but have not been tested.<br />
</em></p>
<p>Follows is a mini FAQ which attempts to introduce the utility.</p>
<h4>So what exactly does this utility provide?</h4>
<ul>
<li>First and foremost, the ability to perform a non blocking ALTER TABLE. This has long been an issue with MySQL, and complex Master-Master, application aware solutions are currently required in order to perform an ALTER TABLE with minimal downtime. The utility offers a no-downtime solution, albeit there is performance penalty for the duration of its runtime, and some requirements to meet.</li>
<li>It also supports a &lsquo;null&rsquo; ALTER. That is, an ALTER TABLE which does not change anything. This effectively means rebuilding of the table. For InnoDB tables with innodb_file_per_table, for example, this could be the means of regaining disk space after removing many rows from the table. Also, while it does not strictly act like OPTIMIZE TABLE, the effect of running this utility should build a better organized table on disk (this as yet unverified).</li>
<li>Another thing this utility supports is the building of a ghost table: a duplicate of a given table, which keeps mirroring the original table via triggers. <em>[May be removed in future versions]</em></li>
</ul>
<h4></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/online-alter-table-now-available-in-openark-kit/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/lock-tables-in-myisam-is-not-a-poor-mans-tranactions-substitute/">LOCK TABLES in MyISAM is NOT a poor man&#39;s tranactions substitute</a></h2>

    <div class="post-meta">

  <div>

    <time>18 Mar 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blogcategories/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blogtags/myisam">MyISAM</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>I get to hear that a lot: that LOCK TABLES with MyISAM is some sort of replacement for transactions; some model we can work with which gives us &lsquo;transactional flavor&rsquo;.</p>
<p>It isn&rsquo;t, and here&rsquo;s why.</p>
<p>When we speak of a transactional database/engine, we check out its ACID compliance. Let&rsquo;s break out the ACID and see what LOCK TABLES provides us with:</p>
<ul>
<li><strong>A</strong>: Atomicity. MyISAM does not provide atomicity.  If we have LOCK TABLES followed by two statements, then closed by UNLOCK TABLES, then it follows that a crash between the two statements will have the first one applied, the second one not not applied. No mechanism ensures an &ldquo;all or nothing&rdquo; behavior.</li>
<li><strong>C</strong>: Consistency. An error in a statement would roll back the entire transaction in a transactional database. This won&rsquo;t work on MyISAM: every statement is &ldquo;committed&rdquo; immediately.</li>
<li><strong>I</strong>: Isolation. Without LCOK TABLES, working with MyISAM resembles using the <strong>read uncommitted</strong>, or <strong>dirty read</strong> isolation level. With LOCK TABLES - it depends. If you were to use LOCK TABLES &hellip; WRITE on all tables in all statements, you would get the <strong>serializable</strong> isolation level. Actually it would be more than <strong>serializable</strong>. It would be <em>truely serial</em>.</li>
<li><strong>D</strong>: Durability. Did the INSERT succeed? And did the power went down just after? MyISAM provides not guarantees that the data will be there.</li>
</ul>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/lock-tables-in-myisam-is-not-a-poor-mans-tranactions-substitute/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  

  


<nav class="pagination" role="pagination">
  
  <a href="/page/34/"><i class="fa fa-chevron-left"></i></a>
  
  <span>&nbsp;35 / 38&nbsp;</span>
  
  <a href="/page/36/"><i class="fa fa-chevron-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="/blogjs/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'Your Google Analytics tracking ID', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

