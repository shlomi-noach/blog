<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.16" />

  <title>Configuration &middot; code.openark.org</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/blog/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/blog/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  
  <link rel="alternate" type="application/rss+xml" title="code.openark.org" href="/blog/tag/configuration/index.xml" />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/blog/img/favicon.ico" type="image/x-icon" />


  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <a class="pure-menu-heading brand" href="/blog">openark.org</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/page/about"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
      <li class="pure-menu-item">
        <a class="pure-menu-link" href="/blog/tag/configuration/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">
    <li class="pure-menu-item">
      <a class="pure-menu-link">
        Shlomi Noach
        
          <div class="avatar-container">
        	  <div class="avatar-img-border">
                <img class="avatar-img" src="/blog/images/shlomi-noach.png" alt="code.openark.org" />
        	  </div>
        	</div>
        
      </a>
    </li>

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/shlomi-noach" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/ShlomiNoach" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/shlominoach" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>





  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Configuration</h1>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="/blog/mysql/baffling-5-7-globalstatus-variables-issues-unclean-migration-path/">Baffling 5.7 global/status variables issues, unclean migration path</a></h2>

    <div class="post-meta">

  <div>

    <time>07 Aug 2015</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/information_schema">INFORMATION_SCHEMA</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/monitoring">Monitoring</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/new-features">New Features</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/opinions">Opinions</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/orchestrator">orchestrator</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/performance_schema">performance_schema</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/security">Security</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/stored-routines">Stored routines</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>MySQL <strong>5.7</strong> introduces a change in the way we query for global variables and status variables: the <strong>INFORMATION<em>SCHEMA.(GLOBAL|SESSION)</em>(VARIABLES|STATUS)</strong> tables are now deprecated and empty. Instead, we are to use the respective <strong>performance<em>schema.(global|session)</em>(variables|status)</strong> tables.</p>
<p>But the change goes farther than that; there is also a security change. Oracle created a pitfall of <strong>2</strong> changes at the same time:</p>
<ol>
<li>Variables/status moved to a different table</li>
<li>Privileges required on said table</li>
</ol>
<p>As an example, my non-root user gets:</p>
<blockquote>
<pre>mysql&gt; show session variables like &lsquo;tx_isolation&rsquo;;
ERROR 1142 (42000): SELECT command denied to user &lsquo;normal_user&rsquo;@&lsquo;my_host&rsquo; for table &lsquo;session_variables&rsquo;</pre>
</blockquote>
<p>Who gets affected by this? Nearly <em>everyone and everything</em>.</p>
<ul>
<li>Your Nagios will not be able to read status variables</li>
<li>Your ORM will not be able to determine session variables</li>
<li>Your replication user will fail connecting (see <a href="http://datacharmer.blogspot.nl/2015/08/mysql-578-features-bugs-and-rumors.html">this post by Giuseppe</a>)</li>
<li>And most everyone else.</li>
</ul>
<p>The problem with the above is that involves two unrelated changes to your setup, which are not entirely simple to coordinate:</p>
<ol>
<li>Change your app code to choose the correct schema (information_schema vs. performance_schema)</li>
<li><strong>GRANT</strong> the permissions on your database</li>
</ol>
<p>Perhaps at this point you still do not consider this to be a problem. You may be thinking: <em>well, let&rsquo;s first prepare by creating the GRANTs, and once that is in place, we can, at our leisure, modify the code</em>.</p>
<p>Not so fast. Can you really that simply create those GRANTs?</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/baffling-5-7-globalstatus-variables-issues-unclean-migration-path/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/tokudb-configuration-variables-of-interest/">TokuDB configuration variables of interest</a></h2>

    <div class="post-meta">

  <div>

    <time>23 Oct 2013</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/performance">Performance</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/tokudb">TokuDB</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>During our experiments I came upon a few TokuDB variables of interest; if you are using TokuDB you might want to look into these:</p>
<ul>
<li>
<h4>tokudb_analyze_time</h4>
</li>
</ul>
<p style="padding-left: 30px;">This is a boundary on the number of seconds an <strong>ANALYZE TABLE</strong> will operate on each index on each partition on a TokuDB table.</p>
<p style="padding-left: 30px;">That is, if <strong>tokudb_analyze_time = 5</strong>, and your table has <strong>4</strong> indexes (including <strong>PRIMARY</strong>) and <strong>7</strong> partitions, then the total runtime is limited to <strong>5*4*7 = 140</strong> seconds.</p>
<p style="padding-left: 30px;">Default in <strong>7.1.0</strong>: <strong>5</strong> seconds</p>
<ul>
<li>
<h4>tokudb_cache_size</h4>
</li>
</ul>
<p style="padding-left: 30px;">Similar to <strong>innodb_buffer_pool_size</strong>, this variable sets the amount of memory allocated by TokuDB for caching pages. Like InnoDB the table is clustered within the index, so the cache includes pages for both indexes and data.</p>
<p style="padding-left: 30px;">Default: <strong>50%</strong> of total memory</p>
<ul>
<li>
<h4>tokudb_directio</h4>
</li>
</ul>
<p style="padding-left: 30px;">Boolean, values are <strong>0/1</strong>. Setting <strong>tokudb_directio = 1</strong> is like specifying <strong>innodb_flush_method = O_DIRECT</strong>. Which in turn means the OS should not cache pages requested by TokuDB. Default: <strong>0</strong>.</p>
<p style="padding-left: 30px;">Now here&rsquo;s the interesting part: we are used to tell InnoDB to get the most memory we can provide (because we want it to cache as much as it can) and to avoid OS caching (because that would mean a page would appear both in the buffer pool and in OS memory, which is a waste). So the following setup is common:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/tokudb-configuration-variables-of-interest/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/on-mysql-plugin-configuration/">On MySQL plugin configuration</a></h2>

    <div class="post-meta">

  <div>

    <time>01 Oct 2013</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/development">Development</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/plugin">plugin</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>MySQL offers <a href="http://dev.mysql.com/doc/refman/5.5/en/plugin-api.html">plugin API</a>, with which you can add <a href="http://dev.mysql.com/doc/refman/5.5/en/plugin-types.html">different types</a> of plugins to the server. The API is roughly the same for all plugin types: you implement an init() function, a deinit(); you declare status variables and global variables associated with your plugin, and of course you implement the particular implementation of plugin call.</p>
<p>I wish to discuss the creation and use of global variables for plugins.</p>
<p>Consider the following declaration of a global variable in <a href="https://github.com/outbrain/audit_login">audit_login</a>:</p>
<blockquote>
<pre>static MYSQL_SYSVAR_BOOL(enabled, plugin_enabled, PLUGIN_VAR_NOCMDARG,
&ldquo;enable/disable the plugin&rsquo;s operation, namely writing to file&rdquo;, NULL, NULL, 1);</p>

<p>static struct st_mysql_sys_var * audit_login_sysvars[] = {
    MYSQL_SYSVAR(enabled),
    NULL
};</pre>
</blockquote>
<p>The above creates a new global variables called <strong>&ldquo;simple_login_audit_enabled&rdquo;</strong>: it is composed of the plugin name (known to be <strong>&ldquo;simple_login_audit&rdquo;</strong> in our example) and declared name (<strong>&ldquo;enabled&rdquo;</strong>). It is a boolean, defaults to <strong>1</strong>, and is associated with the internal <strong>plugin_enabled</strong> variable.</p>
<p>Once this variable is declared, you can expect to be able to:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/on-mysql-plugin-configuration/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/thoughts-on-mysql-5-6-new-replication-features/">Thoughts on MySQL 5.6 new replication features</a></h2>

    <div class="post-meta">

  <div>

    <time>15 Oct 2012</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/new-features">New Features</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/opinions">Opinions</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/replication">Replication</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>After playing a little bit with MySQL <strong>5.6</strong> (RC), and following closely on Giuseppe&rsquo;s <a href="http://datacharmer.blogspot.co.il/2012/08/mysql-56-replication-gotchas-and-bugs.html">MySQL 5.6 replication gotchas (and bugs)</a>, I was having some thoughts.</p>
<p>These are shared for a few reasons:</p>
<ul>
<li>Maybe I didn&rsquo;t understand it well, and someone could correct me</li>
<li>Or I understood it well, and my input could be of service to the developers</li>
<li>Or it could be of service to the users</li>
</ul>
<h4>InnoDB tables in mysql schema</h4>
<p>The introduction of InnoDB tables in <strong>mysql</strong> makes for crash-safe replication information: the exact replication position (master log file+pos, relay log file+pos etc.) is updated on InnoDB tables; with <strong>innodb_flush_logs_at_trx_commit=1</strong> this means replication status is durable and consistent with server data. This is great news!</p>
<p>However, the introduction of InnoDB tables to the mysql schema also breaks some common usage on installation and setup of MySQL servers. You can&rsquo;t just drop your <strong>ib_data1</strong> file upon dump+restore, since it also contains internal data. Giuseppe outlines the workaround for that.</p>
<p>I was thinking: would it be possible to have a completely different tablespace for MySQL&rsquo;s internal InnoDB tables? That could be a single tablespace file (who cares about file-per-table on a few internal tables). And I&rsquo;m throwing an idea without being intimate with the internals: you know how it is possible to span the shared tablespace across multiple files, as in:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/thoughts-on-mysql-5-6-new-replication-features/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/useful-sed-awk-liners-for-mysql/">Useful sed / awk liners for MySQL</a></h2>

    <div class="post-meta">

  <div>

    <time>06 Jul 2011</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/mysqldump">mysqldump</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/scripts">scripts</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  Listing some useful sed / awk liners to use with MySQL. I use these on occasion. sed, awk &amp; grep have many overlapping features. Some simple tasks can be performed by either. For example, stripping empty lines can be performed by either: grep '.' awk '/./' sed '/./!d' grep -v '^$' awk '!/^$/' sed '/^$/d' It's a matter of taste &amp; convention which tool and variation to use. So for any script I suggest, there may be many variations, possibly cleaner, shorter; feel free to comment.
  </p>

  
  <footer>
    <a href="/blog/mysql/useful-sed-awk-liners-for-mysql/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/recovering-a-mysql-root-password-the-fourth-solution/">Recovering a MySQL `root` password: the fourth solution</a></h2>

    <div class="post-meta">

  <div>

    <time>22 Mar 2011</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/replication">Replication</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/security">Security</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  Have just read Darren Cassar's Recovering a MySQL `root` password – Three solutions. There's a fourth solution: using an init-file, which leads to just one restart of the database instead of two. It also avoids the security issue involved with using skip-grant-tables. I've written all about it before on Dangers of skip-grant-tables. Darren's 1st advice (look for password ini files, scripts, etc.) is a very good one. One password that can always be looked up in files is the replication's password.
  </p>

  
  <footer>
    <a href="/blog/mysql/recovering-a-mysql-root-password-the-fourth-solution/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/upgrading-passwords-from-old_passwords-to-new-passwords/">Upgrading passwords from old_passwords to &#34;new passwords&#34;</a></h2>

    <div class="post-meta">

  <div>

    <time>28 Feb 2011</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/security">Security</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>You have <strong>old_passwords=1</strong> in your <strong>my.cnf</strong>. I&rsquo;m guessing this is because you used one of the <strong>my-small.cnf</strong>, <strong>my-large.cnf</strong> etc. templates provided with your MySQL distribution.</p>
<p>These files can easily win the &ldquo;most outdated sample configuration file contest&rdquo;.</p>
<p>Usually it&rsquo;s no big deal: if some parameter isn&rsquo;t right, you just go and change it. Some variables, though, have a long-lasting effect, and are not easily reversed.</p>
<h4>What&rsquo;s the deal with old_passwords?</h4>
<p>No one should be using these anymore. This variable makes the password hashing algorithm compatible with that of MySQL <strong>4.0</strong>. I&rsquo;m pretty sure <strong>4.0</strong> was released <strong>9</strong> years ago. I don&rsquo;t know of anyone still using it (or <strong>4.0</strong> client libraries).</p>
<p>The deal is this: with old_passwords you get a <strong>16</strong> hexadecimal digits (<strong>64</strong> bit) hashing of your passwords. With so called <em>&ldquo;new passwords&rdquo;</em> you get <strong>40</strong> hexadecimal digits (plus extra &ldquo;<strong>*</strong>&rdquo;). So this is about better encryption of your password. Read more on the <a href="http://dev.mysql.com/doc/refman/5.1/en/password-hashing.html">manual</a>.</p>
<h4>How do I upgrade to new password format?</h4>
<p>You can&rsquo;t just put a comment on the &ldquo;<strong>old_passwords=1</strong>&rdquo; entry in the configuration file. If you do so, the next client to connect will attempt to match a <strong>41</strong> characters hashed password to your existing <strong>16</strong> characters entry in the <strong>mysql.users</strong> table. So you need to make a simultaneous change: both remove the <strong>old_passwords</strong> entry and set a new password. You must know all accounts&rsquo; passwords before you begin.</p>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/upgrading-passwords-from-old_passwords-to-new-passwords/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/upgrading-to-barracuda-getting-rid-of-huge-ibdata1-file/">Upgrading to Barracuda &amp; getting rid of huge ibdata1 file</a></h2>

    <div class="post-meta">

  <div>

    <time>15 Feb 2011</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/backup">Backup</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/mysqldump">mysqldump</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/replication">Replication</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Some of this is old stuff, but more people are now converting to InnoDB plugin, so as to enjoy table compression, performance boosts. Same holds for people converting to Percona&rsquo;s XtraDB. InnoDB plugin requires <strong>innodb_file_per_table</strong>. No more shared tablespace file.</p>
<p>So your <strong>ibdata1</strong> file is some <strong>150GB</strong>, and it won&rsquo;t reduce. Really, it won&rsquo;t reduce. You set <strong>innodb_file_per_table=1</strong>, do <strong>ALTER TABLE t ENGINE=InnoDB</strong> (optionally <strong>ROW_FORMAT=COMPRESSED KEY_BLOCK_SIZE=8</strong>), and you get all your tables in file-per-table <strong>.ibd</strong> files.</p>
<p>But the original <strong>ibdata1</strong> file is still there. It has to be there, don&rsquo;t delete it! It contains more than your old data.</p>
<p>InnoDB tablespace files never reduce in size, it&rsquo;s an old-time annoyance. The only way to go round it, if you need the space, is to completely drop them and start afresh. That&rsquo;s one of the things so nice about file-per-table: an <strong>ALTER TABLE</strong> actually creates a new tablespace file and drops the original one.</p>
<h4>The procedure</h4>
<p>The procedure is somewhat painful:</p>
<ul>
<li>Dump everything logically (either use <em>mysqldump</em>, <a href="http://www.maatkit.org/doc/mk-parallel-dump.html">mk-parallel-dump</a>, or do it your own way)</li>
<li>Erase your data (literally, delete everything under your <strong>datadir</strong>)</li>
<li>Generate a new empty database</li>
<li>Load your dumped data.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/upgrading-to-barracuda-getting-rid-of-huge-ibdata1-file/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/wheres-my-cnf-file/">Where&#39;s my cnf file?</a></h2>

    <div class="post-meta">

  <div>

    <time>07 Dec 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/linux">Linux</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>So you have a running MySQL server, it&rsquo;s working well and everyone&rsquo;s happy. You want to make a minor change to the configuration file, so you edit the file, restart MySQL - but the change doesn&rsquo;t catch!</p>
<p>Or maybe you want to check that some global variable has not been dynamically changed without an update to the configuration file. But the configuration file doesn&rsquo;t make any sense &ndash; it looks like nothing is common between the file and the server.</p>
<p>Wait, which <strong>my.cnf</strong> file does MySQL read? Rather, which <strong>my.cnf</strong> <em>files</em>?</p>
<p>Ever happened to you? If you&rsquo;re well organized, and only keep a single <strong>/etc/my.cnf</strong> file, you know exactly where everything is. But some systems are messier, with <em>lots</em> of configuration files hanging around. Which ones apply?</p>
<p>Let&rsquo;s find out which configuration files apply.</p>
<h4>No direct information</h4>
<p>It would all be easier if we could just <strong>SHOW GLOBAL VARIABLES LIKE &lsquo;configuration_files_that_this_server_has_read_list&rsquo;</strong>. There isn&rsquo;t such an option.</p>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/wheres-my-cnf-file/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/mysql-terminology-processes-threads-connections/">MySQL terminology: processes, threads &amp; connections</a></h2>

    <div class="post-meta">

  <div>

    <time>03 Nov 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/syntax">Syntax</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>There&rsquo;s some confusion in the MySQL terminology for processes, threads &amp; connections, which I will try to resolve. I can&rsquo;t explain the full nature of what processes and threads are; please see Wikipedia <a href="http://en.wikipedia.org/wiki/Process_%28computing%29">[1]</a> <a href="http://en.wikipedia.org/wiki/Thread_%28computer_science%29">[2]</a> for that. But here&rsquo;s some basics with regard to MySQL:</p>
<ul>
<li>MySQL server is a single process application.</li>
<li>It is multithreaded.</li>
<li>It (usually) acts as a TCP/IP server, accepting connections.</li>
<li>Each connection gets a dedicated thread.</li>
<li>These threads are sometimes named processes, and sometimes they&rsquo;re referred to as connections.</li>
</ul>
<p>The last part is where confusion arises, so let me discuss again the use of threads and connections in MySQL.</p>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mysql-terminology-processes-threads-connections/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/mmm-for-mysql-single-reader-role/">MMM for MySQL single reader role</a></h2>

    <div class="post-meta">

  <div>

    <time>12 Aug 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/high-availability">High availability</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/open-source">Open Source</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/replication">Replication</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>The standard documentation and tutorials on <a href="http://mysql-mmm.org/">MMM for MySQL</a>, for master-master replication setup, suggest one Virtual IP for the <em>writer</em> role, and two Virtual IPs for the <em>reader</em> role. It can be desired to only have a single virtual IP for the reader role, as explained below.</p>
<h4>The two IPs for the reader role</h4>
<p>A simplified excerpt from the <strong>mmm_common.conf</strong> sample configuration file, as can be found on the project&rsquo;s site and which is most quoted:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mmm-for-mysql-single-reader-role/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/verifying-group_concat-limit-without-using-variables/">Verifying GROUP_CONCAT limit without using variables</a></h2>

    <div class="post-meta">

  <div>

    <time>10 Jun 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/information_schema">INFORMATION_SCHEMA</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql">SQL</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>I have a case where I must know if <strong>group_concat_max_len</strong> is at its default value (<strong>1024</strong>), which means there are some operation I cannot work out. I&rsquo;ve ranted on this <a href="http://code.openark.org/blog/mysql/those-oversized-undersized-variables-defaults">here</a>.</p>
<p>Normally, I would simply:</p>
<blockquote><pre>
SELECT @@group_concat_max_len
</pre></blockquote>
<p>However, I am using views, where session variables are not allowed. Using a stored function can <a href="http://code.openark.org/blog/mysql/views-better-performance-with-condition-pushdown">do the trick</a>, but I wanted to avoid stored routines. So here&rsquo;s a very simple test case: is the current <strong>group_concat_max_len</strong> long enough or not? I&rsquo;ll present the long version and the short version.</p>
<h4>The long version</h4>
<blockquote><pre>
SELECT
  CHAR_LENGTH(
    GROUP_CONCAT(
      COLLATION_NAME SEPARATOR &ldquo;
    )
  )
FROM
  INFORMATION_SCHEMA.COLLATIONS;
</pre></blockquote>
<p>If the result is <strong>1024</strong>, we are in a bad shape. I happen to know that the total length of collation names is above <strong>1800</strong>, and so it is trimmed down. Another variance of the above query would be:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/verifying-group_concat-limit-without-using-variables/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/those-oversized-undersized-variables-defaults/">Those oversized, undersized variables defaults</a></h2>

    <div class="post-meta">

  <div>

    <time>09 Jun 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql_mode">sql_mode</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Some <strong>mysqld</strong> parameters are far from having reasonable defaults. Most notable are the engine-specific values, and in particular the InnoDB parameters.</p>
<p>Some of these variables have different defaults as of MySQL 5.4. <strong>innodb_buffer_pool_size</strong>, for example, is <strong>128M</strong> on 5.4. <strong>innodb_log_file_size</strong>, however, has changed back and forth, as far as I understand, and is down to <strong>5M</strong> again. These settings are still the same on 5.5.</p>
<p>I wish to present some not-so-obvious parameters which, in my opinion, have poor defaults, for reasons I will explain.</p>
<ul>
<li><strong>group_concat_max_len</strong>: This parameter limits the maximum text length of a <strong>GROUP_CONCAT</strong> concatenation result. It defaults to <strong>1024</strong>. I think this is a very low value. I have been using <strong>GROUP_CONCAT</strong> more and more, recently, to solve otherwise difficult problems. And in most cases, <strong>1024</strong> was just too low, resulting in <a href="http://code.openark.org/blog/mysql/but-i-do-want-mysql-to-say-error">silent</a> (<em>Argh!</em>) truncating of the result, thus returning incorrect results. It is interesting to learn that the maximum value for this parameter is limited by <strong>max_packet_size</strong>. I would suggest, then, that this parameter should be altogether removed, and have the <strong>max_packet_size</strong> limitation as the only limitation. Otherwise, I&rsquo;d like it to have a very large default value, in the order of a few MB.</li>
<li><strong>wait_timeout</strong>: Here&rsquo;s a parameter whose default value is over permissive. <strong>wait_timeout</strong> enjoys an <strong>8 hour</strong> default. I usually go for <strong>5-10 minutes</strong>. I don&rsquo;t see a point in letting idle connections waste resources for 8 hours. Applications which hold up such connections should be aware that they&rsquo;re doing something wrong, in the form of a forced disconnection. Connection pools work beautifully with low settings, and can themselves do keepalives, if they choose to.</li>
<li><strong>sql_mode</strong>: I&rsquo;ve <a href="http://code.openark.org/blog/mysql/do-we-need-sql_mode">discussed this</a> in length before. My opinion unchanged.</li>
<li><strong>open_files_limit</strong>: What with the fact connections, threads, table descriptors, table file descriptors (depending on how you use InnoDB), temporary file tables &ndash; all are files on unix-like systems, and considering this is an inexpensive payment, I think <strong>open_files_limit</strong> should default to a few thousands. Why risk the crash of &ldquo;too many open files&rdquo;?</li>
</ul>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/those-oversized-undersized-variables-defaults/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/replication-configuration-checklist/">Replication configuration checklist</a></h2>

    <div class="post-meta">

  <div>

    <time>18 May 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/replication">Replication</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>This post lists the essential and optional settings for a replication environment.</p>
<p>It does not explain how to create replicating slaves. See <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-howto.html">How To Setup Replication</a> for that. However, not all configuration options are well understood, and their roles in varying architectures can change.</p>
<p>Here are the settings for a basic Master/Slave(s) replication architecturee.</p>
<h4>Essential</h4>
<ul>
<li><strong>log-bin</strong>: enable binary logs on the master. Replication is based on the master logging all modifying queries (<strong>INSERT</strong>/<strong>CREATE</strong>/<strong>ALTER</strong>/<strong>GRANT</strong> etc.), and the slaves being able to replicate them.</li>
<li><strong>server-id</strong>: each machine must have a <em>unique</em> <strong>server-id</strong>. A slave will not replay queries originating from a server with the same <strong>server-id</strong> as its own.</li>
<li><strong>GRANT</strong>: grant a user with <strong>REPLICATION SLAVE</strong>. The host list must include all replication slave hosts.</li>
<li><strong>expire-logs-days</strong>: automatically clean up master&rsquo;s binary logs older than given value. By default, binary logs are never removed.</li>
</ul>
<p>When working with Master/Slaves replication, one should be prepared to master failure and slave promotion to master. It may be desirable to identify a particular slave as primary candidate for promotion.</p>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/replication-configuration-checklist/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/but-i-do-want-mysql-to-say-error/">But I DO want MySQL to say &#34;ERROR&#34;!</a></h2>

    <div class="post-meta">

  <div>

    <time>12 Mar 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql_mode">sql_mode</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/syntax">Syntax</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>MySQL is known for its willingness to accept invalid queries, data values. It can silently commit your transaction, truncate your data.</p>
<ul>
<li>Using <strong>GROUP_CONCAT</strong> with a small <strong>group_concat_max_len</strong> setting? Your result will be silently truncated (make sure to check the warnings though).</li>
<li>Calling <strong>CREATE <span style="text-decoration: line-through;">TEMPORARY</span> TABLE</strong>? You get <a href="http://www.joinfu.com/2010/03/a-follow-up-on-the-sql-puzzle/">silent commit</a>.</li>
<li>Issuing a <strong>ROLLBACK</strong> on non-transactional involved engines? Have a warning; no error.</li>
<li>Using <strong>LOCK IN SHARE MODE</strong> on non transactional tables? Not a problem. Nothing reported.</li>
<li>Adding a <strong>FOREIGN KEY</strong> on a MyISAM table? Good for you; no action actually taken.</li>
<li>Inserting <strong>300</strong> to a <strong>TINYINT</strong> column in a relaxed <strong>sql_mode</strong>? Give me <strong>255</strong>, I&rsquo;ll silently drop the remaining <strong>45</strong>. I owe you.</li>
</ul>
<h4>Warnings and errors</h4>
<p>It would be nice to:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/but-i-do-want-mysql-to-say-error/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/quick-reminder-avoid-using-binlog-do-db/">Quick reminder: avoid using binlog-do-db</a></h2>

    <div class="post-meta">

  <div>

    <time>02 Mar 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/replication">Replication</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  Nothing new about this warning; but it's worth repeating: Using binlog-do-db is dangerous to your replication. It means the master will not write to binary logs any statement not in the given database. Ahem. Not exactly. It will not write to binary logs any statement which did not originate from the given database. Which is why a customer, who was using Toad for MySQL as client interface to MySQL, and by default connected to the mysql schema, did not see his queries being replicated.
  </p>

  
  <footer>
    <a href="/blog/mysql/quick-reminder-avoid-using-binlog-do-db/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/to-not-yum-or-to-not-apt-get/">To not yum or to not apt-get?</a></h2>

    <div class="post-meta">

  <div>

    <time>16 Feb 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/installation">Installation</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/linux">Linux</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>I&rsquo;ve <a href="http://code.openark.org/blog/mysql/manually-installing-multiple-mysql-instances-on-linux-howto">written</a> shortly on this before. I like <strong>yum</strong>; I love <strong>apt-get</strong>; I prefer <em>not</em> to use them for MySQL installations. I consider a binary tarball to be the best MySQL installation format (source installations being a different case altogether).</p>
<h4>Why?</h4>
<p>I use <strong>yum</strong> and <strong>apt-get</strong> whenever I can and for almost all needs (sometimes preferring CPAN for Perl installations). But on a MySQL machine, I avoid doing so. The reason is either dependency hell or dependency mismatch.</p>
<p>Package managers are supposed to solve the dependency hell issue. But package managers will rarely have an up to date MySQL version.</p>
<p>I&rsquo;ve had several experiences where a simple <strong>yum</strong> installation re-installed the MySQL version. I&rsquo;ve had customers calling me up when, having installed something with <strong>yum</strong>, MySQL would not work anymore.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/to-not-yum-or-to-not-apt-get/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/announcing-mycheckpoint-lightweight-sql-oriented-monitoring-for-mysql/">Announcing mycheckpoint: lightweight, SQL oriented monitoring for MySQL</a></h2>

    <div class="post-meta">

  <div>

    <time>10 Nov 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/analysis">Analysis</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/monitoring">Monitoring</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/mycheckpoint">mycheckpoint</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/python">python</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>I&rsquo;m proud to announce <a href="http://code.openark.org/forge/mycheckpoint">mycheckpoint</a>, a monitoring utility for MySQL, with strong emphasis on user accessibility to monitored data.</p>
<p><em>mycheckpoint</em> is a different kind of monitoring tool. It leaves the power in the user&rsquo;s hand. It&rsquo;s power is not with script-based calculations of recorded data. It&rsquo;s with the creation of a view hierarchy, which allows the user to access computed metrics directly.</p>
<p><em>mycheckpoint</em> is needed first, to deploy a monitoring schema. It <em>may</em> be needed next, so as to INSERT recorded data (GLOBAL STATUS, GLOBAL VARIABLES, MASTER STATUS, SLAVE STATUS) &ndash; but this is just a simple INSERT; anyone can do that, even another monitoring tool.</p>
<p>It is then that you do not need it anymore: everything is laid at your fingertips. Consider:</p>
<blockquote>
<pre><strong>SELECT</strong> innodb_read_hit_percent, DML <strong>FROM</strong> sv_report_chart_hour;</pre>
</blockquote>
<blockquote><img class="alignnone" title="Google chart #1" src="/blog/assets/chart?cht=lc&amp;chs=400x200&amp;chts=303030,12&amp;chtt=Nov+5,+13:10++-++Nov+6,+10:25+(0+days,+21+hours)&amp;chdl=innodb_read_hit_percent&amp;chdlp=b&amp;chco=ff8c00&amp;chd=s:xz3m3P34z3svvz33xzsvxvvsz11xz344443x443133x414131444344144444o1K44444444664446664636444444z64x3666466666641q6666666666666666666666366668888616686866zMGq66666vhqW46666zqPx44466zljz444434343444444433434334434K434441413344444414444343434443434666666664464636&amp;chxt=x,y&amp;chxr=1,99.66,100.00&amp;chxl=0:||Nov+5,+17:25|Nov+5,+21:40|Nov+6,+01:55|Nov+6,+06:10|&amp;chxs=0,505050,10" alt="" width="400" height="200" /><img class="alignnone" title="Google Chat #2" src="/blog/assets/chart?cht=lc&amp;chs=400x200&amp;chts=303030,12&amp;chtt=Oct+26,+19:00++-++Nov+6,+10:00+(10+days,+15+hours)&amp;chdl=com_select_psec|com_insert_psec|com_delete_psec|com_update_psec|com_replace_psec&amp;chdlp=b&amp;chco=ff8c00,4682b4,9acd32,dc143c,9932cc&amp;chd=s:11455ljjkkjnlmnoo268wyy123445njjjkjkllnoorsuvyvxv4533mikkljklmnoqrstuxy001223mojjkjkkllnnpqrrttuvyxyxkghghhhiihijjklmnnoprrssfdeefefgihjjmnoqstwwzx00khiijijilkmopprsuuxx0012khiijhihkjmmnprtwt0z2242mjjkljlknnnnpqrrwwzy1034jijhjijjkkmoqqsswvyx0z11khihjijjkkk,WXYWW4UUWSSRTUWWWjoncZYXZYZXXzUSSSTUVWYWWYbgbYXWWWWWW7aWTTTSTWXXWVVVWWWYXZZXXznTTVTUUVYWVYWUVWVVWVXWU3WWUVVSSSTSTSSTWTUUVUTUUVSUTTTUUVUVVVVVVWXWVXXVVUSVXUSSTTVWVVWVWZXYYbZXXaVVVVUTUUWXVVYZabXaYXXWWaTXZXUTVVVVVVVYZYYYWWWWVaTSRRSSSTVXZaaYWYYbXXWYXbTTUXXUUVVV,JKLKKtJIHHGILJJJJJKJKJKKKKLKKpIHGJGIIJJKJKJJJJJJKKLKKwNIJHGHJJJJLJLJJIKKKKKKKlbIIHHJIKJJKJKKKKKKLLKKMtKHGGHGGLIKMJJMJJJIJJJIIKJHHHIGIJJJJIIJJJIJJKJIJKIIGKHHKLJJKJJJIJJJIJIJKMJJHIHHMMKJJIJIIIHIIIIIIOJIIHIHIJJJJIJIIKIJLKJLKQIHGHGHIKKKKKJJJLKKKKKOKRJJHHHIIKKK,HIIHHJHHHHHHHHIHHHIIIIIIIIIIHJHHHHHHIHIIHHIIIIHHHHIHHIHHHHHGHIIIHHHHHHIIIIIHHJHHHHHHHHHHHHIHHHIHHHHHHIHHHHHHHHHHGGHHHHGGGGHGGIGGGGGHHHHHGHHHHHHHHHHHHIHHHHHHHHHHHHHHHHHHIHHHHJHHHHHHHHHHHHHHHHHHHIIHHJHHHHHHHHIHHHHHHHIIHHHHHIHHHHHHHHHHHIIIHHIIIIIIHIHHHHHHHHHH,&amp;chxt=x,y&amp;chxr=1,0,142.31&amp;chxl=0:||Oct+28,+22:00|Oct+31,+01:00|Nov+2,+04:00|Nov+4,+07:00|&amp;chxs=0,505050,10" alt="" width="400" height="200" /></blockquote>
<p><em>mycheckpoint</em> provides the views which take raw data (just <strong>innodb_buffer_pool_read_requests</strong>, <strong>com_select</strong>, <strong>innodb_buffer_pool_size</strong>, <strong>table_open_cache</strong>, <strong>seconds_behind_master</strong> etc.) and generate Google Charts URLs, HTML reports, human readable reports, or otherwise easily accessible data.</p>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/announcing-mycheckpoint-lightweight-sql-oriented-monitoring-for-mysql/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/character-sets-latin1-vs-ascii/">Character sets: latin1 vs. ascii</a></h2>

    <div class="post-meta">

  <div>

    <time>08 Jul 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Unless specified otherwise, <strong>latin1</strong> is the default character set in MySQL.</p>
<p>What I usually find in schemes are columns which are either <strong>utf8</strong> or <strong>latin1</strong>. The <strong>utf8</strong> columns being those which need to contain multilingual characters (user names, addresses, articles etc.), and <strong>latin1</strong> column being all the rest (passwords, digests, email addresses, hard-coded values etc.)</p>
<p>I find <strong>latin1</strong> to be improper for such purposes and suggest that <strong>ascii</strong> be used instead. The reason being that <strong>latin1</strong> implies a European text (with swedish collation). It is unclear for an outsider, when finding a <strong>latin1</strong> column, whether it should actually contain West European characters, or is it just being used for ascii text, utilizing the fact that a character in <strong>latin1</strong> only requires 1 byte of storage.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/character-sets-latin1-vs-ascii/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/reasons-to-use-innodb_file_per_table/">Reasons to use innodb_file_per_table</a></h2>

    <div class="post-meta">

  <div>

    <time>21 May 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/mysqldump">mysqldump</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/performance">Performance</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>When working with InnoDB, you have two ways for managing the tablespace storage:</p>
<ol>
<li>Throw everything in one big file (optionally split).</li>
<li>Have one file per table.</li>
</ol>
<p>I will discuss the advantages and disadvantages of the two options, and will strive to convince that <strong>innodb_file_per_table</strong> is preferable.</p>
<h4>A single tablespace</h4>
<p>Having everything in one big file means all tables and indexes, from <em>all schemes</em>, are &lsquo;mixed&rsquo; together in that file.</p>
<p>This allows for the following nice property: free space can be shared between different tables and different schemes. Thus, if I purge many rows from my <strong>log</strong> table, the now unused space can be occupied by new rows of any other table.</p>
<p>This same nice property also translates to a not so nice one: data can be greatly fragmented across the tablespace.</p>
<p>An annoying property of InnoDB&rsquo;s tablespaces is that they never shrink. So after purging those rows from the <strong>log</strong> table, the tablespace file (usually <strong>ibdata1</strong>) still keeps the same storage. It does not release storage to the file system.</p>
<p>I&rsquo;ve seen more than once how certain tables are left unwatched, growing until disk space reaches 90% and SMS notifications start beeping all around.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/reasons-to-use-innodb_file_per_table/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/the-importance-of-report_host-report_port/">The importance of report_host &amp; report_port</a></h2>

    <div class="post-meta">

  <div>

    <time>13 May 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/replication">Replication</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>The two server variables, <a href="http://dev.mysql.com/doc/refman/5.0/en/replication-options-slave.html#option_mysqld_report-host">report_host</a> and <a href="http://dev.mysql.com/doc/refman/5.0/en/replication-options-slave.html#option_mysqld_report-port">report_port</a>, are not commonly used. One of the reasons, I suspect, is that they do not appear in any of the standard <strong>.cnf</strong> files provided with a MySQL installation.</p>
<p>For a replication environment, I find these two variables to be very useful.</p>
<h4>Where are these variables used?</h4>
<p>Here&rsquo;s a slightly modified exerpt from a MySQL master node I have, and which has two slaves:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/the-importance-of-report_host-report_port/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/more-on-variables-ambiguities/">More on variables ambiguities</a></h2>

    <div class="post-meta">

  <div>

    <time>30 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  Continuing Variables ambiguities in names and values, there are two more issues I wish to present. First, I've shown that variable values may be ambiguous. Thus, 1 and ON are interchangeable. But also 1 and YES. The important thing to note is that it's not always like that. You can't just swap 1 for ON or YES as you will: it depends on the variable. Thus, a specific variable (e.g. query_cache_type) may accept ON for 1 - but will not accept YES.
  </p>

  
  <footer>
    <a href="/blog/mysql/more-on-variables-ambiguities/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/variables-ambiguities-in-names-and-values/">Variables ambiguities in names and values</a></h2>

    <div class="post-meta">

  <div>

    <time>28 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Writing up some scripts, I see more and more ambiguities with regard to global variables.</p>
<p>For one thing, the <em>names</em> ambiguity between the hyphen (&lsquo;-&rsquo;) and the underscore (&rsquo;_&lsquo;). So <strong>wait_timeout</strong> and <strong>wait-timeout</strong> are the same variable.</p>
<p>But just check out the many levels of inconsistency:</p>
<ul>
<li>Command line arguments (e.g. run <strong>mysqld</strong> with option variables) use the hyphen convention</li>
<li><strong>mysql &ndash;verbose &ndash;help</strong> shows the hyphen convention</li>
<li><strong>SHOW GLOBAL VARIABLES</strong> uses the underscore convention</li>
<li>The MySQL supplied sample configuration files use both conventions interchangeably</li>
</ul>
<p>Enough? Not quite: there are ambiguities in <em>values</em>, as well. For example, you may set <strong>query_cache_type</strong> to <strong>1</strong> or <strong>ON</strong>. These are equivalent. That&rsquo;s very friendly. However:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/variables-ambiguities-in-names-and-values/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/mysql-user-group-meetings-in-israel/">MySQL User Group Meetings in Israel</a></h2>

    <div class="post-meta">

  <div>

    <time>11 Mar 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/myisam">MyISAM</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/user-group">User Group</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  This is a short note that the MySQL User Group Meetings in Israel are established (well, re-established after a very long period). Thanks to Eddy Resnick from Sun Microsystems Israel who has set up the meetings. So far, we've had 2 successful meetings, and we intend to have more! First one was in Sun's offices in Herzlia; second one, held last week, was at Interbit (a MySQL training center) in Ramat Gan.
  </p>

  
  <footer>
    <a href="/blog/mysql/mysql-user-group-meetings-in-israel/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/manually-installing-multiple-mysql-instances-on-linux-howto/">Manually installing multiple MySQL instances on Linux: HOWTO</a></h2>

    <div class="post-meta">

  <div>

    <time>19 Feb 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/installation">Installation</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/linux">Linux</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Installing a single MySQL instance on a linux machine is a very simple operation. It may be as simple as:</p>
<blockquote>
<pre>apt-get install mysql-server</pre>
</blockquote>
<p>But you cannot use this method to install another MySQL instance. Moreover, if you try to manually install another instance, you may find that some collisions occur.</p>
<p>For example, when trying to install two 5.0 servers, apt-get or yum will just tell me &ldquo;package is already installed&rdquo;.</p>
<p>When trying to install a new 5.1 server along with 5.0, an implicit upgrade is performed.</p>
<p>But even if we try forcing the installation, there are collisions:</p>
<ul>
<li>A dpkg or rpm will install my.cnf under <strong>/etc</strong>. Two installations will override one another. With RPM you may get a .rpmsave backup file, but that doesn&rsquo;t help too much.</li>
<li>The daemon file: <strong>/etc/init.d/mysql(d)</strong> is overwritten.</li>
<li>The default data directory is used for both installations: <strong>/var/lib/mysql</strong></li>
<li>The binaries are overwritten</li>
<li>Both installations will use port 3306.</li>
<li>In both installations, the same socket file (e.g. <strong>/var/run/mysql/mysql.sock</strong>) is used.</li>
</ul>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/manually-installing-multiple-mysql-instances-on-linux-howto/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/mysql-security-data-integrity-issues/">MySQL security: data integrity issues</a></h2>

    <div class="post-meta">

  <div>

    <time>21 Jan 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/security">Security</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql_mode">sql_mode</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>MySQL&rsquo;s security model is not as elaborate as other popular databases. It&rsquo;s missing quite a lot.</p>
<p>I wish to point out what I think are some very disturbing security holes, which may affect the database integrity.</p>
<p>This post is not about Roles, Kerberos, IPs and such. It&rsquo;s about simple MySQL features, which allow common, unprivileged users, to break data integrity by using unprotected session variables.</p>
<p>I will consider three such issues.</p>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mysql-security-data-integrity-issues/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/do-we-need-sql_mode/">Do we need sql_mode?</a></h2>

    <div class="post-meta">

  <div>

    <time>08 Jan 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/installation">Installation</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql_mode">sql_mode</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>sql_mode must be one of the most elusive issues in setting up a MySQL database. It is also responsible for difficulties in migration, upgrading and securing of databases.</p>
<p>MySQL usually has little issues with migrating database from one machine to another, one version to another, one OS to another, one architecture to another. If we&rsquo;re not sure, we can always migrate using mysqldump&rsquo;s logical dump, right?</p>
<p>Not entirely right. The elusive sql_mode (empty by default) may affect out backup+restore, may affect our application behavior, may affect our data integrity.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/do-we-need-sql_mode/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/dangers-of-skip-grant-tables/">Dangers of skip-grant-tables</a></h2>

    <div class="post-meta">

  <div>

    <time>13 Nov 2008</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/security">Security</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>When MySQL&rsquo;s root password is lost and must be reset, there are two popular ways to create a new password. One of the options is far too popular, in my opinion.</p>
<p>The preferred way of setting a root&rsquo;s password is by using an init-file. The process for doing this is well explained in <a title="How to Reset the Root Password" href="http://dev.mysql.com/doc/refman/5.0/en/resetting-permissions.html">MySQL&rsquo;s manual</a>. Using this method requires creating a simple text file, in which the required</p>
<p><strong><code>GRANT ALL PRIVILEGES ON <em>.</em> TO &lsquo;root&rsquo;@&lsquo;localhost&rsquo; IDENTIFY BY &lsquo;****&rsquo; WIth GRANT OPTION;</code></strong></p>
<p>(or, alternatively,  <code><strong>SET PASSWORD &hellip;</strong></code>) statement is written.</p>
<p>An entry must be written to my.cnf, or supplied via command line parameters:</p>
<p><strong><code>init-file=/tmp/my-init-file.sql</code></strong></p>
<p>MySQL must then be restarted. Upon restart, and before opening any outside connections, the init-file is executed. Once MySQL is up and running, the init-file entry should be dropped.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/dangers-of-skip-grant-tables/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="/blog/mysql/mysql-parameters-configuration-sample-file/">MySQL parameters &amp; configuration sample file</a></h2>

    <div class="post-meta">

  <div>

    <time>17 Oct 2008</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/installation">Installation</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>The following is a sample my.cnf configuration file. It includes some common and uncommon parameters, along with occasional comments.</p>
<p>You can use this file, and tune as appropriate for your machine, operating system, and application needs.</p>
<p>In particular, note the high values set for the InnoDB related parameters, below, and change them to match your system and application&rsquo;s requirements. You have been warned.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mysql-parameters-configuration-sample-file/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
</div>

</div>
</div>
<script src="/blog/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'Your Google Analytics tracking ID', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>
