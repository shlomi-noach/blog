<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.16" />

  <title>Data Types &middot; code.openark.org</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/blog/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/blog/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  
  <link rel="alternate" type="application/rss+xml" title="code.openark.org" href="/blog/tag/data-types/index.xml" />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/blog/img/favicon.ico" type="image/x-icon" />


  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <a class="pure-menu-heading brand" href="/blog">openark.org</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/blog/page/about"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
      <li class="pure-menu-item">
        <a class="pure-menu-link" href="/blog/tag/data-types/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">
    <li class="pure-menu-item">
      <a class="pure-menu-link">
        Shlomi Noach
        
          <div class="avatar-container">
        	  <div class="avatar-img-border">
                <img class="avatar-img" src="/blog/images/shlomi-noach.png" alt="code.openark.org" />
        	  </div>
        	</div>
        
      </a>
    </li>

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/shlomi-noach" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/ShlomiNoach" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/shlominoach" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>





  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Data Types</h1>
</div>

<div class="content">
  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/re-mysql-5-1-vs-mysql-5-5-floats-doubles-and-scientific-notation/">Re: MySQL 5.1 vs. MySQL 5.5: Floats, Doubles, and Scientific Notation</a></h2>

    <div class="post-meta">

  <div>

    <time>24 Jan 2013</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/open-source">Open Source</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/percona-toolkit">Percona Toolkit</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Reading Sheeri&rsquo;s <a href="http://blog.mozilla.org/it/2013/01/17/mysql-5-1-vs-mysql-5-5-floats-doubles-and-scientific-notation/">MySQL 5.1 vs. MySQL 5.5: Floats, Doubles, and Scientific Notation</a>, I was baffled at this change of floating point number notation.</p>
<p>However, I was also concerned about the final action taken: using <strong>&rdquo;&ndash;ignore-columns&rdquo;</strong> to avoid comparing the <strong>FLOAT</strong>/<strong>DOUBLE</strong> types.</p>
<p>The <a href="http://www.percona.com/doc/percona-toolkit/2.0/pt-table-checksum.html#cmdoption-pt-table-checksum--float-precision">&ndash;float-precision</a> option for <em>pt-table-checksum</em> currently only uses <strong>ROUND()</strong> so as to disregard minor rounding issues. But it can very easily extend to handle the difference in floating point notation. Consider again the problem:</p>
<blockquote>
<pre>mysql&gt; create table tf(f float);
Query OK, 0 rows affected (0.11 sec)</p>

<p>mysql&gt; insert into tf values(0.0000958084);
Query OK, 1 row affected (0.04 sec)</p>

<p>mysql-<strong>5.1</strong>&gt; select * from tf;
+&mdash;&mdash;&mdash;&mdash;-+
| f           |
+&mdash;&mdash;&mdash;&mdash;-+
| 9.58084e-05 |
+&mdash;&mdash;&mdash;&mdash;-+</p>

<p>mysql-<strong>5.5</strong>&gt; select * from tf;
+&mdash;&mdash;&mdash;&mdash;&ndash;+
| f            |
+&mdash;&mdash;&mdash;&mdash;&ndash;+
| 0.0000958084 |
+&mdash;&mdash;&mdash;&mdash;&ndash;+</pre>
</blockquote>
<p>How can we normalize the notation?</p>
<p>Easily: <strong>CAST</strong> it as <strong>DECIMAL</strong>. Consider:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/re-mysql-5-1-vs-mysql-5-5-floats-doubles-and-scientific-notation/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/char-and-spaces/">CHAR and spaces</a></h2>

    <div class="post-meta">

  <div>

    <time>12 Jun 2012</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>I know about it, I knew about it all along, but&hellip; it&rsquo;s so easy to fall for it; there&rsquo;s just so much absurdity!</p>
<p>A <strong>CHAR</strong> type has a known number of characters. For example, the column:</p>
<blockquote>
<pre>CountryCode CHAR(3) CHARSET ascii NOT NULL</pre>
</blockquote>
<p>- is known to have exactly three characters. These could be <strong>&lsquo;USA&rsquo;</strong>, <strong>&lsquo;FRA&rsquo;</strong>, etc.</p>
<p>What happens with spaces? A SQL <strong>CHAR</strong> type ignores any trailing spaces; thus, the code <strong>&lsquo;GB &lsquo;</strong> (the characters <strong>&lsquo;G&rsquo;</strong>, <strong>&lsquo;B&rsquo;</strong>, and the space <strong>&rsquo; &lsquo;</strong>) is interpreted as <strong>&lsquo;GB&rsquo;</strong>. Trailing spaces are not regarded as part of the text. Want to see some absurdity?</p>
<blockquote>
<pre>CREATE TABLE <code>c_test</code> (
  <code>c</code> char(1) DEFAULT NULL
);
INSERT INTO c_test VALUES (&lsquo;a&rsquo;);
INSERT INTO c_test VALUES (&lsquo;b&rsquo;);
INSERT INTO c_test VALUES (&rsquo; &lsquo;);</p>

<p>SELECT c, LENGTH&copy;, c = &lsquo;a&rsquo;, c = &lsquo;b&rsquo;, c = &lsquo; &lsquo;, LENGTH(&rsquo; &lsquo;) FROM c_test;
+&mdash;&mdash;+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;-+
| c    | LENGTH&copy; | c = &lsquo;a&rsquo; | c = &lsquo;b&rsquo; | c = &lsquo; &rsquo; | LENGTH(&rsquo; &lsquo;) |
+&mdash;&mdash;+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;-+
| a    |         1 |       1 |       0 |       0 |           1 |
| b    |         1 |       0 |       1 |       0 |           1 |
|      |         0 |       0 |       0 |       1 |           1 |
+&mdash;&mdash;+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;-+</pre>
</blockquote>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/char-and-spaces/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/235959-is-not-the-end-of-the-day-no-really/">23:59:59 is not the end of the day. No, really!</a></h2>

    <div class="post-meta">

  <div>

    <time>27 Jul 2011</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>How would you check whether some <strong>TIMESTAMP</strong> column falls within a given day, say <strong>July 26th, 2011</strong>?</p>
<p>This is a question I tend to ask students, and usually I get the same range of answers. Some are wrong; some cannot utilize an index, some are correct, and some are <em>temporarily correct</em>. I wish to take a closer look at the last. Such an answer looks like this:</p>
<blockquote>
<pre>SELECT * FROM some_table WHERE timstamp_column BETWEEN &lsquo;2011-07-26 00:00:00&rsquo; AND &lsquo;2011-07-26 23:59:59&rsquo;</pre>
</blockquote>
<p>Yikes! I get my allergies when I see this one.</p>
<p>Technically this seems correct. And it seems to work so far for people. There are two things that disturb me:</p>
<ol>
<li><strong>&lsquo;23:59:59&rsquo;</strong> refers to the beginning of the last second of the day. This means a full second is missing in concept. No one would write such a code on a C, Java or PHP application: that would be a newbie&rsquo;s mistake. But people feel at ease doing it with SQL</li>
<p>Of course, this works when timestamps are in a one second resolution. Which leads me to:</p>
<li>One second resolution is a temporary issue. Already <a href="http://kb.askmonty.org/en/what-is-mariadb-53">MariaDB 5.3</a> presents with microsecond support for NOW() and TIMESTAMP, TIME and DATETIME columns. Sometime in the not-so-far future the standard MySQL distribution will have that, too.</li>
</ol>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/235959-is-not-the-end-of-the-day-no-really/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/announcing-common_schema-common-views-routines-for-mysql/">Announcing common_schema: common views &amp; routines for MySQL</a></h2>

    <div class="post-meta">

  <div>

    <time>13 Jul 2011</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/analysis">Analysis</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/common_schema">common_schema</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/development">Development</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/indexing">Indexing</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/information_schema">INFORMATION_SCHEMA</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/monitoring">Monitoring</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/open-source">Open Source</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/schema">Schema</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/security">Security</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql">SQL</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/stored-routines">Stored routines</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Today I have released <a title="common_schema" href="http://code.openark.org/forge/common_schema">common_schema</a>, a utility schema for MySQL which includes many views and functions, and is aimed to be installed on any MySQL server.</p>
<h4>What does it do?</h4>
<p>There are views answering for all sorts of useful information: stuff related to schema analysis, data dimensions, monitoring, processes &amp; transactions, security, internals&hellip; There are basic functions answering for common needs.</p>
<p>Some of the views/routines simply formalize those queries we tend to write over and over again. Others take the place of external tools, answering complex questions via SQL and metadata. Still others help out with SQL generation.</p>
<p>Here are a few highlights:</p>
<ul>
<li>Did you know you can work out <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/global_status_diff_nonzero.html">simple monitoring</a> of your server with a <em>query</em>?  There&rsquo;s a view to do that for you.</li>
<li>How about showing just <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/processlist_top.html">the good parts of the processlist</a>?</li>
<li>Does your schema have <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/redundant_keys.html">redundant keys</a>?</li>
<li>Or InnoDB tables with <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/no_pk_innodb_tables.html">no PRIMARY KEY</a>?</li>
<li>Is AUTO_INCREMENT <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/auto_increment_columns.html">running out of space</a>?</li>
<li>Can I get the SQL statements to <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/sql_foreign_keys.html">generate my FOREIGN KEYs</a>? To drop them?</li>
<li>And can we finally get <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/sql_show_grants.html">SHOW GRANTS for all accounts</a>, and as an <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/sql_grants.html">SQL query</a>?</li>
<li>Ever needed a <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/general_functions.html#crc64">64 bit CRC function</a>?</li>
<li>And aren&rsquo;t you tired of writing the cumbersome SUBSTRING_INDEX(SUBSTRING_INDEX(str, &lsquo;,&rsquo;, 3), &lsquo;,&rsquo;, -1)? <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/string_functions.html#split_token">There&rsquo;s an alternative</a>.</li>
</ul>
<p>There&rsquo;s more. Take a look at the <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/introduction.html">common_schema documentation</a> for full listing. And it&rsquo;s evolving: I&rsquo;ve got quite a few ideas already for future components.</p>
<p>Some of these views rely on heavyweight INFORMATION_SCHEMA tables. You should be aware of the impact and <a href="http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/risks.html">risks</a>.</p>
<h4>What do I need to install?</h4>
<p>There&rsquo;s no script or executable file. It&rsquo;s just a schema. The distribution in an SQL file which generates <em>common_schema</em>. Much like a dump file.</p>
<h4></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/announcing-common_schema-common-views-routines-for-mysql/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/timestamp-vs-datetime-which-should-i-be-using/">TIMESTAMP vs. DATETIME, which should I be using?</a></h2>

    <div class="post-meta">

  <div>

    <time>22 May 2011</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>They both look the same, have roughly the same use. Nevertheless, they differ in many respects. I&rsquo;ll note the difference, and note a few pitfalls and peculiarities.</p>
<h4>Range</h4>
<p><strong>TIMESTAMP</strong> starts with the <a href="http://en.wikipedia.org/wiki/Unix_time">epoch</a>, <strong>&lsquo;1970-01-01 00:00:01&rsquo;</strong> UTC and ends with <strong>&lsquo;2038-01-19 03:14:07&rsquo;</strong> UTC. This is all very nice today, and may actually hold up till our retirement, but the younger readers may yet have to deal with the <strong>Bug2K+38</strong>™, certain to arrive.</p>
<p><strong>DATETIME</strong> starts with <strong>&lsquo;1000-01-01 00:00:00&rsquo;</strong> and lasts up to <strong>&lsquo;9999-12-31 23:59:59&rsquo;</strong>. More on that later.</p>
<p>In respect of range, your current event logs may well use a <strong>TIMESTAMP</strong> value, while your grandfather&rsquo;s and granddaughter&rsquo;s birth dates may require <strong>DATETIME</strong>.</p>
<p>In general I would suggest that anything that relates to <em>now</em>, can be a <strong>TIMESTAMP</strong>. A new entry is added? It is added <em>now</em>. It can be represented by a <strong>TIMESTAMP</strong>. Anything has an expiry time of a few minutes, perhaps a few days or a month? You&rsquo;ll be safe using it up till late <strong>2037</strong>. Anything else had better use a <strong>DATETIME</strong>. In particular, dates relating to issues such as birth, insurance, the market etc. fall into this category.</p>
<p><em>History</em>, however, does not even hold up with <strong>DATETIME</strong>. Rome fell long before <strong>MIN(DATETIME)</strong>. You will have to manage your own. Not even <strong>YEAR</strong> will help you out.</p>
<h4>Storage</h4>
<p><strong>TIMESTAMP</strong> makes for <strong>4</strong> bytes. <strong>DATETIME</strong> makes for <strong>8</strong> bytes. Now that we have this behind us, let&rsquo;s see why.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/timestamp-vs-datetime-which-should-i-be-using/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/implicit-casting-you-dont-want-to-see-around/">Implicit casting you don&#39;t want to see around</a></h2>

    <div class="post-meta">

  <div>

    <time>07 Jul 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql">SQL</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>In <a href="http://code.openark.org/blog/mysql/beware-of-implicit-casting">Beware of implicit casting</a>, I have outlined the dangers of implicit casting. Here&rsquo;s a few more real-world examples I have tackled:</p>
<h4>Number-String comparisons</h4>
<p>Much like in programming languages, implicit casting is made to numbers when at least one of the arguments is a number. Thus:</p>
<blockquote><pre>
mysql&gt; SELECT 3 = &lsquo;3.0&rsquo;;
+&mdash;&mdash;&mdash;&ndash;+
| 3 = &lsquo;3.0&rsquo; |
+&mdash;&mdash;&mdash;&ndash;+
|         1 |
+&mdash;&mdash;&mdash;&ndash;+
1 row in set (0.00 sec)
mysql&gt; SELECT &lsquo;3&rsquo; = &lsquo;3.0&rsquo;;
+&mdash;&mdash;&mdash;&mdash;-+
| &lsquo;3&rsquo; = &lsquo;3.0&rsquo; |
+&mdash;&mdash;&mdash;&mdash;-+
|           0 |
+&mdash;&mdash;&mdash;&mdash;-+
</pre></blockquote>
<p>The second query consists of pure strings comparison. It has no way to determine that number comparison should be made.</p>
<h4>Direct DATE arithmetics</h4>
<p>The first query <em>seems</em> to work, but is completely incorrect. The second explains why. The third is a total mess.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/implicit-casting-you-dont-want-to-see-around/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/choosing-mysql-boolean-data-types/">Choosing MySQL boolean data types</a></h2>

    <div class="post-meta">

  <div>

    <time>03 Jun 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql">SQL</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>How do you implement <strong>True</strong>/<strong>False</strong> columns?</p>
<p>There are many ways to do it, each with its own pros and cons.</p>
<h4>ENUM</h4>
<p>Create you column as <strong>ENUM(&lsquo;F&rsquo;, &rsquo;T&rsquo;)</strong>, or <strong>ENUM(&lsquo;N&rsquo;,&lsquo;Y&rsquo;)</strong> or <strong>ENUM(&lsquo;0&rsquo;, &lsquo;1&rsquo;)</strong>.</p>
<p>This is the method used in the <strong>mysql</strong> tables (e.g. <strong>mysql.user</strong> privileges table). It&rsquo;s very simple and intuitive. It truly restricts the values to just two options, which serves well. It&rsquo;s compact (just one byte).</p>
<p>A couple disadvantages to this method:</p>
<ol>
<li>Enums are represented by numerical values (which is good) and start with <strong>1</strong> instead of <strong>0</strong>. This means <strong>&lsquo;F&rsquo;</strong> is <strong>1</strong>, and <strong>&rsquo;T&rsquo;</strong> is <strong>2</strong>, and they both translate to <strong>True</strong> when directly used in a booleanic expression (e.g. <strong>IF(val, &lsquo;True&rsquo;, &lsquo;False&rsquo;)</strong> always yields <strong>&lsquo;True&rsquo;</strong>)</li>
<li>There&rsquo;s no real convention. Is it <strong>&lsquo;Y&rsquo;/&lsquo;N&rsquo;</strong>? <strong>&rsquo;T&rsquo;/&lsquo;F&rsquo;</strong>? <strong>&lsquo;P&rsquo;/&lsquo;N&rsquo;</strong>? <strong>&lsquo;1&rsquo;/&lsquo;0&rsquo;</strong>?</li>
</ol>
<h4>CHAR(1)</h4>
<p>Simple again. Proposed values are, as before, <strong>&lsquo;F&rsquo;</strong>, <strong>&rsquo;T&rsquo;</strong> etc. This time there&rsquo;s no way to limit the range of values. You cannot (in MySQL, unless using triggers) prevent an &lsquo;X&rsquo;.</p>
<p>Watch out for the charset! If it&rsquo;s <strong>utf8</strong> you pay with 3 bytes instead of just 1. And, again, <strong>&rsquo;T&rsquo;</strong>, <strong>&lsquo;F&rsquo;</strong>, <strong>&lsquo;Y&rsquo;</strong>, <strong>&lsquo;N&rsquo;</strong> values all evaluate as <strong>True</strong>. It is possible to use the zero-valued character, but it defeats the purpose of using <strong>CHAR</strong>.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/choosing-mysql-boolean-data-types/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/but-i-do-want-mysql-to-say-error/">But I DO want MySQL to say &#34;ERROR&#34;!</a></h2>

    <div class="post-meta">

  <div>

    <time>12 Mar 2010</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql_mode">sql_mode</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/syntax">Syntax</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>MySQL is known for its willingness to accept invalid queries, data values. It can silently commit your transaction, truncate your data.</p>
<ul>
<li>Using <strong>GROUP_CONCAT</strong> with a small <strong>group_concat_max_len</strong> setting? Your result will be silently truncated (make sure to check the warnings though).</li>
<li>Calling <strong>CREATE <span style="text-decoration: line-through;">TEMPORARY</span> TABLE</strong>? You get <a href="http://www.joinfu.com/2010/03/a-follow-up-on-the-sql-puzzle/">silent commit</a>.</li>
<li>Issuing a <strong>ROLLBACK</strong> on non-transactional involved engines? Have a warning; no error.</li>
<li>Using <strong>LOCK IN SHARE MODE</strong> on non transactional tables? Not a problem. Nothing reported.</li>
<li>Adding a <strong>FOREIGN KEY</strong> on a MyISAM table? Good for you; no action actually taken.</li>
<li>Inserting <strong>300</strong> to a <strong>TINYINT</strong> column in a relaxed <strong>sql_mode</strong>? Give me <strong>255</strong>, I&rsquo;ll silently drop the remaining <strong>45</strong>. I owe you.</li>
</ul>
<h4>Warnings and errors</h4>
<p>It would be nice to:</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/but-i-do-want-mysql-to-say-error/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/useful-temporal-functions-queries/">Useful temporal functions &amp; queries</a></h2>

    <div class="post-meta">

  <div>

    <time>08 Dec 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/indexing">Indexing</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql">SQL</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Here&rsquo;s a complication of some common and useful time &amp; date calculations and equations. Some, though very simple, are often misunderstood, leading to inefficient or incorrect implementations.</p>
<p>There are many ways to solve such problems. I&rsquo;ll present my favorites.</p>
<h4>Querying for time difference</h4>
<p>Given two timestamps: <em>ts1</em> (older) and <em>ts2</em> (newer), how much time has passed between them?</p>
<p>One can use <strong>TIMEDIFF()</strong> &amp; <strong>DATEDIFF()</strong>, or compare two <strong>UNIX_TIMESTAMP()</strong> values. My personal favorite is to use <strong>TIMESTAMPDIFF()</strong>. Reason being that I&rsquo;m usually interested in a specific metric, like the number of hours which have passed, or the number of days, disregarding the smaller minute/second resolution. Which allows one to:</p>
<blockquote>
<pre>SELECT TIMESTAMPDIFF(HOUR, ts1, ts2)</pre>
</blockquote>
<p>Take, for example:</p>
<blockquote>
<pre>SELECT TIMESTAMPDIFF(MONTH, &lsquo;2008-10-07 00:00:00&rsquo;, &lsquo;2009-12-06 00:00:00&rsquo;)</pre>
</blockquote>
<p>The function correctly identifies the number of days per month, and provides with <strong>13</strong>, being the truncated number of full months.</p>
<h4>Doing arithmetics</h4>
<p>One can use <strong>TIMESTAMPADD()</strong>, or <strong>DATE_SUB()</strong>, but, again, when dealing with specific resolutions, I find &ldquo;<strong>+ INTERVAL</strong>&rdquo; to be the most convenient:</p>
<blockquote>
<pre>SELECT ts1 + INTERVAL 10 HOUR</pre>
</blockquote>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/useful-temporal-functions-queries/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/character-sets-latin1-vs-ascii/">Character sets: latin1 vs. ascii</a></h2>

    <div class="post-meta">

  <div>

    <time>08 Jul 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/configuration">Configuration</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>Unless specified otherwise, <strong>latin1</strong> is the default character set in MySQL.</p>
<p>What I usually find in schemes are columns which are either <strong>utf8</strong> or <strong>latin1</strong>. The <strong>utf8</strong> columns being those which need to contain multilingual characters (user names, addresses, articles etc.), and <strong>latin1</strong> column being all the rest (passwords, digests, email addresses, hard-coded values etc.)</p>
<p>I find <strong>latin1</strong> to be improper for such purposes and suggest that <strong>ascii</strong> be used instead. The reason being that <strong>latin1</strong> implies a European text (with swedish collation). It is unclear for an outsider, when finding a <strong>latin1</strong> column, whether it should actually contain West European characters, or is it just being used for ascii text, utilizing the fact that a character in <strong>latin1</strong> only requires 1 byte of storage.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/character-sets-latin1-vs-ascii/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/the-depth-of-an-index-primer/">The depth of an index: primer</a></h2>

    <div class="post-meta">

  <div>

    <time>09 Apr 2009</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/indexing">Indexing</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/innodb">InnoDB</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/myisam">MyISAM</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>InnoDB and MyISAM use B+ and B trees for indexes (InnoDB also has internal hash index).</p>
<p>In both these structures, the depth of the index is an important factor. When looking for an indexed row, a search is made on the index, from root to leaves.</p>
<p>Assuming the index is not in memory, the depth of the index represents the minimal cost (in I/O operation) for an index based lookup. Of course, most of the time we expect large portions of the indexes to be cached in memory. Even so, the depth of the index is an important factor. The deeper the index is, the worse it performs: there are simply more lookups on index nodes.</p>
<p>What affects the depth of an index?</p>
<p>There are quite a few structural issues, but it boils down to two important factors:</p>
<ol>
<li>The number of rows in the table: obviously, more rows leads to larger index, larger indexes grow in depth.</li>
<li>The size of the indexed column(s). An index on an INT column can be expected to be shallower than an index on a CHAR(32) column (on a very small number of rows they may have the same depth, so we&rsquo;ll assume a large number of rows).</li>
</ol>
<p></p>

  </p>

  
  <footer>
    <a href="/blog/mysql/the-depth-of-an-index-primer/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/mysqls-character-sets-and-collations-demystified/">MySQL&#39;s character sets and collations demystified</a></h2>

    <div class="post-meta">

  <div>

    <time>08 Dec 2008</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/sql">SQL</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/syntax">Syntax</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>MySQL&rsquo;s character sets and collations are often considered as a mystery, and many users either completely disregard them and keep with the defaults, or set everything to UTF8.</p>
<p>This post will attempt to shed some light on the mystery, and provide with some best practices for use with text columns with regard to character sets.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/mysqls-character-sets-and-collations-demystified/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header class="index-header">
    <h2><a href="/blog/mysql/common-data-types-errors-compilation/">Common wrong Data Types compilation</a></h2>

    <div class="post-meta">

  <div>

    <time>18 Nov 2008</time>
  </div>

  

  

  <div>
    
      
      
        <span>
          
            <a class="post-taxonomy-category" href="/blog/category/mysql">MySQL</a>
          
        </span>
      
    

    
      
      
        <span>
          <i class="fa fa-tags fa-fw"></i>
          
            <a class="post-taxonomy-tag" href="/blog/tag/data-types">Data Types</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/normalization">Normalization</a>&nbsp;&#47;
          
            <a class="post-taxonomy-tag" href="/blog/tag/schema">Schema</a>
          
        </span>
      
    
  </div>

</div>


  </header>

  <p>
  <p><p>During my work with companies using MySQL, I have encountered many issues with regard to schema design, normalization and indexing. Of the most common errors are incorrect data types definition. Many times the database is designed by programmers or otherwise non-expert DBAs. Some companies do not have the time and cannot spare the effort of redesigning and refactoring their databases, and eventually face poor performance issues.</p>
<p>Here&rsquo;s a compilation of &ldquo;the right and the wrong&rdquo; data types.</p>

  </p>

  
  <footer>
    <a href="/blog/mysql/common-data-types-errors-compilation/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
</div>

</div>
</div>
<script src="/blog/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'Your Google Analytics tracking ID', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>
