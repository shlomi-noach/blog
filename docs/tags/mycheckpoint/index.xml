<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Mycheckpoint on code.openark.org</title>
    <link>/blog/tags/mycheckpoint/</link>
    <description>Recent content in Mycheckpoint on code.openark.org</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016. All rights reserved.</copyright>
    <lastBuildDate>Thu, 06 Mar 2014 12:27:28 +0000</lastBuildDate>
    <atom:link href="/blog/tags/mycheckpoint/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>mycheckpoint, discontinued</title>
      <link>/blog/mysql/mycheckpoint-discontinued/</link>
      <pubDate>Thu, 06 Mar 2014 12:27:28 +0000</pubDate>
      
      <guid>/blog/mysql/mycheckpoint-discontinued/</guid>
      <description>&lt;p&gt;Time to admit to myself: &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt; has to be discontinued.&lt;/p&gt;
&lt;p&gt;I started &lt;em&gt;mycheckpoint&lt;/em&gt; back in &lt;strong&gt;2009&lt;/strong&gt;, as a free &amp;amp; open source lightweight monitoring tool for MySQL. Over some years it evolved and became an actual (lightweight) monitoring solution, used by many. It has a unique and original design, which, alas, is also its bane.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; uses the relational model &amp;amp; SQL to store and query monitored metrics. This leads to quite a sophisticated service, which can make practically anything visible to the user. The raw data is just numbers. but with some SQL-Fu one can &lt;a href=&#34;http://code.openark.org/blog/mysql/generating-google-line-charts-with-sql-part-ii&#34;&gt;generate charts out of it&lt;/a&gt;,  (&lt;a href=&#34;http://mycheckpoint.googlecode.com/svn/trunk/doc/html/sample/http/mcp_sql00/sv_report_html_brief&#34;&gt;interactive&lt;/a&gt; ones as well), human readable &lt;a href=&#34;http://mycheckpoint.googlecode.com/svn/trunk/doc/html/sample/http/mcp_sql00/sv_report_html_brief&#34;&gt;reports&lt;/a&gt; and full blown email messages. It is still the only common solution I&#39;m aware of that &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/detecting-parameters-change&#34;&gt;keeps track of variable changes&lt;/a&gt; and provides with clear &#34;what changed, when, from value &amp;amp; to_value&#34;. I caught many deployment bugs by just observing this. It&#39;s a single file that provides with full blown HTTP service, alerting, mail notifications, multi-database monitoring, custom monitoring queries, query execution time monitoring, OS metrics, ...&lt;/p&gt;
&lt;p&gt;While developing &lt;em&gt;mycheckpoint&lt;/em&gt; I learned a lot on MySQL status &amp;amp; configuration, complex SQL queries, Python, linux, packaging and more. I got a lot of feedback from users, as I still do (thank you!). Didn&#39;t always manage to fix all bugs or answer all questions.&lt;/p&gt;
&lt;p&gt;The design of &lt;em&gt;mycheckpoint&lt;/em&gt; does not meet today&#39;s reality. Heck, today there are more counters &amp;amp; variables than possible table columns. The schema-per-monitored-instance design makes for simplicity, but does not fare well with dozens or hundreds of servers to monitor. There is no cross-instance aggregation or visualization of data. The per-&lt;strong&gt;10&lt;/strong&gt; minute aggregation is too rough. &lt;em&gt;There isn&#39;t a test suite&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Some of the above issues can be fixed, and if you like, the source code is still &lt;a href=&#34;http://code.google.com/p/mycheckpoint/source/checkout&#34;&gt;freely available&lt;/a&gt;. I&#39;ll even migrate the entire SVN to GitHub at some stage. But I believe the current state might only be good for small scale deployments;  not something you would consider to scale up with.&lt;/p&gt;
&lt;p&gt;For me, there&#39;s nothing more motivating in code development than knowing the code will go public. The efforts in making the code look as best it can, as easily deployable as possibly can, with good documentation, makes for a lot of effort - but very satisfying. Open Source FTW!!!1&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>mycheckpoint revision 231 released</title>
      <link>/blog/mysql/mycheckpoint-revision-released/</link>
      <pubDate>Thu, 23 May 2013 14:21:52 +0000</pubDate>
      
      <guid>/blog/mysql/mycheckpoint-revision-released/</guid>
      <description>&lt;p&gt;A &lt;a href=&#34;http://code.google.com/p/mycheckpoint/&#34;&gt;new release&lt;/a&gt; for &lt;strong&gt;&lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;&lt;/strong&gt;: lightweight, SQL oriented MySQL monitoring solution.&lt;/p&gt;
&lt;p&gt;If you&#39;re unfamiliar with &lt;em&gt;mycheckpoint&lt;/em&gt;, well, the one minute sales pitch is: it&#39;s a free and open source monitoring tool for MySQL, which is extremely easy to install and execute, and which includes &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/custom-monitoring&#34;&gt;custom queries&lt;/a&gt;, &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/alerts&#34;&gt;alerts&lt;/a&gt; (via &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/emails&#34;&gt;emails&lt;/a&gt;), and out of the box &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/http-web-server&#34;&gt;HTTP server&lt;/a&gt; and &lt;a href=&#34;http://mycheckpoint.googlecode.com/svn/trunk/doc/html/sample/http/mcp_sql00/sv_report_html_brief&#34;&gt;charting&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This is mostly a maintenance release, with some long-time requested features, and of course solved bugs. Here are a few highlights:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Supports MariaDB and MySQL 5.6 (issues with new variables, space padded variables, text-valued variables)&lt;/li&gt;
&lt;li&gt;Supports alerts via function invocation on monitored host (so not only checking alerts via aggregated data like &lt;strong&gt;&#39;Seconds_behind_master&#39;&lt;/strong&gt; but also by &lt;strong&gt;SELECT my_sanity_check_function()&lt;/strong&gt; on monitored instance). See &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/alerts&#34;&gt;alerts.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Supports single-running-instance via &lt;strong&gt;&#34;--single&#34;&lt;/strong&gt; command line argument&lt;/li&gt;
&lt;li&gt;Supports strict &lt;strong&gt;sql_mode&lt;/strong&gt;, including &lt;strong&gt;ONLY_FULL_GROUP_BY&lt;/strong&gt;, overcoming &lt;a href=&#34;http://bugs.mysql.com/bug.php?id=69310&#34;&gt;bug #69310&lt;/a&gt;.&lt;strong&gt;&lt;br /&gt;
&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Supports sending of pending email HTML report&lt;/li&gt;
&lt;li&gt;Better re-deployment process&lt;/li&gt;
&lt;li&gt;Better recognizing of SIGNED/UNSIGNED values&lt;/li&gt;
&lt;li&gt;Some other improvements in charting, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; is released under the BSD license.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://code.google.com/p/mycheckpoint/&#34;&gt;Downloads are available&lt;/a&gt; from the project&#39;s page.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>MySQL monitoring: storing, not caching</title>
      <link>/blog/mysql/mysql-monitoring-storing-not-caching/</link>
      <pubDate>Wed, 22 Feb 2012 09:44:47 +0000</pubDate>
      
      <guid>/blog/mysql/mysql-monitoring-storing-not-caching/</guid>
      <description>&lt;p&gt;I&#39;ve followed with interest on Baron&#39;s &lt;a href=&#34;http://www.mysqlperformanceblog.com/2012/02/19/why-dont-our-new-nagios-plugins-use-caching/&#34;&gt;Why don’t our new Nagios plugins use caching?&lt;/a&gt; and Sheeri&#39;s &lt;a href=&#34;http://www.sheeri.com/content/caching-monitoring-timing-everything&#34;&gt;Caching for Monitoring: Timing is Everything&lt;/a&gt;. I wish to present my take on this, from &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;&#39;s point of view.&lt;/p&gt;
&lt;p&gt;So &lt;em&gt;mycheckpoint&lt;/em&gt; works in a completely different way. On one hand, it doesn&#39;t bother with caching. On the other hand, it doesn&#39;t bother with re-reads of data.&lt;/p&gt;
&lt;p&gt;There are no staleness issues, the data is consistent as it can get (you can &lt;em&gt;never&lt;/em&gt; get a completely atomic read of everything in MySQL), and you can issue as many calculations as you want at the price of one take of monitoring. As in Sheere&#39;s example, you can run &lt;strong&gt;Threads_connected/max_connections*100&lt;/strong&gt;, mix status variables, system variables, meta-variables (e.g. Seconds_behind_master), user-created variables (e.g. number of purchases in your online shop) etc.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt;&#39;s concept is to &lt;strong&gt;store&lt;/strong&gt; data. And store it in relational format. That is, &lt;strong&gt;INSERT&lt;/strong&gt; it to a table.&lt;/p&gt;
&lt;p&gt;A sample-run generates a row, which lists all status, server, OS, user, meta variables. It&#39;s a huge row, with hundreds of columns. Columns like &lt;strong&gt;threads_connected&lt;/strong&gt;, &lt;strong&gt;max_connections&lt;/strong&gt;, &lt;strong&gt;innodb_buffer_pool_size&lt;/strong&gt;, &lt;strong&gt;seconds_behind_master&lt;/strong&gt;, etc.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; hardly cares about these columns. It identifies them dynamically. Have you just upgraded to MySQL &lt;strong&gt;5.5&lt;/strong&gt;? Oh, there&#39;s a new bunch of server and status variables? No problem, &lt;em&gt;mycheckpoint&lt;/em&gt; will notice it doesn&#39;t have the matching columns and will add them via ALTER TABLE. There you go, now we have a place to store them.&lt;/p&gt;
&lt;p&gt;Running a formula like &lt;strong&gt;Threads_connected/max_connections*100&lt;/strong&gt; is as easy as issuing the following query:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT Threads_connected/max_connections*100 FROM status_variables WHERE id = ...&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;Hmmm. This means I can run this formula on the most recent row I&#39;ve just added. But wait, this also means I can run this formula on &lt;em&gt;any&lt;/em&gt; row I&#39;ve ever gathered.&lt;!--more--&gt;&lt;/p&gt;
&lt;p&gt;With &lt;em&gt;mycheckpoint&lt;/em&gt; you can generate graphs &lt;strong&gt;retroactively&lt;/strong&gt; using new formulas. The data is there, vanilla style. Any formula which can be calculated via SQL is good to go with. Plus, you get the benefit of cross referencing in fun ways: cross reference to the timestamp at which the sample was taken (so, for example, ignore the spikes generated at this and that timeframe due to maintenance. Don&#39;t alert me on these), to system issues like load average or CPU usage (show me the average &lt;strong&gt;Seconds_behind_master&lt;/strong&gt; when load average is over &lt;strong&gt;8&lt;/strong&gt;, or the average load average when slow query rate is over some threshold. You don&#39;t do that all the time, but when you need it, well, you can get all the insight you ever wanted.&lt;/p&gt;
&lt;p&gt;Actually storing the monitored data in an easy to access format allows one to query, re-query, re-formulate. No worries about caching, you only sample once.&lt;/p&gt;
&lt;p&gt;For completeness, all the above is relevant when the data is of numeric types. Other types are far more complicated to manage (the list of running queries is a common example).&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Documentation in SQL: CALL for help()</title>
      <link>/blog/mysql/documentation-in-sql-call-for-help/</link>
      <pubDate>Wed, 11 Jan 2012 09:01:54 +0000</pubDate>
      
      <guid>/blog/mysql/documentation-in-sql-call-for-help/</guid>
      <description>&lt;p&gt;Documentation is an important part of any project. On the projects I maintain I put a lot of effort on documentation, and, frankly, the majority of time spent on my projects is on documentation.&lt;/p&gt;
&lt;p&gt;The matter of keeping the documentation faithful is a topic of interest. I&#39;d like to outline a few documentation bundling possibilities, and the present the coming new documentation method for &lt;a href=&#34;http://code.google.com/p/common-schema/&#34; rel=&#34;nofollow&#34;&gt;common_schema&lt;/a&gt;. I&#39;ll talk about any bundling that is NOT &lt;em&gt;man pages&lt;/em&gt;.&lt;/p&gt;
&lt;h4&gt;High level: web docs&lt;/h4&gt;
&lt;p&gt;This is the initial method of documentation I used for &lt;a title=&#34;openark kit&#34; href=&#34;../../forge/openark-kit&#34;&gt;openark kit&lt;/a&gt; and &lt;a title=&#34;mycheckpoint&#34; href=&#34;../../forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;. It&#39;s still valid for &lt;em&gt;mycheckpoint&lt;/em&gt;. Documentation is web-based. You need Internet access to read it. It&#39;s in HTML format.&lt;/p&gt;
&lt;p&gt;Well, not exactly HTML format: I wrote it in WordPress. Yes, it&#39;s HTML, but there&#39;s a lot of noise around (theme, menus, etc.) which is not strictly part of the documentation.&lt;/p&gt;
&lt;p&gt;While this is perhaps the easiest way to go, here&#39;s a few drawbacks:&lt;!--more--&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You&#39;re bound to some framework (WordPress in this case)&lt;/li&gt;
&lt;li&gt;Docs are split between MySQL database (my underlying WordPRess storage) &amp;amp; WordPress files (themes, style, header, footer etc.)&lt;/li&gt;
&lt;li&gt;Documentation is separate from your code - they&#39;re just not in the same place&lt;/li&gt;
&lt;li&gt;There is no version control over the documentation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The result is a single source of documentation, which applies to whatever version is latest. It&#39;s impossible to maintain docs for multiple versions. You must manually synchronize your WordPress updates with code commits (or rather - code release!).&lt;/p&gt;
&lt;h4&gt;Mid level: version controlled HTML docs&lt;/h4&gt;
&lt;p&gt;I first saw this approach on Baron&#39;s &lt;a href=&#34;http://www.xaprb.com/blog/2010/09/22/aspersa-gets-a-user-manual/&#34; rel=&#34;bookmark&#34;&gt;Aspersa gets a user manual&lt;/a&gt; post. I loved it: the documentation is HTML, but stored as part of your project&#39;s code, in same version control.&lt;/p&gt;
&lt;p&gt;This means one can &lt;a href=&#34;http://openarkkit.googlecode.com/svn/trunk/openarkkit/doc/html/introduction.html&#34;&gt;browse the documentation&lt;/a&gt; (&lt;em&gt;openark kit&lt;/em&gt; in this example) exactly as it appears in the baseline. Depending on your project hosting, one may be able to do so per version.&lt;/p&gt;
&lt;p&gt;The approach has the great benefit of having the docs tightly coupled with the code in terms of development. Before committing code, one updates documentation for that code, then commits/releases both together.&lt;/p&gt;
&lt;p&gt;You&#39;re also not bound to any development framework. You may edit with &lt;em&gt;vim, emacs, gedit, bluefish, eclipse,&lt;/em&gt; ... any tool of your choice. It&#39;s all down to plain old text files.&lt;/p&gt;
&lt;h4&gt;Mid level #2: documentation bundling&lt;/h4&gt;
&lt;p&gt;One thing I started doing with common_schema is to release a doc bundle with the code. So one can download a compressed bundle of all HTML files. That way one is absolutely certain what&#39;s the right documentation for revision &lt;strong&gt;178&lt;/strong&gt;. There&#39;s no effort about it: the docs are already tightly coupled with code versions. Just compress and distribute.&lt;/p&gt;
&lt;h4&gt;Low level: documentation coupled with your code&lt;/h4&gt;
&lt;p&gt;Perl scripts can be written as Perl modules, in which case they are eligible for using the &lt;em&gt;perldoc&lt;/em&gt; convention. You code your documentation within your script itself, as comment. &lt;em&gt;Perldoc&lt;/em&gt; can extract the documentation and present in man-like format. Same happens with Python&#39;s &lt;em&gt;pydoc&lt;/em&gt;. Baron&#39;s &lt;a href=&#34;http://www.xaprb.com/blog/2011/11/07/when-documentation-is-code/&#34; rel=&#34;bookmark&#34;&gt;When documentation is code&lt;/a&gt; illustrates that approach. &lt;a href=&#34;http://www.maatkit.org/&#34;&gt;Maatkit&lt;/a&gt; (now &lt;em&gt;Percona Toolkit&lt;/em&gt;) has been using it for years.&lt;/p&gt;
&lt;p&gt;This method has the advantage of having the documentation ready right within your shell. You don&#39;t need a browser, nor firewall access. The docs are just there for you in the same environment where you&#39;re executing the code.&lt;/p&gt;
&lt;h4&gt;SQL Low level: CALL for help()&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;common_schema&lt;/em&gt; is a different type of project. It is merely a schema. There&#39;s no Perl nor Python. One imports the schema into one&#39;s MySQL server.&lt;/p&gt;
&lt;p&gt;What&#39;s the low-level approach for this type of code?&lt;/p&gt;
&lt;p&gt;For &lt;em&gt;common_schema&lt;/em&gt; I use three levels of documentation: the mid-level, where one can &lt;a href=&#34;http://common-schema.googlecode.com/svn/trunk/common_schema/doc/html/introduction.html&#34;&gt;browse through the versioned docs&lt;/a&gt;, the 2nd mid-level, where one can &lt;a href=&#34;http://code.google.com/p/common-schema/downloads/list&#34;&gt;download bundled documentation&lt;/a&gt;, and then a low-level approach: documentation embedded within the code.&lt;/p&gt;
&lt;p&gt;MySQL&#39;s documentation is also built into the server: see the &lt;strong&gt;help_*&lt;/strong&gt; tables within the &lt;strong&gt;mysql&lt;/strong&gt; schema. The &lt;em&gt;mysql&lt;/em&gt; command line client allows one to access help by supporting the help command, e.g.&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;mysql&amp;gt; help create table;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;The client intercepts this command (this is not server side command) and searches through the &lt;strong&gt;mysql.help_*&lt;/strong&gt; docs.&lt;/p&gt;
&lt;p&gt;With &lt;em&gt;common_schema&lt;/em&gt;, I don&#39;t have control over the client; it&#39;s all on server side. But the code being a schema, what with stored routines and tables, it&#39;s easy enough to set up documentation.&lt;/p&gt;
&lt;p&gt;As of the next version of &lt;em&gt;common_schema&lt;/em&gt;, and following MySQL&#39;s method, &lt;em&gt;common_schema&lt;/em&gt; provides a &lt;strong&gt;help&lt;/strong&gt; table:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;DESC help;
+--------------+-------------+------+-----+---------+-------+
| Field        | Type        | Null | Key | Default | Extra |
+--------------+-------------+------+-----+---------+-------+
| topic        | varchar(32) | NO   | PRI | NULL    |       |
| help_message | text        | NO   |     | NULL    |       |
+--------------+-------------+------+-----+---------+-------+&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;And a &lt;strong&gt;help()&lt;/strong&gt; procedure, so that you can call for &lt;em&gt;help()&lt;/em&gt;. The procedure will look for the best matching document based on your search expression:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;root@mysql-5.1.51&amp;gt; &lt;strong&gt;CALL help(&#39;match&#39;);&lt;/strong&gt;
&lt;strong&gt;+---------------------------------------&lt;/strong&gt;----------------------------------------+
| help                                                                          |
+-------------------------------------------------------------------------------+
|                                                                               |
| NAME                                                                          |
|                                                                               |
| match_grantee(): Match an existing account based on user+host.                |
|                                                                               |
| TYPE                                                                          |
|                                                                               |
| Function                                                                      |
|                                                                               |
| DESCRIPTION                                                                   |
|                                                                               |
| MySQL does not provide with identification of logged in accounts. It only     |
| provides with user + host:port combination within processlist. Alas, these do |
| not directly map to accounts, as MySQL lists the host:port from which the     |
| connection is made, but not the (possibly wildcard) user or host.             |
| This function matches a user+host combination against the known accounts,     |
| using the same matching method as the MySQL server, to detect the account     |
| which MySQL identifies as the one matching. It is similar in essence to       |
| CURRENT_USER(), only it works for all sessions, not just for the current      |
| session.                                                                      |
|                                                                               |
| SYNOPSIS                                                                      |
|                                                                               |
|                                                                               |
|                                                                               |
|        match_grantee(connection_user char(16) CHARSET utf8,                   |
|        connection_host char(70) CHARSET utf8)                                 |
|          RETURNS VARCHAR(100) CHARSET utf8                                    |
|                                                                               |
|                                                                               |
| Input:                                                                        |
|                                                                               |
| * connection_user: user login (e.g. as specified by PROCESSLIST)              |
| * connection_host: login host. May optionally specify port number (e.g.       |
|   webhost:12345), which is discarded by the function. This is to support      |
|   immediate input from as specified by PROCESSLIST.                           |
|                                                                               |
|                                                                               |
| EXAMPLES                                                                      |
|                                                                               |
| Find an account matching the given use+host combination:                      |
|                                                                               |
|                                                                               |
|        mysql&amp;gt; SELECT match_grantee(&#39;apps&#39;, &#39;192.128.0.1:12345&#39;) AS            |
|        grantee;                                                               |
|        +------------+                                                         |
|        | grantee    |                                                         |
|        +------------+                                                         |
|        | &#39;apps&#39;@&#39;%&#39; |                                                         |
|        +------------+                                                         |
|                                                                               |
|                                                                               |
|                                                                               |
| ENVIRONMENT                                                                   |
|                                                                               |
| MySQL 5.1 or newer                                                            |
|                                                                               |
| SEE ALSO                                                                      |
|                                                                               |
| processlist_grantees                                                          |
|                                                                               |
| AUTHOR                                                                        |
|                                                                               |
| Shlomi Noach                                                                  |
|                                                                               |
+-------------------------------------------------------------------------------+&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;I like HTML for documentation. I think it&#39;s a good format, provided you don&#39;t start doing funny things. Perhaps &lt;em&gt;TROFF&lt;/em&gt; is more suitable; certainly more popular on Unix machines. But I already have everything in HTML. So, what do I do?&lt;/p&gt;
&lt;p&gt;My decision was to keep documentation in HTML, and use the handy &lt;em&gt;html2text&lt;/em&gt; tool to do the job. And it does it pretty well! The sample you see above is an automated translation of HTML to plain text.&lt;/p&gt;
&lt;p&gt;I add a few touches of my own: SELECTing long texts is ugly, whether you do it via &#34;&lt;strong&gt;;&lt;/strong&gt;&#34; or &#34;&lt;strong&gt;\G&lt;/strong&gt;&#34;. The &lt;strong&gt;help()&lt;/strong&gt; routine breaks the text by &#39;&lt;strong&gt;\n&lt;/strong&gt;&#39;, returning a multi row result set. The above sample makes for some &lt;strong&gt;60+&lt;/strong&gt; rows, nicely formatted, broken from the original single text appearing in the &lt;strong&gt;help&lt;/strong&gt; table.&lt;/p&gt;
&lt;p&gt;So now you have an internal help method for &lt;em&gt;common_schema&lt;/em&gt;, right where the code is. You don&#39;t have to leave the command line client in order to get help.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://datacharmer.blogspot.com/&#34;&gt;Giuseppe&lt;/a&gt; offered me the idea for this, even while my own thinking about it was in early stages.&lt;/p&gt;
&lt;p&gt;The next version of &lt;em&gt;common_schema&lt;/em&gt; will be available in a few weeks. The code is pretty much ready. I just need to work on, ahem..., the documentation.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Generating Google line charts with SQL, part II</title>
      <link>/blog/mysql/generating-google-line-charts-with-sql-part-ii/</link>
      <pubDate>Thu, 03 Mar 2011 09:38:10 +0000</pubDate>
      
      <guid>/blog/mysql/generating-google-line-charts-with-sql-part-ii/</guid>
      <description>&lt;p&gt;This post continues &lt;a href=&#34;http://code.openark.org/blog/mysql/generating-google-line-charts-with-sql-part-i&#34;&gt;Generating Google line charts with SQL, part I&lt;/a&gt;, in pursue of generating time series based image charts.&lt;/p&gt;
&lt;p&gt;We ended last post with the following chart:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre /&gt;&lt;img class=&#34;alignnone&#34; title=&#34;Sample SQL Google Chart&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&#34; alt=&#34;&#34; width=&#34;400&#34; height=&#34;200&#34; /&gt;
http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL

&lt;/blockquote&gt;
which has a nice curve, and a proper y-legend, but incorrect x-legend and no ticks nor grids.

To date, Google Image Charts do not support time-series charts. We can&#39;t just throw timestamp values and expect the chart to properly position them. We need to work these by hand.

This is not easily done; if our input consists of evenly spread timestamp values, we are in a reasonable position. If not, what do we do?

There are several solutions to this:
&lt;ul&gt;
	&lt;li&gt;We can present whatever points we have on the chart, making sure to position them properly. This makes for an uneven distribution of ticks on the x-axis, and is not pleasant to watch.&lt;/li&gt;
	&lt;li&gt;We can extrapolate values for round hours (or otherwise round timestamp resolutions), and so show evenly spread timestamps. I don&#39;t like this solution one bit, since we&#39;re essentially inventing values here. Extrapolation is nice when you know you have nice curves, but not when you&#39;re doing database monitoring, for example. You must have the precise values.&lt;/li&gt;
	&lt;li&gt;We can do &lt;a href=&#34;http://en.wikipedia.org/wiki/Oversampling&#34;&gt;oversampling&lt;/a&gt;, then group together several measurements within round timestamp resolutions. For example, we can make a measurement every &lt;strong&gt;2&lt;/strong&gt; minutes, yet present only &lt;strong&gt;6&lt;/strong&gt; measurements per hour, each averaging up &lt;strong&gt;10&lt;/strong&gt; round minutes. This is the approach I take with &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
The latest approach goes even beyond that: what if we missed 30 minutes of sampling? Say the server was down. We then need to &#34;invent&#34; the missing timestamps. Note that we invent the timestamps, we do not invent values. We must present the chart with missing values on our invented timestamps.

I may show how to do this in a future post. Meanwhile, let&#39;s simplify and assume our values &lt;em&gt;are&lt;/em&gt; evenly spread.&lt;!--more--&gt;
&lt;h4&gt;Sample data&lt;/h4&gt;
We use &lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2011/03/google_charts.sql_.txt&#34;&gt;google_charts.sql&lt;/a&gt;. Note that the timestamp values provided in Part I of this post is skewed, so make sure to use this file.
&lt;h4&gt;x-axis values&lt;/h4&gt;
We use &lt;strong&gt;chxl&lt;/strong&gt; to present with x-axis values. We may be tempted to just list all values. Would that work?

Sadly, no, for two reasons:
&lt;ol&gt;
	&lt;li&gt;Google is not smart enough; whatever we throw at it, it will try to present. So, if we have &lt;strong&gt;288&lt;/strong&gt; rows, that&#39;s &lt;strong&gt;288&lt;/strong&gt; x-axis values. Not enough room, to be sure! Smarter implementations would automatically hide some values, so as only to present with non-overlapping values.&lt;/li&gt;
	&lt;li&gt;Our URL will turn out to be too long. Remember: &lt;strong&gt;2048&lt;/strong&gt; characters is our maximum limit for GET request!&lt;/li&gt;
&lt;/ol&gt;
Also, we must format our timestamp to be of minimal width. In our example, we have a &lt;strong&gt;24&lt;/strong&gt; hour range. We therefore present timestamps in hh:MM format. So, a naive approach would be to:
&lt;blockquote&gt;
&lt;pre&gt;SELECT
  CONCAT(
    &#39;http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,&#39;,
    ROUND(min_value, 1), &#39;,&#39;,
    ROUND(max_value, 1),
    &#39;&amp;amp;chd=s:&#39;,
    GROUP_CONCAT(
      IF(
        data IS NULL,
        &#39;_&#39;,
        SUBSTRING(
          &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;,
          1+61*(data - min_value)/(max_value - min_value),
          1
        )
      )
      SEPARATOR &#39;&#39;
    ),
   &#39;&amp;amp;chxl=0:|&#39;,
    &lt;strong&gt;GROUP_CONCAT(&lt;/strong&gt;
&lt;strong&gt;      DATE_FORMAT(ts, &#39;%H:%i&#39;)&lt;/strong&gt;
&lt;strong&gt;      SEPARATOR &#39;|&#39;&lt;/strong&gt;
&lt;strong&gt;    )&lt;/strong&gt;
  ) FROM chart_data, chart_data_minmax&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;The resulting URL is just too long.&lt;/p&gt;
&lt;p&gt;Solution? Let&#39;s only consider round hour timestamps! Our next attempt looks like this (we also throw in &lt;strong&gt;chxs&lt;/strong&gt;, to show ticks):&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT
  CONCAT(
    &#39;http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,&#39;,
    ROUND(min_value, 1), &#39;,&#39;,
    ROUND(max_value, 1),
    &#39;&amp;amp;chd=s:&#39;,
    GROUP_CONCAT(
      IF(
        data IS NULL,
        &#39;_&#39;,
        SUBSTRING(
          &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;,
          1+61*(data - min_value)/(max_value - min_value),
          1
        )
      )
      SEPARATOR &#39;&#39;
    ),
   &lt;strong&gt;&#39;&amp;amp;chxs=0,505050,10,0,lt&#39;,&lt;/strong&gt;
&lt;strong&gt;   &#39;&amp;amp;chxl=0:|&#39;,&lt;/strong&gt;
&lt;strong&gt;    GROUP_CONCAT(&lt;/strong&gt;
&lt;strong&gt;      IF(&lt;/strong&gt;
&lt;strong&gt;        MINUTE(ts) = 0,&lt;/strong&gt;
&lt;strong&gt;        DATE_FORMAT(ts, &#39;%H:%i&#39;),&lt;/strong&gt;
&lt;strong&gt;        NULL&lt;/strong&gt;
&lt;strong&gt;      )&lt;/strong&gt;
&lt;strong&gt;      SEPARATOR &#39;|&#39;&lt;/strong&gt;
&lt;strong&gt;    )&lt;/strong&gt;
  ) FROM chart_data, chart_data_minmax
&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;and results with:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre /&gt;&lt;img class=&#34;alignnone&#34; title=&#34;SQL line chart&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chxl=0:|00:00|01:00|02:00|03:00|04:00|05:00|06:00|07:00|08:00|09:00|10:00|11:00|12:00|13:00|14:00|15:00|16:00|17:00|18:00|19:00|20:00|21:00|22:00|23:00&#34; alt=&#34;&#34; width=&#34;400&#34; height=&#34;200&#34; /&gt;
http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chxl=0:|00:00|01:00|02:00|03:00|04:00|05:00|06:00|07:00|08:00|09:00|10:00|11:00|12:00|13:00|14:00|15:00|16:00|17:00|18:00|19:00|20:00|21:00|22:00|23:00
&lt;/blockquote&gt;
Too messy, isn&#39;t it?
&lt;h4&gt;A word about ticks&lt;/h4&gt;
You would think: OK, then, let&#39;s just present every &lt;strong&gt;4&lt;/strong&gt; round hours timestamps. But there&#39;s a catch: a tick will show only when there&#39;s an x-axis value. It&#39;s nice to have a tick for every hour, but we only want to present values every &lt;strong&gt;4&lt;/strong&gt; hours.

Fortunately, we can provide with an unseen value: a space (URL encoded as &#39;&lt;strong&gt;+&lt;/strong&gt;&#39;). So we complicate things up a bit on the &lt;strong&gt;chxl&lt;/strong&gt; to read:
&lt;blockquote&gt;
&lt;pre&gt;SELECT
  CONCAT(
    &#39;http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,&#39;,
    ROUND(min_value, 1), &#39;,&#39;,
    ROUND(max_value, 1),
    &#39;&amp;amp;chd=s:&#39;,
    GROUP_CONCAT(
      IF(
        data IS NULL,
        &#39;_&#39;,
        SUBSTRING(
          &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;,
          1+61*(data - min_value)/(max_value - min_value),
          1
        )
      )
      SEPARATOR &#39;&#39;
    ),
   &#39;&amp;amp;chxs=0,505050,10,0,lt&#39;,
   &#39;&amp;amp;chxl=0:|&#39;,
    &lt;strong&gt;GROUP_CONCAT(&lt;/strong&gt;
&lt;strong&gt;      IF(&lt;/strong&gt;
&lt;strong&gt;        MINUTE(ts) = 0,&lt;/strong&gt;
&lt;strong&gt;        IF(&lt;/strong&gt;
&lt;strong&gt;          HOUR(ts) MOD 4 = 0,&lt;/strong&gt;
&lt;strong&gt;          DATE_FORMAT(ts, &#39;%H:%i&#39;),&lt;/strong&gt;
&lt;strong&gt;          &#39;+&#39;&lt;/strong&gt;
&lt;strong&gt;        ),&lt;/strong&gt;
&lt;strong&gt;        NULL&lt;/strong&gt;
&lt;strong&gt;      )&lt;/strong&gt;
&lt;strong&gt;      SEPARATOR &#39;|&#39;&lt;/strong&gt;
&lt;strong&gt;    )&lt;/strong&gt;
  ) FROM chart_data, chart_data_minmax&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;and get:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre /&gt;&lt;img class=&#34;alignnone&#34; title=&#34;SQL line chart&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chxl=0:|00:00|+|+|+|04:00|+|+|+|08:00|+|+|+|12:00|+|+|+|16:00|+|+|+|20:00|+|+|+&#34; alt=&#34;&#34; width=&#34;400&#34; height=&#34;200&#34; /&gt;
http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chxl=0:|00:00|+|+|+|04:00|+|+|+|08:00|+|+|+|12:00|+|+|+|16:00|+|+|+|20:00|+|+|+

&lt;/blockquote&gt;
&lt;h4&gt;OK, I cheated&lt;/h4&gt;
Who says sample data starts with a round hour? We have that hidden assumption here, since the first tick is necessarily a round hour in our code. Yet our data may start at &lt;strong&gt;12:35&lt;/strong&gt;, for example. Sorry, you&#39;ll have to dig into &lt;a href=&#34;http://code.google.com/p/mycheckpoint/source/browse/trunk/src/mycheckpoint.py&#34;&gt;mycheckpoint&#39;s source code&lt;/a&gt; to see a thorough solution. It&#39;s just too much for this post.
&lt;h4&gt;Grids&lt;/h4&gt;
Let&#39;s wrap this up with grids. Grids work by specifying the step size (in percent of overall height/width) and initial offset (again, in percent).

Wouldn&#39;t it be nicer if grids were automatically attached to ticks? I mean, REALLY! What were those guys thinking? (I know, they&#39;re doing great work. Keep it up!)

Problem is, I have no idea how Google chooses to distribute values on the y-axis. I don&#39;t know where y-axis ticks will be placed. So on y-axis, I just choose to split charts to &lt;strong&gt;4&lt;/strong&gt; even parts, and draw horizontal grids between them. Percent is &lt;strong&gt;25&lt;/strong&gt; (&lt;strong&gt;100/4&lt;/strong&gt;), offset is &lt;strong&gt;0&lt;/strong&gt;.

But I do have control over the x-axis. In our case, I know how many ticks we&#39;ll be having. Plus, I made life easier by assuming we start with a round hour, so no offset is required.

Umm... How many ticks do we have? Easy: the number of round hours. This can be calculated by: &lt;strong&gt;SUM(MINUTE(ts) = 0&lt;/strong&gt;. Actually, we need to take &lt;strong&gt;1&lt;/strong&gt; off.

We now build the &lt;a href=&#34;http://code.google.com/apis/chart/docs/chart_params.html#gcharts_grid_lines&#34;&gt;&lt;strong&gt;chg&lt;/strong&gt;&lt;/a&gt; parameter:
&lt;blockquote&gt;
&lt;pre&gt;SELECT
  CONCAT(
    &#39;http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,&#39;,
    ROUND(min_value, 1), &#39;,&#39;,
    ROUND(max_value, 1),
    &#39;&amp;amp;chd=s:&#39;,
    GROUP_CONCAT(
      IF(
        data IS NULL,
        &#39;_&#39;,
        SUBSTRING(
          &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;,
          1+61*(data - min_value)/(max_value - min_value),
          1
        )
      )
      SEPARATOR &#39;&#39;
    ),
   &#39;&amp;amp;chxs=0,505050,10,0,lt&#39;,
   &#39;&amp;amp;chxl=0:|&#39;,
    GROUP_CONCAT(
      IF(
        MINUTE(ts) = 0,
        IF(
          HOUR(ts) MOD 4 = 0,
          DATE_FORMAT(ts, &#39;%H:%i&#39;),
          &#39;+&#39;
        ),
        NULL
      )
      SEPARATOR &#39;|&#39;
    ),
   &lt;strong&gt;&#39;&amp;amp;chg=&#39;, ROUND(100.0/((SUM(MINUTE(ts) = 0) -1)), 2), &#39;,25,1,2,0,0&#39;&lt;/strong&gt;
  ) FROM chart_data, chart_data_minmax
&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;and get:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre /&gt;&lt;img class=&#34;alignnone&#34; title=&#34;SQL line chart&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chxl=0:|00:00|+|+|+|04:00|+|+|+|08:00|+|+|+|12:00|+|+|+|16:00|+|+|+|20:00|+|+|+&amp;amp;chg=4.35,25,1,2,0,0&#34; alt=&#34;&#34; width=&#34;400&#34; height=&#34;200&#34; /&gt;&lt;br /&gt;
http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chxl=0:|00:00|+|+|+|04:00|+|+|+|08:00|+|+|+|12:00|+|+|+|16:00|+|+|+|20:00|+|+|+&amp;amp;chg=4.35,25,1,2,0,0&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Phew!&lt;/p&gt;
&lt;h4&gt;Conclusion&lt;/h4&gt;
&lt;p&gt;So we haven&#39;t worked on offsets. And, this is a single line chart. What about multiple lines? Legend? The following chart:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre /&gt;&lt;img class=&#34;alignnone&#34; title=&#34;SQL multi line chart&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=370x180&amp;amp;chts=303030,12&amp;amp;chtt=Latest+24+hours:+Nov+9,+05:50++-++Nov+10,+05:50&amp;amp;chf=c,s,ffffff&amp;amp;chdl=com_select_psec|com_insert_psec|com_delete_psec|com_update_psec|com_replace_psec&amp;amp;chdlp=b&amp;amp;chco=ff8c00,4682b4,9acd32,dc143c,9932cc&amp;amp;chd=s:RTOSRORPNSSORROQTNQQMQRPQSOMUMPQOQUNRUQPUPSRQPUPSTRPQPPQQQQPPURPSQKUQPUQPUTPUQRUTRSRRWTRURRUPQUQSWTSUSOUURTRUTSPSRPPRMRRPRROQSNPQNPPSSRMQPQPQNRQV,MMMRQMPMNPOLOLLORLPOLQSLPRNNUNNQOPSNOQMNRNNPNMRMOQNNNOMNNLOPLPNNOOJPMMOOKRTMPONQNNQOLOMLOMLOKPXNMPMOOMKNNMPNMY976eMMRNQOOMKLOMKLKMMNKMOIPRJPMJMNK,EEDEEDEEDEFEEEDEFEEEDEFEEFEDEEEFEEEEEFEEEFEFEEFEEFEDEEEFEEEEEFEEEEEEFFEFFFEEEFFFFEEEFFFEEEEFDEEEEFFEEEEEFEEFFPx0xXFEEDEFEEEDEFEEEDEFEEEDEEDEEDEFF,FFEFFEFEEFFEFEEFFEFFEFGDEFDEFDEFEEGEEFEEFEEFEEFEEFEEEEEFEEFFDFEEFFDFEEFFEFEEFEEFEEFFDFEEFEDFEEFEEFDEFEDFEEFFENGDFEEFEEFEEFEEFFEFEEEFEFEEEFDFEEFGE,AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&amp;amp;chxt=x,y&amp;amp;chxr=1,0,356.830000&amp;amp;chxl=0:|+||08:00||+||12:00||+||16:00||+||20:00||+||00:00||+||04:00||&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chg=4.17,25,1,2,0.69,0&amp;amp;chxp=0,0.69,4.86,9.03,13.20,17.37,21.54,25.71,29.88,34.05,38.22,42.39,46.56,50.73,54.90,59.07,63.24,67.41,71.58,75.75,79.92,84.09,88.26,92.43,96.60&amp;amp;tsstart=2010-11-09+05:50:00&amp;amp;tsstep=600&#34; alt=&#34;&#34; width=&#34;370&#34; height=&#34;180&#34; /&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;is harder to achieve. I&#39;m leaving this up to you!&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Generating Google line charts with SQL, part I</title>
      <link>/blog/mysql/generating-google-line-charts-with-sql-part-i/</link>
      <pubDate>Tue, 01 Feb 2011 10:29:31 +0000</pubDate>
      
      <guid>/blog/mysql/generating-google-line-charts-with-sql-part-i/</guid>
      <description>&lt;p&gt;In this series of posts I wish to show how &lt;a href=&#34;http://code.google.com/apis/chart/image_charts.html&#34;&gt;Google Charts&lt;/a&gt; can be generated via SQL. We discuss the Google Charts limitations which must be challenged, and work towards a simple chart.&lt;/p&gt;
&lt;p&gt;I&#39;m going to present the algorithm I use in &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;, a MySQL monitoring utility, which generates Google charts by raw data using views. An example of such chart follows:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre /&gt;&lt;img class=&#34;alignnone&#34; title=&#34;Sample Google Chart&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=370x180&amp;amp;chts=303030,12&amp;amp;chtt=Latest+24+hours:+Nov+9,+05:50++-++Nov+10,+05:50&amp;amp;chf=c,s,ffffff&amp;amp;chdl=Rentals+rate:+custom_1_psec&amp;amp;chdlp=b&amp;amp;chco=ff8c00&amp;amp;chd=s:GDGKGFLFGMJHRLMPPNULJRPLTOPRUMYPPVRNbQUSUSbSNWUOfSWTObVSUVWSVYVPbTPjfTbRTdXReUWhcTQRQZbTWYVYPaVZXdYYWPTabYUTbW99QLgLNIOIRNNMIKRJEHGFHGJGGFIFDFGDK&amp;amp;chxt=x,y&amp;amp;chxr=1,0,8.720000&amp;amp;chxl=0:|+||08:00||+||12:00||+||16:00||+||20:00||+||00:00||+||04:00||&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chg=4.17,25,1,2,0.69,0&amp;amp;chxp=0,0.69,4.86,9.03,13.20,17.37,21.54,25.71,29.88,34.05,38.22,42.39,46.56,50.73,54.90,59.07,63.24,67.41,71.58,75.75,79.92,84.09,88.26,92.43,96.60&amp;amp;tsstart=2010-11-09+05:50:00&amp;amp;tsstep=600&#34; alt=&#34;&#34; width=&#34;370&#34; height=&#34;180&#34; /&gt;
http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=370x180&amp;amp;chts=303030,12&amp;amp;chtt=Latest+24+hours:+Nov+9,+05:50++-++Nov+10,+05:50&amp;amp;chf=c,s,ffffff&amp;amp;chdl=Rentals+rate:+custom_1_psec&amp;amp;chdlp=b&amp;amp;chco=ff8c00&amp;amp;chd=s:GDGKGFLFGMJHRLMPPNULJRPLTOPRUMYPPVRNbQUSUSbSNWUOfSWTObVSUVWSVYVPbTPjfTbRTdXReUWhcTQRQZbTWYVYPaVZXdYYWPTabYUTbW99QLgLNIOIRNNMIKRJEHGFHGJGGFIFDFGDK&amp;amp;chxt=x,y&amp;amp;chxr=1,0,8.720000&amp;amp;chxl=0:|+||08:00||+||12:00||+||16:00||+||20:00||+||00:00||+||04:00||&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chg=4.17,25,1,2,0.69,0&amp;amp;chxp=0,0.69,4.86,9.03,13.20,17.37,21.54,25.71,29.88,34.05,38.22,42.39,46.56,50.73,54.90,59.07,63.24,67.41,71.58,75.75,79.92,84.09,88.26,92.43,96.60&amp;amp;tsstart=2010-11-09+05:50:00&amp;amp;tsstep=600
&lt;/blockquote&gt;
&lt;em&gt;mycheckpoint&lt;/em&gt; does not actually call on Google to do the chart rendering, but invokes its own JavaScript code to visualize the URL locally.

Here are some downsides for using Google charts:
&lt;ul&gt;
	&lt;li&gt;The URL cannot be as long as you like. 2048 characters is an upper bound you&#39;ll want to keep behind. &lt;em&gt;[Google charts POST method calls are available, which leads to 16K equivalent of URL length -- this is still not too helpful due to the nature of POST calls]&lt;/em&gt;&lt;/li&gt;
	&lt;li&gt;Features are inconsistent. To specify label or tick positions, one must specify exact positions. To specify grid positions, one must supply with step, offset, etc. There are more such inconsistencies.&lt;/li&gt;
	&lt;li&gt;Google charts are not too friendly. Taking the ticks and grids example from above, there really shouldn&#39;t be a reason why grids would not be automatically generated according to ticks definitions. But we are required to specify positions for the ticks as well as for the grids.&lt;/li&gt;
	&lt;li&gt;There is no support for time-series. One must translate time as x-axis values.&lt;/li&gt;
	&lt;li&gt;Perhaps most intimidating to many people: to generate a Google chart, once must send data to Google. Which is the main reason I used local JavaScript rendering.&lt;/li&gt;
&lt;/ul&gt;
Anyway, let&#39;s build a very simple chart. Since I will not cover everything in this post, we make for some relaxed conditions.&lt;!--more--&gt;
&lt;h4&gt;Sample data&lt;/h4&gt;
Consider the chart_data table, below:
&lt;blockquote&gt;
&lt;pre&gt;SELECT * FROM chart_data;
+-----+---------------------+-------------------+
| id  | ts                  | data              |
+-----+---------------------+-------------------+
|   1 | 2011-02-01 09:59:15 |  1.99666833293656 |
|   2 | 2011-02-01 09:59:15 |  7.94677323180245 |
|   3 | 2011-02-01 09:59:15 |  17.7312123996804 |
|   4 | 2011-02-01 09:59:15 |   31.153467384692 |
|   5 | 2011-02-01 09:59:15 |  47.9425538604203 |
|   6 | 2011-02-01 09:59:15 |  67.7570968074042 |
|   7 | 2011-02-01 09:59:15 |  90.1904762132767 |
|   8 | 2011-02-01 09:59:15 |  114.776974543924 |
|   9 | 2011-02-01 09:59:15 |  140.998843732947 |
|  10 | 2011-02-01 09:59:15 |  168.294196961579 |
|  11 | 2011-02-01 09:59:15 |  196.065619213516 |
|  12 | 2011-02-01 09:59:15 |  223.689380632134 |
|  13 | 2011-02-01 09:59:15 |   250.52512820847 |
...&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;Find complete SQL script in &lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2011/02/google_charts.sql_.txt&#34;&gt;google_charts.sql&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In the above table we assume the timestamp values are evenly distributed. This is because of the aforementioned fact that Google Charts do not support time-series. So, if the given timnestamps are not evenly distributed, or maybe some values are skipped, we must manually compensate for that. In &lt;em&gt;mycheckpoint&lt;/em&gt; I do that. In this blog post, we skip it.&lt;/p&gt;
&lt;h4&gt;Axis boundaries&lt;/h4&gt;
&lt;p&gt;By default, Google Charts expect data to lie within the range 0..100. We need to reset the scale to match our minimum/maximum values, and lay out our values within that range.&lt;/p&gt;
&lt;p&gt;We will be using views in this solution, and here is the first view:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;CREATE OR REPLACE VIEW
 chart_data_minmax
AS
 SELECT MIN(data) AS min_value, MAX(data) AS max_value
FROM
 chart_data
;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;In our example we will just settle with the min/max values. In real worlds we may:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Choose &lt;strong&gt;0&lt;/strong&gt; to be the lower value, even if the minimal value is positive&lt;/li&gt;
&lt;li&gt;Choose to round min-max values to a nearest power of &lt;strong&gt;10&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The axis boundaries go under the following parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;chxt=x,y&lt;/strong&gt; (we hard code bottom axis, left axis)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;chxr=1,&lt;em&gt;min&lt;/em&gt;,&lt;em&gt;max&lt;/em&gt;&lt;/strong&gt; (with min, max as computed by the above)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The following query produces these params:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT CONCAT(&#39;&amp;amp;chxt=x,y&amp;amp;chxr=1,&#39;, ROUND(min_value, 1), &#39;,&#39;, ROUND(max_value, 1)) AS minmax FROM chart_data_minmax;
+---------------------------------+
| minmax                          |
+---------------------------------+
| &amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0 |
+---------------------------------+
&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;h3&gt;Data values&lt;/h3&gt;
&lt;p&gt;Next, we have some &lt;strong&gt;244&lt;/strong&gt; rows of data. Data is double. Can we be certain this all fits within &lt;strong&gt;2048&lt;/strong&gt; characters? What if we had more rows?&lt;/p&gt;
&lt;p&gt;Alas, we must make a trade-off. We will sacrifice accuracy in favor of a short URL. We will use &lt;a href=&#34;http://code.google.com/apis/chart/docs/data_formats.html#simple&#34;&gt;simple encoding&lt;/a&gt; for our data. This means just one character per value, encoded &lt;strong&gt;A-Za-z0-9&lt;/strong&gt;. This means just &lt;strong&gt;62&lt;/strong&gt; distinct values.&lt;/p&gt;
&lt;p&gt;So we must translate each data value into the range 0..61, and then into a character. First step is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT (data - min_value)/(max_value - min_value) AS range_01 FROM chart_data, chart_data_minmax;
+---------------------+
| range_01            |
+---------------------+
|   0.469204617275163 |
|   0.469796281944551 |
|   0.470769223945374 |
|   0.472103901937297 |
|   0.473773369865649 |
|   0.475743682188048 |
|   0.477974405550919 |
...
&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;The above translates the data into the 0..1 range. Next is to simply multiply by 61:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT 61*(data - min_value)/(max_value - min_value) AS range_0_61 FROM chart_data, chart_data_minmax;
+-------------------+
| range_0_61        |
+-------------------+
|  28.6214816537849 |
|  28.6575731986176 |
|  28.7169226606678 |
|  28.7983380181751 |
|  28.9001755618046 |
|  29.0203646134709 |
|  29.1564387386061 |
|  29.3055730348683 |
|  29.4646269983728 |
|  29.6301923928522 |
...&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;To translate into a &lt;em&gt;simple format&lt;/em&gt; character we parse a constant string:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT
  SUBSTRING(
    &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;,
    1+61*(data - min_value)/(max_value - min_value),
    1
  ) AS c FROM chart_data, chart_data_minmax;
+------+
| c    |
+------+
| d    |
| d    |
| d    |
| d    |
| d    |
| d    |
| d    |
| d    |
| d    |
| e    |
| e    |
...&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;Oh, and we should handle NULLs, as well, so:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT
  IF(
    data IS NULL,
    &#39;_&#39;,
    SUBSTRING(
      &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;,
      1+61*(data - min_value)/(max_value - min_value),
      1
    )
  ) AS c FROM chart_data, chart_data_minmax;
&lt;/pre&gt;
&lt;pre&gt;+------+
| c    |
+------+
| d    |
| d    |
| d    |
| d    |
| d    |
| d    |
| d    |
| d    |
| d    |
| e    |
| e    |
...&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;And, to present it as a char sequence, we use the &lt;strong&gt;chd&lt;/strong&gt; parameter and call &lt;strong&gt;GROUP_CONCAT&lt;/strong&gt; to the rescue:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT
  CONCAT(&#39;&amp;amp;chd=s:&#39;,
    GROUP_CONCAT(
      IF(
        data IS NULL,
        &#39;_&#39;,
        SUBSTRING(
          &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;,
          1+61*(data - min_value)/(max_value - min_value),
          1
        )
      )
      SEPARATOR &#39;&#39;
    )
  ) AS c FROM chart_data, chart_data_minmax
\G
*************************** 1. row ***************************
c: &amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;h4&gt;Wrap up&lt;/h4&gt;
&lt;p&gt;Combining the above two queries, with some URL necessities, we get:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;SELECT
  CONCAT(
    &#39;http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,&#39;,
    ROUND(min_value, 1), &#39;,&#39;,
    ROUND(max_value, 1),
    &#39;&amp;amp;chd=s:&#39;,
    GROUP_CONCAT(
      IF(
        data IS NULL,
        &#39;_&#39;,
        SUBSTRING(
          &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;,
          1+61*(data - min_value)/(max_value - min_value),
          1
        )
      )
      SEPARATOR &#39;&#39;
    )
  ) FROM chart_data, chart_data_minmax
;
&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;And get:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre /&gt;&lt;img class=&#34;alignnone&#34; title=&#34;Sample SQL Google Chart&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&#34; alt=&#34;&#34; width=&#34;400&#34; height=&#34;200&#34; /&gt;&lt;br /&gt;
http://chart.apis.google.com/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chtt=SQL%20chart&amp;amp;chxt=x,y&amp;amp;chxr=1,-4716.6,5340.0&amp;amp;chd=s:dddddddddeeeeeefffffffffeeeedddcccbbaaZZZYYYXXXXXXXXXYYYZZabbcdeefghhijkkllmmmmmmmmllkkjihgfedcbZYXWVUTSRRQQPPPPQQQRSTUVWXZacdfgijlmnpqrssttuuuttssrqonmkigfdbZXVTSQONMLKJIIIIIIJKLMOPRTVXZbegilnprtvwyz01111110zyxvtrpnkifcaXUSPNLJHFECBBAAABBCEFHJLNQTWZcfilortwy1346789999876420yvspmjfcYVSOL&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The above chart depicts our visualized data. Alas, x-axis ranges are wrong; no ticks nor grids are yet presented.&lt;/p&gt;
&lt;p&gt;Granularity is not the best, either: the different &lt;strong&gt;62&lt;/strong&gt; values are spread across a &lt;strong&gt;200&lt;/strong&gt; pixel high chart, making for a &lt;strong&gt;3&lt;/strong&gt; pixel distinction between two values, evident on the left area of the chart.&lt;/p&gt;
&lt;p&gt;Continues on &lt;a href=&#34;http://code.openark.org/blog/mysql/generating-google-line-charts-with-sql-part-ii&#34;&gt;Generating Google line charts with SQL, part II&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>mycheckpoint (rev 208): aggregation tables, enhanced charting, RPM distribution</title>
      <link>/blog/mysql/mycheckpoint-rev-208-aggregation-tables-enhanced-charting-rpm-distribution/</link>
      <pubDate>Mon, 08 Nov 2010 12:45:45 +0000</pubDate>
      
      <guid>/blog/mysql/mycheckpoint-rev-208-aggregation-tables-enhanced-charting-rpm-distribution/</guid>
      <description>&lt;p&gt;Revision &lt;strong&gt;208&lt;/strong&gt; of &lt;a href=&#34;../../forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;, a MySQL monitoring solution, has  been released. New and updated in this revision:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Aggregation tables&lt;/strong&gt;: aggregated data makes for fast reports on previously slow queries.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Enhanced charting&lt;/strong&gt;: interactive charts now present time stamps dynamically (see &lt;a href=&#34;http://mycheckpoint.googlecode.com/svn/trunk/doc/html/sample/http/mcp_sql00/sv_report_html_brief&#34;&gt;&lt;strong&gt;demo&lt;/strong&gt;&lt;/a&gt;); &#34;Zoom in&#34; charts are available (see &lt;a href=&#34;http://mycheckpoint.googlecode.com/svn/trunk/doc/html/sample/http/mcp_sql00/zoom/questions&#34;&gt;&lt;strong&gt;demo&lt;/strong&gt;&lt;/a&gt;) on &lt;em&gt;mycheckpoint&lt;/em&gt;&#39;s HTTP server.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;RPM distribution&lt;/strong&gt;: a &#34;noarch&#34; RPM &lt;em&gt;mycheckpoint&lt;/em&gt; build is now available.&lt;/li&gt;
&lt;li&gt;Initial work on formalizing test environment&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; celebrates one year of existence!&lt;/p&gt;
&lt;h4&gt;Aggregation tables&lt;/h4&gt;
&lt;p&gt;I really wanted to avoid using these: everything was so more beautiful with one single dataset and dozens of supporting views (OK, the views themselves are hardly &#34;beautiful&#34;).&lt;/p&gt;
&lt;p&gt;However it was impossible (for my level of expertise) to optimize query performance what with all those views on per-hour and per-day aggregation. The GROUP BYs and the JOINs did not make it possible for condition pushdown (i.e. using MERGE algorithm) where desired.&lt;/p&gt;
&lt;p&gt;As result, mycheckpoint now manages aggregation tables: per-hour and per-day. The impact on sample taking is neglect able (making for two additional fast queries), but the impact on reading aggregated data is overwhelming. Generating a HTML full report could take a few minutes to complete. It now returns in no time. This makes charting more attractive, and allows for enhanced charting, such as zooming in on charts, as described following.&lt;/p&gt;
&lt;p&gt;Aggregation tables will automatically be created and retroactively populated upon using revision 208. There&#39;s nothing special to do; be advised that for one single execution of &lt;em&gt;mycheckpoint&lt;/em&gt;, many INSERT queries are going to be executed. Shouldn&#39;t take more than a couple minutes on commodity hardware and a few months of history.&lt;/p&gt;
&lt;p&gt;It is possible to disable aggregation tables, or make for a complete rebuild of tables; by default, though, aggregation is ON.&lt;/p&gt;
&lt;h4&gt;Enhanced charting&lt;/h4&gt;
&lt;p&gt;Two enhancements here:&lt;!--more--&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The interactive line charts already know how to update legend data as mouse hovers over them. Now they also present accurate date &amp;amp; time. This provides with fully informative charts.&lt;/li&gt;
&lt;li&gt;As with other monitoring tools, it is possible to &#34;zoom in&#34; on a chart: zooming in will present any chart in &#34;last 24 hours&#34;, &#34;last 10 days&#34; and &#34;complete history&#34; views, magnified on screen. See &lt;a href=&#34;http://mycheckpoint.googlecode.com/svn/trunk/doc/html/sample/http/mcp_sql00/zoom/questions&#34;&gt;&lt;strong&gt;demo&lt;/strong&gt;&lt;/a&gt; here.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;RPM distribution&lt;/h4&gt;
&lt;p&gt;No excuse for this being so late, I know. But RPM distribution is now &lt;a href=&#34;http://code.google.com/p/mycheckpoint/&#34;&gt;available&lt;/a&gt;. Yeepee!&lt;/p&gt;
&lt;p&gt;This is a &lt;em&gt;noarch&lt;/em&gt; distribution, courtesy of Python&#39;s &lt;a href=&#34;http://docs.python.org/distutils/&#34;&gt;distutils&lt;/a&gt;; you should be able to install the package on any RPM supporting platform. I have only tested in on CentOS; feedback is welcome.&lt;/p&gt;
&lt;h4&gt;Future plans&lt;/h4&gt;
&lt;p&gt;Work is going on. These are the non-scheduled future tasks I see:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Monitoring InnoDB Plugin &amp;amp; XtraDB status.&lt;/li&gt;
&lt;li&gt;A proper &lt;em&gt;man&lt;/em&gt; page.&lt;/li&gt;
&lt;li&gt;Anything else that interests me &amp;amp; the users.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Try it out&lt;/h4&gt;
&lt;p&gt;Try out &lt;em&gt;mycheckpoint&lt;/em&gt;. It’s a different kind of monitoring    solution. Simple monitoring (charting) is immediate. For more  interesting results you will need basic SQL skills, and in return you’ll  get a lot   of power under your hands.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download mycheckpoint &lt;a href=&#34;https://code.google.com/p/mycheckpoint/&#34;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Visit the project’s &lt;a href=&#34;../../forge/mycheckpoint&#34;&gt;homepage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Browse the &lt;a href=&#34;../../forge/mycheckpoint/documentation&#34;&gt;documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Report &lt;a href=&#34;https://code.google.com/p/mycheckpoint/issues/list&#34;&gt;bugs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; is released under the &lt;a href=&#34;http://www.opensource.org/licenses/bsd-license.php&#34;&gt;New BSD  License&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Umm, I&#39;ll repeat this last one: &lt;em&gt;mycheckpoint&lt;/em&gt; is released under the &lt;a href=&#34;http://www.opensource.org/licenses/bsd-license.php&#34;&gt;New BSD  License&lt;/a&gt;. Still, and will continue to be. Thanks for the &lt;a href=&#34;http://code.openark.org/blog/mysql/openark-kit-facebook-online-schema-change-and-thoughts-on-open-source-licenses#comments&#34;&gt;good advice&lt;/a&gt; by Lenz, Domas and others.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>openark-kit, Facebook Online Schema Change, and thoughts on open source licenses</title>
      <link>/blog/mysql/openark-kit-facebook-online-schema-change-and-thoughts-on-open-source-licenses/</link>
      <pubDate>Thu, 16 Sep 2010 08:02:53 +0000</pubDate>
      
      <guid>/blog/mysql/openark-kit-facebook-online-schema-change-and-thoughts-on-open-source-licenses/</guid>
      <description>&lt;p&gt;MySQL@Facebook team have recently published an &lt;a href=&#34;http://www.facebook.com/note.php?note_id=430801045932&#34;&gt;Online Schema Change&lt;/a&gt; code for non blocking ALTER TABLE operations. Thumbs Up!&lt;/p&gt;
&lt;p&gt;The code is derived from &lt;em&gt;oak-online-alter-table&lt;/em&gt;, part of &lt;a href=&#34;http://code.openark.org/forge/openark-kit&#34;&gt;openark-kit&lt;/a&gt;, a toolkit I&#39;m authoring. Looking at the documentation I can see many ideas were incorporated as well. And of course many things are different, a lot of work has been put to it by MySQL@Facebook.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;openark-kit&lt;/em&gt; is currently released under the new BSD license, and, as far as I can tell (I&#39;m not a lawyer), Facebook&#39;s work has followed the license to the letter. It is a strange thing to see your code incorporated into another project. While I knew work has begun on the tool by Facebook, I wasn&#39;t in on it except for a few preliminary email exchanges.&lt;/p&gt;
&lt;h4&gt;And this is the beauty&lt;/h4&gt;
&lt;p&gt;You release code under open source license, and anyone can pick it up and continue working on it. One doesn&#39;t have to ask or even let you know. Eventually one may release back to the community improved code, more tested (not many comments on &lt;em&gt;oak-online-alter-table&lt;/em&gt; in the past &lt;strong&gt;18&lt;/strong&gt; months).&lt;/p&gt;
&lt;p&gt;It is a beauty, that you can freely use one&#39;s patches, and he can then use yours.&lt;/p&gt;
&lt;h4&gt;And here is my concern&lt;/h4&gt;
&lt;p&gt;When I created both &lt;em&gt;openark-kit&lt;/em&gt; and &lt;em&gt;mycheckpoint&lt;/em&gt;, I licensed them under the BSD license. A very permissive license. &lt;em&gt;Let anyone do what they want with it&lt;/em&gt;, I thought. However Facebook&#39;s announcement suddenly hit me: what license would other people use for their derived work?&lt;/p&gt;
&lt;p&gt;The OSC has been release under permissive license back to the community (again, I am not a lawyer). But, someone else could have made it less friendly. Perhaps not release the code at all: just sell it, closed-source, embedded in their product. And I found out that &lt;em&gt;I do not want anyone to do whatever they want with my code&lt;/em&gt;.&lt;/p&gt;
&lt;h4&gt;I want all derived work to &lt;em&gt;remain open&lt;/em&gt;!&lt;/h4&gt;
&lt;p&gt;Which is why in next releases of code I&#39;m authoring the license will change to &lt;em&gt;less permissive&lt;/em&gt; and &lt;em&gt;more open&lt;/em&gt; license, such as GPL or LGPL. (Of course, all code released so far remains under the BSD license).&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>mycheckpoint (rev. 190): HTTP server; interactive charts</title>
      <link>/blog/mysql/mycheckpoint-rev-190-http-server-interactive-charts/</link>
      <pubDate>Tue, 07 Sep 2010 07:53:01 +0000</pubDate>
      
      <guid>/blog/mysql/mycheckpoint-rev-190-http-server-interactive-charts/</guid>
      <description>&lt;p&gt;Revision &lt;strong&gt;190&lt;/strong&gt; of &lt;a href=&#34;../../forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;, a MySQL monitoring solution, has  been released. New and updated in this revision:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HTTP server&lt;/strong&gt;: &lt;em&gt;mycheckpoint&lt;/em&gt; can now act as a web server. Point your browser and start browsing through HTML reports. See mock up &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/09/r190/mcp_sql00/sv_report_html_brief.html&#34;&gt;&lt;strong&gt;demo&lt;/strong&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Interactive charts&lt;/strong&gt;: HTML line charts are now interactive, presenting with accurate data as you move over them. See &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/09/r190/mcp_sql00_samples/sv_report_html_brief.html&#34;&gt;&lt;strong&gt;sample&lt;/strong&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Enhanced auto-deploy&lt;/strong&gt;: now auto-recognizing failed upgrades.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Reduced footprint&lt;/strong&gt;: much code taken out of the views, leading to faster loading times.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Better configuration file use&lt;/strong&gt;: now supporting all command line options in config file.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Remote host monitoring accessibility&lt;/strong&gt;: now supporting complete configurable accessibility details.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Bug fixes&lt;/strong&gt;: thanks to the bug reporters!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; is free, simple, easy to use (now easier with HTTP server) and &lt;strong&gt;useful&lt;/strong&gt;. I encourage you to try it out: even compared with other existing and emerging monitoring tools, I believe you will find it a breeze; it&#39;s low impact and lightness appealing; it&#39;s alerts mechanism assuring; its geeky SQL-based nature with ability to drill down to fine details -- geeky-kind-of-attractive.&lt;/p&gt;
&lt;p&gt;&amp;lt;/encouragement&amp;gt;&lt;/p&gt;
&lt;h4&gt;HTTP server&lt;/h4&gt;
&lt;p&gt;You can now run &lt;em&gt;mycheckpoint&lt;/em&gt; in &lt;em&gt;http&lt;/em&gt; mode:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;bash$ &lt;strong&gt;mycheckpoint http&lt;/strong&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; will listen on port &lt;strong&gt;12306&lt;/strong&gt;, and will present you with easy browsing through the reports of your &lt;em&gt;mycheckpoint&lt;/em&gt; databases.&lt;!--more--&gt;&lt;/p&gt;
&lt;p&gt;The &lt;em&gt;http&lt;/em&gt; server automatically detects those schemata used by mycheckpoint, and utilizes the existing HTML views, integrating them into the greater web framework.&lt;/p&gt;
&lt;p&gt;While in &lt;em&gt;http&lt;/em&gt; mode, mycheckpoint does nothing besides serving web pages. It does not actively exercise monitoring: you must still use the usual cron jobs or other scheduled tasks by which you invoke &lt;em&gt;mycheckpoint&lt;/em&gt; for monitoring.&lt;/p&gt;
&lt;p&gt;The http server is directed at a single MySQL server, as with the following example:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;bash$ &lt;strong&gt;mycheckpoint --host=slave1.localdomain --port=3306 --http-port=12306 http&lt;/strong&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;It is assumed that this server has the monitoring schemata.&lt;/p&gt;
&lt;p&gt;See mock up &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/09/r190/mcp_sql00/sv_report_html_brief.html&#34;&gt;&lt;strong&gt;demo&lt;/strong&gt;&lt;/a&gt;. The demo uses presents with real output from a mycheckpoint HTTP server; I haven&#39;t got the means to put up a live demo.&lt;/p&gt;
&lt;h4&gt;Interactive charts&lt;/h4&gt;
&lt;p&gt;The &lt;em&gt;openark line charts&lt;/em&gt;, used in the HTML reports, are now interactive. As you scroll over, the legend presents you with series values.&lt;/p&gt;
&lt;p&gt;No more &lt;em&gt;&#34;I have this huge spike once every 4 hours, which reduces all other values to something that looks like zero but is actually NOT&#34;&lt;/em&gt;. Hover, and see the real values.&lt;/p&gt;
&lt;p&gt;See &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/09/r190/mcp_sql00_samples/sv_report_html_brief.html&#34;&gt;&lt;strong&gt;sample&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Enhanced auto-deploy&lt;/h4&gt;
&lt;p&gt;The idea with mycheckpoint is that it should know how to self upgrade the schema on version upgrade (much like automatic WordPress upgrades). mycheckpoint does bookkeeping of installed versions within the database, and upgrades by simple comparison.&lt;/p&gt;
&lt;p&gt;It now, following a couple of reported bugs, also recognizes failure of partial, failed upgrades. This adds to the automation of &lt;em&gt;mycheckpoint&lt;/em&gt;&#39;s installation.&lt;/p&gt;
&lt;h4&gt;Reduced footprint&lt;/h4&gt;
&lt;p&gt;Some of &lt;em&gt;mycheckpoint&lt;/em&gt;&#39;s views are complicated, and lead to a large amount of code in view declaration. This leads to increased table definition size (large &lt;strong&gt;.frm&lt;/strong&gt; files). There has been some work to reduce this size where possible. Work is still ongoing, but some 30% has been taken off already. This leads to faster table (view) load time.&lt;/p&gt;
&lt;h4&gt;Better configuration file use&lt;/h4&gt;
&lt;p&gt;Any argument supported on the command line is now also supported in the config style. Much like is handled with MySQL. For example, one can issue:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;mycheckpoint --monitored-host=sql02.mydb.com  --monitored-user=monitor --monitored-password=123456&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;But now also:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;mycheckpoint&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;With the following in &lt;strong&gt;/etc/mycheckpoint.cnf&lt;/strong&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;[mycheckpoint]
monitored_host     = sql02.mydb.com
monitored_user     = monitor
monitored_password = 123456
&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;Rules are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;If an option is specified on command line, it takes precedence over anything else.&lt;/li&gt;
&lt;li&gt;Otherwise, if it&#39;s specified in the configuration file, value is read from file.&lt;/li&gt;
&lt;li&gt;Otherwise use default value is used.&lt;/li&gt;
&lt;li&gt;On command line, option format is&lt;strong&gt; xxx-yyy-zzz&lt;/strong&gt;: words split with dash/minus character.&lt;/li&gt;
&lt;li&gt;On configuration file, option format is &lt;strong&gt;xxx_yyy_zzz&lt;/strong&gt;: words split with underscore. Unlike MySQL configuration format, dashes cannot be used.&lt;/li&gt;
&lt;li&gt;If an option is specified multiple times on configuration file -- well -- I have the answer, but I won&#39;t tell. Just don&#39;t do it. It&#39;s bad for your health.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Future plans&lt;/h4&gt;
&lt;p&gt;Work is going on. These are the non-scheduled future tasks I see:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Monitoring InnoDB Plugin &amp;amp; XtraDB status.&lt;/li&gt;
&lt;li&gt;A proper &lt;em&gt;man&lt;/em&gt; page.&lt;/li&gt;
&lt;li&gt;Anything else that interests me &amp;amp; the users.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Try it out&lt;/h4&gt;
&lt;p&gt;Try out &lt;em&gt;mycheckpoint&lt;/em&gt;. It’s a different kind of monitoring   solution. Simple monitoring (charting) is immediate. For more interesting results you will need basic SQL skills, and in return you’ll get a lot   of power under your hands.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download mycheckpoint &lt;a href=&#34;https://code.google.com/p/mycheckpoint/&#34;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Visit the project’s &lt;a href=&#34;../../forge/mycheckpoint&#34;&gt;homepage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Browse the &lt;a href=&#34;../../forge/mycheckpoint/documentation&#34;&gt;documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Report &lt;a href=&#34;https://code.google.com/p/mycheckpoint/issues/list&#34;&gt;bugs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; is released under the &lt;a href=&#34;http://www.opensource.org/licenses/bsd-license.php&#34;&gt;New BSD  License&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>mycheckpoint (rev. 170): improved custom queries; local charting; page/swap I/O monitoring; improved HTML reports</title>
      <link>/blog/mysql/mycheckpoint-rev-170-improved-custom-queries-local-charting-pageswap-io-monitoring-improved-html-reports/</link>
      <pubDate>Fri, 16 Jul 2010 10:58:40 +0000</pubDate>
      
      <guid>/blog/mysql/mycheckpoint-rev-170-improved-custom-queries-local-charting-pageswap-io-monitoring-improved-html-reports/</guid>
      <description>&lt;p&gt;Revision &lt;strong&gt;170&lt;/strong&gt; of &lt;a href=&#34;../../forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;, a MySQL monitoring solution, has  been released. New and updated in this revision:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Improved custom queries&lt;/strong&gt;: lifting of limitations from previous, introductory revision; better HTML presentation&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Local, inline charting&lt;/strong&gt;: no rendering of Google Charts, unless explicitly requested. All charts are now rendered locally using JavaScript. No data is now sent over the network.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Page/Swap I/O monitoring&lt;/strong&gt;: now monitoring for page ins and outs, swap ins and outs (Linux only).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Improved HTML reports&lt;/strong&gt;: several improvements on presentation (see &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/07/mycheckpoint-report-brief-169.html&#34;&gt;sample&lt;/a&gt;, more follow).&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Improved custom queries&lt;/h4&gt;
&lt;p&gt;Some limitations, introduced in revision &lt;strong&gt;132&lt;/strong&gt;, are now lifted. New features are introduced.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There is now no limit to the number of custom queries (well, an INT limit).&lt;/li&gt;
&lt;li&gt;In fact, the data tables adjust themselves to the existing custom queries in the form of auto-deploy: once a new &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/custom-monitoring&#34;&gt;custom query is added&lt;/a&gt; or an old one removed, mycheckpoint will add or remove the relevant columns from the data tables.&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;chart_order&lt;/strong&gt; column is now utilized: HTML reports which include custom query charts now order those charts according to &lt;strong&gt;chart_order&lt;/strong&gt; values. This makes for nicer reports.&lt;/li&gt;
&lt;li&gt;The standard &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/07/mycheckpoint-report-brief-169.html&#34;&gt;HTML brief report&lt;/a&gt; (&lt;strong&gt;SELECT html FROM sv_report_html_brief&lt;/strong&gt;) now automatically includes all custom charts. The HTML brief report is the report one usually wants to look at: it provides with the latest 24 hours metrics for selected values. It now becomes a centralized place for all that is interesting in the past 24 hours.&lt;/li&gt;
&lt;li&gt;Custom queries are now allowed to return &lt;strong&gt;NULL&lt;/strong&gt;, treated as a missing value. This is a bugfix from previous revisions.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Local charting&lt;/h4&gt;
&lt;p&gt;Motivation for local charting is clear: no one likes having their data being sent over the network. And no one likes Google to know about their DML values.&lt;/p&gt;
&lt;p&gt;I&#39;ve been playing around with quite a few charting solutions, and have gone into depths with two of them, adding and rewriting quite a lot of code. Eventually, I settled on my very own rendering. Here&#39;s what I&#39;ve seen &amp;amp; tested:&lt;!--more--&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://danvk.org/dygraphs/&#34;&gt;dygraphs&lt;/a&gt;: a very nice time series charting library. I&#39;ve presented a use case on &lt;a href=&#34;http://code.openark.org/blog/mysql/static-charts-vs-interactive-charts&#34;&gt;a previous post&lt;/a&gt;.
&lt;ul&gt;
&lt;li&gt;Pros: slick, easy to work with.&lt;/li&gt;
&lt;li&gt;Cons: uses HTML Canvas for rendering. This is fine on Firefox, Chrome, Safari, you name it. This isn&#39;t fine on IE, which does not support Canvas. There&#39;s &lt;a href=&#34;http://excanvas.sourceforge.net/&#34;&gt;ExplorerCanvas&lt;/a&gt;, a hack tool which converts canvas to IE&#39;s VML, but it is far from being satisfactory: it is &lt;em&gt;sloooow&lt;/em&gt;. Very, very slow. It is slow with one chart; but loading of 21 charts, as I do in some of &lt;em&gt;mycheckpoint&lt;/em&gt;&#39;s reports can take &lt;em&gt;long minutes&lt;/em&gt; on Internet explorer.&lt;/li&gt;
&lt;li&gt;Cons: Only provides with a time series chart. No scatter plots.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Because they&#39;re using ExplorerCanvas for IE, &lt;a href=&#34;http://code.google.com/p/flot/&#34;&gt;flot&lt;/a&gt;, &lt;a href=&#34;http://www.jqplot.com/&#34;&gt;jqPlot&lt;/a&gt; etc., are all unacceptable.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://g.raphaeljs.com/&#34;&gt;gRaphael&lt;/a&gt;: very slick charts based on Raphael. The original line charts are very basic, and I have invested a lot of time rewriting a great deal (you can find it all &lt;a href=&#34;http://code.google.com/p/mycheckpoint/source/browse/#svn/trunk/graphael&#34;&gt;here&lt;/a&gt;). Raphael uses VML on IE, and SVG for all other browsers.
&lt;ul&gt;
&lt;li&gt;Pros: very slick. Supports various chart types, including line (though not time-series) and scatter.&lt;/li&gt;
&lt;li&gt;Cons: &lt;em&gt;slooooooooow&lt;/em&gt; when instantiating multiple charts. Unbearably slow, both on Firefox and IE. Slow as in minutes of waiting.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In addition, all of the above solutions were quite heavyweight: at about 45KB to start with, then add ExplorerCanvas or jQuery, or Raphael as supporting libraries, these became a real burden.&lt;/p&gt;
&lt;p&gt;So, I had some time to spare (business is fine, thank you. I was a bit Ill. I&#39;m feeling well now, thank you), and was upset what with all the time I invested in the above coding. And I decided to invest even more time, and build &lt;em&gt;my own&lt;/em&gt; charts.&lt;/p&gt;
&lt;p&gt;Enter &lt;em&gt;openark-charts&lt;/em&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;&lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2010/07/mycheckpoint-report-html-screenshot.png&#34; /&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img class=&#34;alignnone size-full wp-image-2662&#34; title=&#34;mycheckpoint-report-html-screenshot&#34; src=&#34;/blog/blog/assets/mycheckpoint-report-html-screenshot.png&#34; alt=&#34;&#34; width=&#34;808&#34; height=&#34;307&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2010/07/mycheckpoint-24-7-report-html-screenshot.png&#34;&gt;&lt;img class=&#34;alignnone size-full wp-image-2663&#34; title=&#34;mycheckpoint-24-7-report-html-screenshot&#34; src=&#34;/blog/blog/assets/mycheckpoint-24-7-report-html-screenshot.png&#34; alt=&#34;&#34; width=&#34;808&#34; height=&#34;267&#34; /&gt;&lt;/a&gt;
&lt;/blockquote&gt;
&lt;p&gt;Currently, these line charts and scatter charts know how to parse a Google Image chart URL (only some features supported -- only those I&#39;m actually using with &lt;em&gt;mycheckpoint&lt;/em&gt;). These are not full blown solutions: they come to serve mycheckpoint. And they do so nicely, if I may say so. Using Canvas for most browsers, or VML for IE, these very small pieces of code (10K for line chart, 6K for scatter chart, minified) load fast, use very little memory, and do their work well.&lt;/p&gt;
&lt;p&gt;Granted, neither provides with interactive features: this is planned for the future.&lt;/p&gt;
&lt;h4&gt;Page/swap I/O monitoring&lt;/h4&gt;
&lt;p&gt;(Linux only) &lt;em&gt;mycheckpoint&lt;/em&gt; now reads &lt;strong&gt;/proc/vmstat&lt;/strong&gt; to get the &lt;em&gt;pageins&lt;/em&gt;, &lt;em&gt;pageouts&lt;/em&gt;, &lt;em&gt;swapins&lt;/em&gt; and &lt;em&gt;swapouts&lt;/em&gt; (since last reboot). I was actually looking at completely different places on the &lt;strong&gt;/proc&lt;/strong&gt; file system to get swap info, and was frustrated with the complexity involved, till I bumped on &lt;strong&gt;/proc/vmstat&lt;/strong&gt;... New tricks every day!&lt;/p&gt;
&lt;h4&gt;Improved HTML reports&lt;/h4&gt;
&lt;p&gt;This is mostly HTML make-up. Some minimal design, some more details thrown into the HTML pages (name of DB, MySQL version, &lt;em&gt;mycheckpoint&lt;/em&gt; version). A little more verbosity; all sorts of stuff which was neglected so far.&lt;/p&gt;
&lt;p&gt;Here are some &lt;span style=&#34;text-decoration: line-through;&#34;&gt;&lt;strong&gt;show off&lt;/strong&gt;&lt;/span&gt; examples of the new HTML views: &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/07/mycheckpoint-report-full-169.html&#34;&gt;[full report]&lt;/a&gt;, &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/07/mycheckpoint-report-brief-169.html&#34;&gt;[brief report]&lt;/a&gt;, &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/07/mycheckpoint-report-24-7-169.html&#34;&gt;[24/7 report]&lt;/a&gt;, &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/07/mycheckpoint-report-custom-full-169.html&#34;&gt;[custom full report]&lt;/a&gt;, &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/07/mycheckpoint-report-custom-brief-169.html&#34;&gt;[custom brief report]&lt;/a&gt;, &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/07/mycheckpoint-alert-pending-169.html&#34;&gt;[alert pending report]&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;All HTML views now utilize the new &lt;em&gt;openark-charts&lt;/em&gt;, and none renders charts with Google charts. This means when you &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/generating-html-reports&#34;&gt;use your HTML view&lt;/a&gt;, your data is safe. No data is sent over the net. All charts are rendered using Javascript, which is loaded and executed locally.&lt;/p&gt;
&lt;p&gt;But if you like, there&#39;s a [url] link next to each chart, which leads to a (online) Google chart image. Why? Because neither HTML Canvas nor VML allow for a complete rendering of the charts to an image. So this is a way for one to retrieve &amp;amp; store a chart&#39;s image. Don&#39;t use it if you see no reason for it; it&#39;s just there.&lt;/p&gt;
&lt;p&gt;And I even threw in rounded corners (IE users: only as of Windows 7).&lt;/p&gt;
&lt;h4&gt;Future plans&lt;/h4&gt;
&lt;p&gt;Work is going on. These are the non-scheduled future tasks I see:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Monitoring InnoDB Plugin &amp;amp; XtraDB status.&lt;/li&gt;
&lt;li&gt;Interactive charts. See my &lt;a href=&#34;../mysql/static-charts-vs-interactive-charts&#34;&gt;earlier  post&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;A proper &lt;em&gt;man&lt;/em&gt; page.&lt;/li&gt;
&lt;li&gt;Anything else that interests me.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Try it out&lt;/h4&gt;
&lt;p&gt;Try out &lt;em&gt;mycheckpoint&lt;/em&gt;. It’s a different kind of monitoring  solution. You will need basic SQL skills, and in return you’ll get a lot  of power under your hands.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download mycheckpoint &lt;a href=&#34;https://code.google.com/p/mycheckpoint/&#34;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Visit the project’s &lt;a href=&#34;../../forge/mycheckpoint&#34;&gt;homepage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Browse the &lt;a href=&#34;../../forge/mycheckpoint/documentation&#34;&gt;documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Report &lt;a href=&#34;https://code.google.com/p/mycheckpoint/issues/list&#34;&gt;bugs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; is released under the &lt;a href=&#34;http://www.opensource.org/licenses/bsd-license.php&#34;&gt;New BSD  License&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>mycheckpoint (rev. 132): custom monitoring, custom charts, process list dump</title>
      <link>/blog/mysql/mycheckpoint-rev-132-custom-monitoring-custom-charts-process-list-dump/</link>
      <pubDate>Fri, 04 Jun 2010 11:17:27 +0000</pubDate>
      
      <guid>/blog/mysql/mycheckpoint-rev-132-custom-monitoring-custom-charts-process-list-dump/</guid>
      <description>&lt;p&gt;Revision &lt;strong&gt;132&lt;/strong&gt; of &lt;a href=&#34;../../forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt; has been released. New and updated in this revision:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Custom monitoring: monitoring &amp;amp; charting for user defined queries&lt;/li&gt;
&lt;li&gt;HTML reports for custom monitoring&lt;/li&gt;
&lt;li&gt;Process list dump upon alert notifications&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Custom monitoring &amp;amp; charts&lt;/h4&gt;
&lt;p&gt;Custom monitoring allows the user to supply with a query, the results of which will be monitored.&lt;/p&gt;
&lt;p&gt;That is, &lt;em&gt;mycheckpoint&lt;/em&gt; monitors the status variables, replication status, OS metrics. But it cannot by itself monitor one&#39;s &lt;em&gt;application&lt;/em&gt;. Which is why a user may supply with such query as:&lt;/p&gt;
&lt;blockquote&gt;&lt;pre&gt;
SELECT COUNT(*) FROM shopping_cart WHERE is_pending=1
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;Such a query will tell an online store how many customers are in the midst of shopping. There is no argument that this number is worth monitoring for. Given the above query, &lt;em&gt;mycheckpoint&lt;/em&gt; will execute it per sample, and store the query&#39;s result along with all sampled data, to be then aggregated by complex views to answer for:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;What was the value per given sample?&lt;/li&gt;
&lt;li&gt;What is the value difference for each sample?&lt;/li&gt;
&lt;li&gt;What is the change per second, i.e. the rate?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;mycheckpoint goes one step forward, and explicity records another metric:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How much time did it take to take that sample?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;!--more--&gt;As another example, a query worth testing for rate:&lt;/p&gt;
&lt;blockquote&gt;&lt;pre&gt;
SELECT MAX(shopping_cart_id) FROM shopping_cart
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;The above will provide with the last id. Assuming this is &lt;strong&gt;AUTO_INCREMENT&lt;/strong&gt;, and assuming we&#39;re on &lt;strong&gt;auto_increment_increment=1&lt;/strong&gt;, two samples will allow us to get the number of created carts between those samples. Now, here&#39;s a metric I&#39;d like to read:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How many carts are created per second, for each hour of the day?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We get all these for free with mycheckpoint, which already does this analysis. All we need to provide is the query, and how we would like it to be visualized (visualization is optional, it is not the only way to diagnose monitored data) graphically:&lt;/p&gt;
&lt;blockquote&gt;&lt;pre&gt;
INSERT INTO
 custom_query (custom_query_id, enabled, query_eval, description, chart_type, chart_order)
 VALUES (0, 1, &#39;SELECT COUNT(*) FROM store.shopping_cart WHERE is_pending=1&#39;, &#39;Number of pending carts&#39;, &#39;value&#39;, 0);
INSERT INTO
 custom_query (custom_query_id, enabled, query_eval, description, chart_type, chart_order)
 VALUES (1, 1, &#39;SELECT MAX(shopping_cart_id) FROM store.shopping_cart&#39;, &#39;Created carts rate&#39;, &#39;value_psec&#39;, 0);
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;We can later query for these values, just like we do for normal monitored values:&lt;/p&gt;
&lt;blockquote&gt;&lt;pre&gt;
mysql&amp;gt; SELECT id, ts, created_tmp_tables_psec, custom_0, custom_1_psec FROM sv_sample WHERE ts &amp;gt;= NOW() - INTERVAL 1 HOUR;
+-------+---------------------+-------------------------+----------+---------------+
| id    | ts                  | created_tmp_tables_psec | custom_0 | custom_1_psec |
+-------+---------------------+-------------------------+----------+---------------+
| 50730 | 2010-05-21 19:05:01 |                   16.64 |      448 |          3.02 |
| 50731 | 2010-05-21 19:10:02 |                   20.97 |       89 |          1.73 |
| 50732 | 2010-05-21 19:15:01 |                   15.70 |      367 |          3.56 |
| 50733 | 2010-05-21 19:20:01 |                   18.32 |       54 |          1.43 |
| 50734 | 2010-05-21 19:25:01 |                   16.42 |       91 |          1.96 |
| 50735 | 2010-05-21 19:30:02 |                   21.93 |      233 |          2.11 |
| 50736 | 2010-05-21 19:35:02 |                   14.58 |      176 |          1.91 |
| 50737 | 2010-05-21 19:40:01 |                   21.61 |      168 |          1.93 |
| 50738 | 2010-05-21 19:45:01 |                   16.05 |      241 |          2.44 |
| 50739 | 2010-05-21 19:50:01 |                   19.70 |       46 |          1.19 |
| 50740 | 2010-05-21 19:55:01 |                   15.85 |      177 |          2.28 |
| 50741 | 2010-05-21 20:00:01 |                   19.04 |        8 |          0.82 |
+-------+---------------------+-------------------------+----------+---------------+
&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;Of course, it is also possible to harness &lt;em&gt;mycheckpoint&lt;/em&gt;&#39;s views power to generate charts:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;mysql&amp;gt; SELECT custom_1_psec FROM sv_report_chart_sample\G
&lt;/pre&gt;
&lt;img class=&#34;alignnone&#34; title=&#34;custom_1_psec&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chts=303030,12&amp;amp;chtt=Latest+24+hours:+May+19,+20:10++-++May+20,+20:10&amp;amp;chf=c,s,ffffff&amp;amp;chdl=custom_1_psec&amp;amp;chdlp=b&amp;amp;chco=ff8c00&amp;amp;chd=s:QfXQmZQhXTmWVkWRobPpWUtQPVROaOOUMJPOKdJHQJFJEDJJEGCAIEFJHFFEGGDQHGJGMJPPMNZNRWR_ZUWfR_nSjuUcaXa3OgxRl4UivWZ5UhtWX4VgnUTYktiVW9WanUVxVYlgXwVdicXpb&amp;amp;chxt=x,y&amp;amp;chxr=1,0,5.120000&amp;amp;chxl=0:||+||00:00||+||04:00||+||08:00||+||12:00||+||16:00||+||20:00|&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chg=4.17,25,1,2,3.47,0&amp;amp;chxp=0,3.47,7.64,11.81,15.98,20.15,24.32,28.49,32.66,36.83,41.00,45.17,49.34,53.51,57.68,61.85,66.02,70.19,74.36,78.53,82.70,86.87,91.04,95.21,99.38&#34; alt=&#34;&#34; width=&#34;400&#34; height=&#34;200&#34; /&gt;
&lt;/blockquote&gt;
The rules are:
&lt;ul&gt;
&lt;li&gt;There can (currently) only be 18 custom queries.&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;custom_query_id&lt;/strong&gt; must range 0-17 (to be lifted soon).&lt;/li&gt;
&lt;li&gt;A custom query must return with &lt;em&gt;exactly&lt;/em&gt; one row, with &lt;em&gt;exactly&lt;/em&gt; one column, which is a kind of &lt;em&gt;integer&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
Please read &lt;a href=&#34;http://code.openark.org/blog/mysql/things-to-monitor-on-mysql-the-users-perspective&#34;&gt;my earlier post&lt;/a&gt; on custom monitoring to get more background.
&lt;h4&gt;Custom monitoring HTML reports&lt;/h4&gt;
Custom monitoring comes with a HTML reports, featuring requested charts. See a &lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2010/05/mcp_custom_report-128.html&#34;&gt;sample custom report&lt;/a&gt;.
In this sample report, a few queries are monitored for value (pending rentals, pending downloads) and a few for rates (downloads per second, emails per second etc.).
Custom HTML reports come in two flavors:
&lt;ul&gt;
&lt;li&gt;Brief reports, featuring last 24 hours, as in the example above. These are handled by the &lt;strong&gt;sv_custom_html_brief&lt;/strong&gt; view.&lt;/li&gt;
&lt;li&gt;Full reports, featuring last 24 hours, last 10 days, known history. These take longer to generate, and are handled by the &lt;strong&gt;sv_custom_html&lt;/strong&gt; view.&lt;/li&gt;
&lt;/ul&gt;
The sample report was generated by issuing:
&lt;blockquote&gt;
&lt;pre&gt;SELECT html FROM sv_custom_html_brief;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;I won&#39;t go into details here as for how this view generates the HTML code. There is a myriad of view dependencies, with many interesting tricks on the way. But do remember it&#39;s &lt;em&gt;just a view&lt;/em&gt;. You don&#39;t need an application (not even &lt;em&gt;mycheckpoint&lt;/em&gt; itself) to generate the report. All it takes is a query.&lt;/p&gt;
&lt;h4&gt;Processlist dump&lt;/h4&gt;
&lt;p&gt;When an alert notification fires (an email is prepared to inform on some alert condition), a processlist dump summary is taken and included in email report. It may be useful to understand why the slave is lagging, or exactly why there are so many active threads.&lt;/p&gt;
&lt;p&gt;The dump summary presents the processlist much as you would see it on SHOW PROCESSLIST, but only lists the active threads, noting down how many sleeping processes there are (PS, thread &amp;amp; process are the same in the terminology of MySQL connections). An example dump looks like this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;PROCESSLIST summary:

     Id: 3
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 3168098
  State: Waiting for master to send event
   Info: NULL
-------

     Id: 4
   User: system user
   Host:
     db: prod_db
Command: Connect
   Time: 612
  State: Updating
   Info: UPDATE user SET is_offline = 1 WHERE id IN (50440010,50440011)
-------

     Id: 8916579
   User: prod_user
   Host: localhost
     db: prod_db
Command: Query
   Time: 1
  State: Sending data
   Info: INSERT IGNORE INTO archive.stat_archive (id, origin, path, ts, content
-------

     Id: 8916629
   User: mycheckpoint
   Host: localhost
     db: NULL
Command: Query
   Time: 0
  State: NULL
   Info: SHOW PROCESSLIST
-------
Sleeping: 3 processes
&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;h4&gt;Future plans&lt;/h4&gt;
&lt;p&gt;Work is going on. These are the non-scheduled future tasks I see:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Monitoring InnoDB Plugin &amp;amp; XtraDB status.&lt;/li&gt;
&lt;li&gt;Interactive charts. See my &lt;a href=&#34;http://code.openark.org/blog/mysql/static-charts-vs-interactive-charts&#34;&gt;earlier post&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Monitoring for swap activity (Linux only).&lt;/li&gt;
&lt;li&gt;Enhanced custom queries handling, including auto-deploy upon change of custom queries.&lt;/li&gt;
&lt;li&gt;A proper &lt;em&gt;man&lt;/em&gt; page.&lt;/li&gt;
&lt;li&gt;Anything else that interests me.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Try it out&lt;/h4&gt;
&lt;p&gt;Try out &lt;em&gt;mycheckpoint&lt;/em&gt;. It’s a different kind of monitoring solution. You will need basic SQL skills, and in return you&#39;ll get a lot of power under your hands.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download mycheckpoint &lt;a href=&#34;https://code.google.com/p/mycheckpoint/&#34;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Visit the project’s &lt;a href=&#34;../../forge/mycheckpoint&#34;&gt;homepage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Browse the &lt;a href=&#34;../../forge/mycheckpoint/documentation&#34;&gt;documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Report &lt;a href=&#34;https://code.google.com/p/mycheckpoint/issues/list&#34;&gt;bugs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; is released under the &lt;a href=&#34;http://www.opensource.org/licenses/bsd-license.php&#34;&gt;New BSD License&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>mycheckpoint (Rev. 118): alerts, email notifications and more</title>
      <link>/blog/mysql/mycheckpoint-rev-118-alerts-email-notifications-and-more/</link>
      <pubDate>Thu, 25 Mar 2010 08:26:34 +0000</pubDate>
      
      <guid>/blog/mysql/mycheckpoint-rev-118-alerts-email-notifications-and-more/</guid>
      <description>&lt;p&gt;Revision &lt;strong&gt;118&lt;/strong&gt; of &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt; has been released. New and updated in this revision:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Conditional alerts&lt;/li&gt;
&lt;li&gt;Email notifications&lt;/li&gt;
&lt;li&gt;Revised HTML reports, including 24/7 reports.&lt;/li&gt;
&lt;li&gt;Updated documentation&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;With this new revision mycheckpoint turns into a &lt;em&gt;monitoring solution&lt;/em&gt; for MySQL. One can now:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Store measure metrics&lt;/li&gt;
&lt;li&gt;Query for raw, aggregated or digested metrics&lt;/li&gt;
&lt;li&gt;Generate charts for selected metrics&lt;/li&gt;
&lt;li&gt;View HTML reports for selecetd metrics&lt;/li&gt;
&lt;li&gt;Define alerts conditions, query for pending alerts&lt;/li&gt;
&lt;li&gt;Be notified via &lt;em&gt;email&lt;/em&gt; on &lt;em&gt;raised&lt;/em&gt; or &lt;em&gt;resolved&lt;/em&gt; alerts.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Conditional alerts&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; is &lt;em&gt;SQL oriented&lt;/em&gt;. As such, it allows for creation of alert conditions, which are nothing more than SQL conditions.&lt;/p&gt;
&lt;p&gt;&lt;!--more--&gt;For example, we wish to raise an alerts when the slave stops replicating (just ping us with an email one this happens):&lt;/p&gt;
&lt;blockquote&gt;&lt;pre&gt;INSERT INTO alert_condition (condition_eval, description, alert_delay_minutes)
  VALUES (&#39;seconds_behind_master IS NULL&#39;, &#39;Slave not replicating&#39;, 0);&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;Or is too far behind (but since we do maintenance work during the night, it&#39;s OK on those hours). We only want to be notified if this goes on for &lt;strong&gt;10&lt;/strong&gt; minutes:&lt;/p&gt;
&lt;blockquote&gt;&lt;pre&gt;INSERT INTO alert_condition (condition_eval, description, alert_delay_minutes)
  VALUES (&#39;(seconds_behind_master &amp;gt; 60) AND (HOUR(ts) NOT BETWEEN 2 AND 4)&#39;, &#39;Slave lags too far behind&#39;, 10);&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;We want to be notified when the &lt;strong&gt;datadir&lt;/strong&gt; mount point disk quota exceeds 95% usage. Oh, and please keep nagging us about this, as long as it is unresolved:&lt;/p&gt;
&lt;blockquote&gt;&lt;pre&gt;INSERT INTO alert_condition (condition_eval, description, repetitive_alert)
  VALUES (&#39;os_datadir_mountpoint_usage_percent &amp;gt; 95&#39;, &#39;datadir mount point is over 95%&#39;, 1);&lt;/pre&gt;&lt;/blockquote&gt;
&lt;p&gt;There&#39;s much more to alert conditions. You can generate a pending alerts report, get a textual presentation of raised and pending alerts, view the query which determines what alerts are currently raised, and more.&lt;/p&gt;
&lt;p&gt;Read more on the &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/alerts&#34;&gt;alerts documentation page&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Email notifications&lt;/h4&gt;
&lt;p&gt;Introducing email notifications, &lt;em&gt;mycheckpoint&lt;/em&gt; now:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sends email notification on alert conditions meeting. See &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/03/mycheckpoint-alerts-email-sample-113.jpeg&#34;&gt;sample email screenshot&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Sends email notification when it is unable to access the database.&lt;/li&gt;
&lt;li&gt;Sends report via mail. Currently only HTML brief report is supported. Report is attached as HTML file in email message.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Alert notifications are automatically sent by mail (once SMTP configuration is in place, see following) when an alert is &lt;em&gt;raised&lt;/em&gt; (alert condition becomes &lt;strong&gt;true&lt;/strong&gt;) or &lt;em&gt;resolved&lt;/em&gt; (alert condition turns &lt;strong&gt;false&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;Email notifications require simple configuration for SMTP host, SMTP-from-address, SMTP-to-address. These can be made in the &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/usage#defaults_file&#34;&gt;defaults file&lt;/a&gt; (revised), or through the command line. The following example shows how one can manually send an HTML brief report:&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre&gt;mycheckpoint --defaults-file=/etc/mycheckpoint.cnf &lt;strong&gt;--smtp-from&lt;/strong&gt;=monitor@my-server-company.com &lt;strong&gt;--smtp-to&lt;/strong&gt;=dba@my-server-company.com &lt;strong&gt;--smtp-host&lt;/strong&gt;=mail.my-server-company.com &lt;strong&gt;email_brief_report&lt;/strong&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;One should generally set up these parameters in the configuration file (aka &lt;em&gt;defaults file&lt;/em&gt;) and forget all about it. mycheckpoint now has a default for the defaults file, which is &lt;strong&gt;/etc/mycheckpoint.cnf&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Read more on the &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/emails&#34;&gt;emails documentation page&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Revised HTML reports&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;The brief HTML reports has been updated, see &lt;a href=&#34;http://code.openark.org/forge/wp-content/uploads/2010/03/mycheckpoint-brief-report-sample-113.html&#34;&gt;sample&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;An HTML 24/7 report as been added, see &lt;a href=&#34;../../forge/wp-content/uploads/2010/03/mycheckpoint-24-7-report-sample-107.html&#34;&gt;sample&lt;/a&gt;. This report shows the distribution of popular metrics throughout the weekdays and hours.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Full HTML reports remain slow to load. I&#39;m putting some work into this, but I&#39;m not sure I can work around the optimizer&#39;s limitations of using indexes for GROUPing through views.&lt;/p&gt;
&lt;h4&gt;Updated documentation&lt;/h4&gt;
&lt;p&gt;The documentation has been revised, with more details put into the pages. Since &lt;em&gt;mycheckpoint&lt;/em&gt; gains more and more features, I saw fit to write a &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/quick-howto&#34;&gt;Quick HOWTO&lt;/a&gt; page which gets you up to speed, no fuss around, with &lt;em&gt;mycheckpoint&lt;/em&gt;&#39;s usage and features.&lt;/p&gt;
&lt;p&gt;Read the mycheckpoint &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation/quick-howto&#34;&gt;Quick HOWTO&lt;/a&gt; here.&lt;/p&gt;
&lt;h4&gt;Future plans&lt;/h4&gt;
&lt;p&gt;Work is going on. These are the non-scheduled future tasks I see:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Custom monitoring + notifications. See my &lt;a href=&#34;http://code.openark.org/blog/mysql/things-to-monitor-on-mysql-the-users-perspective&#34;&gt;earlier post&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Monitoring InnoDB Plugin &amp;amp; XtraDB status.&lt;/li&gt;
&lt;li&gt;PROCESSLIST dump on alerts.&lt;/li&gt;
&lt;li&gt;Interactive charts. See my &lt;a href=&#34;http://code.openark.org/blog/mysql/static-charts-vs-interactive-charts&#34;&gt;earlier post&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;A proper &lt;em&gt;man&lt;/em&gt; page...&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Try it out&lt;/h4&gt;
&lt;p&gt;Try out &lt;em&gt;mycheckpoint&lt;/em&gt;. It&#39;s a different kind of monitoring solution. It does not require to to have a web server or complicated dependencies. To the experienced DBA it can further provide with valuable, raw or digested information in the form of SQL accessible data. I have used it to find anomalies in passing months, doing SQL search for periods of time where several conditions applied -- it really gives you some extra power.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download mycheckpoint &lt;a href=&#34;https://code.google.com/p/mycheckpoint/&#34;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Visit the project&#39;s &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;homepage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Browse the &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/documentation&#34;&gt;documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Report &lt;a href=&#34;https://code.google.com/p/mycheckpoint/issues/list&#34;&gt;bugs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; is released under the &lt;a href=&#34;http://www.opensource.org/licenses/bsd-license.php&#34;&gt;New BSD License&lt;/a&gt;.&lt;/p&gt;
&lt;div id=&#34;_mcePaste&#34; style=&#34;overflow: hidden; position: absolute; left: -10000px; top: 855px; width: 1px; height: 1px;&#34;&gt;http://code.openark.org/forge/mycheckpoint/documentation/quick-howto&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>Things to monitor on MySQL, the user&#39;s perspective</title>
      <link>/blog/mysql/things-to-monitor-on-mysql-the-users-perspective/</link>
      <pubDate>Wed, 10 Mar 2010 11:12:24 +0000</pubDate>
      
      <guid>/blog/mysql/things-to-monitor-on-mysql-the-users-perspective/</guid>
      <description>&lt;p&gt;Working on &lt;em&gt;mycheckpoint&lt;/em&gt;, I have the intention of adding custom monitoring. That is, letting the user define things to monitor. I have my own thoughts, I would be grateful to get more input!&lt;/p&gt;
&lt;h4&gt;What would the user want to monitor?&lt;/h4&gt;
&lt;p&gt;Monitoring for the number of SELECT statements per second, InnoDB locks, slave replication lag etc. is very important, and monitoring utilities provide with this information. But what does that tell the end user? Not much.&lt;/p&gt;
&lt;p&gt;The experienced DBA may gain a lot. The user would be more interested in completely other kind of information. In between, some information is relevant to both.&lt;/p&gt;
&lt;p&gt;Say we were managing an on-line store. We want to monitor the health of the database. But the health of the database is inseparable from the health of the application. I mean, having little to no disk usage is fine, unless... something is wrong with the application, which leads to no new purchases.&lt;/p&gt;
&lt;p&gt;And so a user would be interested in monitoring the number of purchases per hour, or the time passed since last successful purchase. This kind of data can only be generated by a user&#39;s specific query. Looking at the charts, the user would then feel safer and confident in the wellness of his store app.&lt;/p&gt;
&lt;p&gt;&lt;!--more--&gt;But let&#39;s dig further. We want the store&#39;s website to provide with good response. In particular, the query which returns the items in a customer&#39;s cart must react quickly. Our user would not only want to see that purchases get along, but also that page load times (as in our example) are quick for those critical parts. And so a user should be able to monitor the &lt;em&gt;time&lt;/em&gt; it took to execute a given query.&lt;/p&gt;
&lt;p&gt;It can be of further interest to know how many times per second a given query is executed. This part is not easily done on the server side, and requires the user&#39;s cooperation (or else we must analyze the general log, sniff, or set up a proxy). If the user is willing, she can log to some table each time she executes a certain query. Then we&#39;re back to monitoring a regular table, as with the first example.&lt;/p&gt;
&lt;p&gt;It is also possible to monitor for a query&#39;s execution plan. Is it full scan? How many rows are expected? But given that we can monitor the time it took to execute a query, I&#39;m not sure this is useful. If everything runs fast enough -- who cares about &lt;em&gt;how&lt;/em&gt; it executes?&lt;/p&gt;
&lt;p&gt;Some of the above can be monitored on an altogether higher level: if  we&#39;re talking about some web application, then we can use our Apache logs to determine load time for pages, or number of requests to our &#34;cart items&#34; page. But not always do we work with web servers, and we may be interested in checking the specific queries behind the scenes.&lt;/p&gt;
&lt;h4&gt;Summary&lt;/h4&gt;
&lt;p&gt;Custom monitoring can include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;User defined queries (number of concurrent visitors; count of successful operations per second; number of rows per given table or condition; ...)&lt;/li&gt;
&lt;li&gt;Execution time for user defined queries (time it takes to return cart items; find rows matching condition; sort a table; ...)&lt;/li&gt;
&lt;li&gt;Number of executions for a given query, per second.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I intend to incorporate the above into &lt;em&gt;mycheckpoint&lt;/em&gt; as part of its standard monitoring scheme.&lt;/p&gt;
&lt;p&gt;Please share your thought below.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Static charts vs. interactive charts</title>
      <link>/blog/mysql/static-charts-vs-interactive-charts/</link>
      <pubDate>Tue, 02 Mar 2010 15:28:08 +0000</pubDate>
      
      <guid>/blog/mysql/static-charts-vs-interactive-charts/</guid>
      <description>&lt;p&gt;I&#39;m having my usual fun with charts. Working on &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt;, I&#39;ve generated monitoring charts using the &lt;a href=&#34;http://code.google.com/apis/chart/image_charts.html&#34;&gt;Google Chars API&lt;/a&gt;. But I&#39;ve also had chance to experiment and deploy interactive charts, JavaScript based. In particular, I used and tweaked &lt;a href=&#34;http://www.danvk.org/dygraphs/&#34;&gt;dygraphs&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I&#39;d like to note some differences in using charts of both kinds. And I think it makes a very big difference.&lt;/p&gt;
&lt;h4&gt;Static charts&lt;/h4&gt;
&lt;p&gt;I&#39;ll call any image-based chart by &#34;static chart&#34;. It&#39;s just a static image. Example of such charts are those generated by Google Image Charts (they now also have new, interactive charts), or &lt;a href=&#34;http://oss.oetiker.ch/rrdtool/index.en.html&#34;&gt;RRDtool&lt;/a&gt;. Show below is an example of a static chart; in this example, generated by Google:&lt;!--more--&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;pre /&gt;&lt;img class=&#34;alignnone&#34; src=&#34;/blog/blog/assets/chart?cht=lc&amp;amp;chs=400x200&amp;amp;chts=808080,12&amp;amp;chtt=Dec+4,+15:00++-++Dec+5,+15:00&amp;amp;chf=c,s,ffffff&amp;amp;chdl=com_select_psec|com_insert_psec|com_delete_psec|com_update_psec|com_replace_psec&amp;amp;chdlp=b&amp;amp;chco=ff8c00,4682b4,9acd32,dc143c,9932cc&amp;amp;chd=s:zpvxszxsxur11p1xt10wyxzuyv6xw4yx3x041x2zz6zvz7y91x23z4niqkkmojllkhknhlgnmimohilkkqgkkmnmhlljinjmnhmo________________imlnpmkukopmnpjsojnrrlrqnpprs,iZagVcgWXaZdjVbgSbhYdXZXZcbcXZbcadabccabbZaaZeabdYbbZXceWUXaXYXSXVXaSSZUUXWYUUXbTYUUVabWWVZZVYaWZZYa________________ZYbVcXWdYWZcXaYaYWXYfZcdaVZaZ,MNNNNNONLKOMPNNMNNOPMNNLMQNOMMMNMNNNNRONNOPMNQMPONPOLMTNKJKMKKJILKILJJJLIIKUMHJJIIHHHKJIIHIIIHJHIIJM________________NOMLMMLOPOPKLKKNPKMMNMOPQNNOL,NIIMHKOIHKIKOHKMGKNJKIJIKMKLJJMKIKJKLLJLLJLLKMLJLJKKKIIVIIJLJKJHJIKLIHMIIKIKIIKLHKIIJLKIJJKKIJKIKKJK________________IIKILJJLKIKKHJJJJIJJMIKLKGJKK,AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA________________AAAAAAAAAAAAAAAAAAAAAAAAAAAAA&amp;amp;chxt=x,y&amp;amp;chxr=1,0,136.620000&amp;amp;chxl=0:||16:00||+||20:00||+||00:00||+||04:00||+||08:00||+||12:00||+||&amp;amp;chxs=0,505050,10,0,lt&amp;amp;chg=4.17,25,1,2,0.00,0&amp;amp;chxp=0,0.00,4.17,8.34,12.51,16.68,20.85,25.02,29.19,33.36,37.53,41.70,45.87,50.04,54.21,58.38,62.55,66.72,70.89,75.06,79.23,83.40,87.57,91.74,95.91,100.08&#34; alt=&#34;&#34; width=&#34;400&#34; height=&#34;200&#34; /&gt;
&lt;/blockquote&gt;
&lt;h4&gt;Pros and cons of static charts&lt;/h4&gt;
Pros
&lt;ul&gt;
	&lt;li&gt;Images can be viewed on any graphical platform. Browsers, email clients, cell phones, whatever.&lt;/li&gt;
	&lt;li&gt;Self contained: chart image, legend, scales: all in one image.&lt;/li&gt;
	&lt;li&gt;As such, easy to move around.&lt;/li&gt;
	&lt;li&gt;Are safe to use.&lt;/li&gt;
&lt;/ul&gt;
Cons
&lt;ul&gt;
	&lt;li&gt;Images are fuzzy. Is the &lt;strong&gt;com_replace_psec&lt;/strong&gt; really 0? Maybe it&#39;s 0.1? A larger value can make lower values hard to tell.&lt;/li&gt;
	&lt;li&gt;Images are inaccurate: the colors can lie. The red and green lines showing are hard to tell apart. The red is painted above the green. Data gets &#34;lost&#34;.&lt;/li&gt;
	&lt;li&gt;They do not zoom (one needs to regenerate larger image)&lt;/li&gt;
	&lt;li&gt;Unless encoded with base64, HTML pages which include images need to link outside.&lt;/li&gt;
	&lt;li&gt;In the particular case of Google Charts, one is limited to 2K length URL. Trust me, it&#39;s a big limitation! (PS, Google now support POST method to allow for up to 16K. But... it&#39;s a POST method...)&lt;/li&gt;
	&lt;li&gt;In the particular case of Google Charts, one must have an internet connection.&lt;/li&gt;
	&lt;li&gt;In the particular case of Google Charts, one must submit data to Google.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Interactive charts&lt;/h4&gt;
Interactive charts are those which react to your commands. These are either JavaScript or Flash based, mostly. They allow for really nice features. Take the following chart as an example: try and &lt;strong&gt;move over with your mouse&lt;/strong&gt;; or &lt;strong&gt;select sections to zoom in&lt;/strong&gt;.

&lt;script src=&#34;http://code.openark.org/blog/wp-content/uploads/2010/03/dygraph-combined.js&#34; type=&#34;text/javascript&#34;&gt;&lt;/script&gt;
&lt;!--[if IE]&gt;&lt;script src=&#34;http://code.openark.org/blog/wp-content/uploads/2010/03/excanvas-min.js&#34;&gt;&lt;/script&gt;&lt; ![endif]--&gt;

&lt;blockquote&gt;
&lt;pre&gt;
&lt;/pre&gt;
&lt;h4&gt;DML&lt;/h4&gt;
&lt;div id=&#34;graphDiv_DML&#34; class=&#34;graphdiv&#34; style=&#34;width: 400px; height: 160px;&#34;&gt;[graphDiv]&lt;/div&gt;
&lt;div id=&#34;labelsDiv_DML&#34; class=&#34;legend&#34;&gt;[labelsDiv]&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;script type=&#34;text/javascript&#34;&gt;// &lt; ![CDATA[&lt;br /&gt;
// &lt; ![CDATA[&lt;br /&gt;
 g_DML = new Dygraph( document.getElementById(&#34;graphDiv_DML&#34;),                         &#34;Date,com_select_psec,com_insert_psec,com_delete_psec,com_update_psec,com_replace_psec\n2009-12-04 15:00:00,113.28,76.54,26.14,29.54,0.00\n2009-12-04 15:10:00,91.51,55.74,30.07,18.13,0.00\n2009-12-04 15:20:00,104.98,57.75,28.26,18.24,0.00\n2009-12-04 15:30:00,110.64,72.17,30.17,27.58,0.00\n2009-12-04 15:40:00,97.79,46.27,29.27,15.91,0.00\n2009-12-04 15:50:00,114.35,61.85,29.55,22.45,0.00\n2009-12-04 16:00:00,110.82,72.38,30.67,30.70,0.00\n2009-12-04 16:10:00,99.05,49.70,29.35,18.56,0.00\n2009-12-04 16:20:00,109.68,50.87,25.74,16.55,0.00\n2009-12-04 16:30:00,103.92,58.70,22.09,22.58,0.00\n2009-12-04 16:40:00,97.24,56.29,31.71,18.78,0.00\n2009-12-04 16:50:00,119.25,65.72,27.80,22.56,0.00\n2009-12-04 17:00:00,118.31,78.34,34.18,30.43,0.00\n2009-12-04 17:10:00,91.06,47.59,29.66,16.60,0.00\n2009-12-04 17:20:00,117.81,59.82,28.94,21.40,0.00\n2009-12-04 17:30:00,109.79,71.37,27.62,27.64,0.00\n2009-12-04 17:40:00,101.07,40.51,29.57,14.18,0.00\n2009-12-04 17:50:00,117.66,61.18,28.31,22.44,0.00\n2009-12-04 18:00:00,115.48,72.82,32.12,28.74,0.00\n2009-12-04 18:10:00,106.51,54.34,32.96,20.37,0.00\n2009-12-04 18:20:00,111.34,65.11,27.60,22.60,0.00\n2009-12-04 18:30:00,109.66,52.25,29.47,18.47,0.00\n2009-12-04 18:40:00,113.63,55.16,28.67,19.98,0.00\n2009-12-04 18:50:00,103.72,51.86,24.67,18.08,0.00\n2009-12-04 19:00:00,111.27,55.78,26.66,22.62,0.00\n2009-12-04 19:10:00,105.73,63.16,35.37,25.88,0.00\n2009-12-04 19:20:00,130.50,60.07,29.82,22.99,0.00\n2009-12-04 19:30:00,110.41,62.64,30.35,24.46,0.00\n2009-12-04 19:40:00,107.05,52.04,27.15,19.22,0.00\n2009-12-04 19:50:00,126.11,57.06,27.12,19.34,0.00\n2009-12-04 20:00:00,111.36,61.40,26.13,25.96,0.00\n2009-12-04 20:10:00,108.82,61.97,29.52,23.49,0.00\n2009-12-04 20:20:00,122.57,59.28,26.03,18.48,0.00\n2009-12-04 20:30:00,109.35,65.42,29.21,23.13,0.00\n2009-12-04 20:40:00,117.19,57.69,28.01,19.24,0.00\n2009-12-04 20:50:00,125.03,61.15,28.95,21.74,0.00\n2009-12-04 21:00:00,118.31,63.11,29.66,23.99,0.00\n2009-12-04 21:10:00,109.98,62.24,38.77,24.02,0.00\n2009-12-04 21:20:00,121.28,57.78,30.48,20.26,0.00\n2009-12-04 21:30:00,113.89,59.62,29.77,23.72,0.00\n2009-12-04 21:40:00,113.93,60.42,29.35,24.71,0.00\n2009-12-04 21:50:00,130.36,55.68,31.94,21.16,0.00\n2009-12-04 22:00:00,114.11,58.93,32.62,24.41,0.00\n2009-12-04 22:10:00,105.52,58.58,26.04,24.47,0.00\n2009-12-04 22:20:00,113.52,57.04,29.26,22.28,0.00\n2009-12-04 22:30:00,132.64,66.22,34.87,26.82,0.00\n2009-12-04 22:40:00,112.08,59.19,27.16,23.73,0.00\n2009-12-04 22:50:00,136.62,59.74,33.41,20.04,0.00\n2009-12-04 23:00:00,119.58,65.67,31.40,24.40,0.00\n2009-12-04 23:10:00,109.12,53.74,28.38,19.60,0.00\n2009-12-04 23:20:00,121.52,60.03,33.16,22.38,0.00\n2009-12-04 23:30:00,123.33,59.59,31.09,22.51,0.00\n2009-12-04 23:40:00,114.75,56.82,25.53,23.43,0.00\n2009-12-04 23:50:00,124.92,51.26,27.86,19.03,0.00\n2009-12-05 00:00:00,88.23,63.21,41.50,18.59,0.00\n2009-12-05 00:10:00,75.10,66.62,29.94,48.01,0.00\n2009-12-05 00:20:00,94.85,49.27,22.05,18.66,0.00\n2009-12-05 00:30:00,80.27,45.21,20.56,17.55,0.00\n2009-12-05 00:40:00,80.96,52.03,21.66,21.14,0.00\n2009-12-05 00:50:00,85.21,57.68,26.57,23.58,0.00\n2009-12-05 01:00:00,88.66,52.56,21.75,20.94,0.00\n2009-12-05 01:10:00,78.66,53.26,22.89,22.36,0.00\n2009-12-05 01:20:00,83.80,50.74,20.65,19.49,0.00\n2009-12-05 01:30:00,82.70,39.99,17.23,15.86,0.00\n2009-12-05 01:40:00,79.66,52.35,23.55,20.94,0.00\n2009-12-05 01:50:00,74.56,47.64,23.05,18.97,0.00\n2009-12-05 02:00:00,81.25,51.35,17.94,21.61,0.00\n2009-12-05 02:10:00,86.83,58.48,25.03,24.95,0.00\n2009-12-05 02:20:00,73.31,41.39,21.09,17.56,0.00\n2009-12-05 02:30:00,82.31,39.70,19.84,16.74,0.00\n2009-12-05 02:40:00,71.19,55.84,19.05,25.97,0.00\n2009-12-05 02:50:00,88.00,44.13,25.32,17.74,0.00\n2009-12-05 03:00:00,84.54,44.78,18.42,18.78,0.00\n2009-12-05 03:10:00,76.92,50.57,17.91,21.81,0.00\n2009-12-05 03:20:00,84.45,49.12,21.54,18.58,0.00\n2009-12-05 03:30:00,89.52,54.20,45.41,22.39,0.00\n2009-12-05 03:40:00,74.15,44.67,26.54,18.04,0.00\n2009-12-05 03:50:00,76.32,44.36,15.02,18.39,0.00\n2009-12-05 04:00:00,83.90,52.30,19.50,22.39,0.00\n2009-12-05 04:10:00,80.26,61.12,20.66,25.68,0.00\n2009-12-05 04:20:00,80.95,42.11,16.95,14.84,0.00\n2009-12-05 04:30:00,93.01,53.36,17.91,21.94,0.00\n2009-12-05 04:40:00,72.70,45.22,16.63,18.16,0.00\n2009-12-05 04:50:00,81.22,44.73,15.41,18.54,0.00\n2009-12-05 05:00:00,80.02,46.60,16.07,21.04,0.00\n2009-12-05 05:10:00,84.33,57.86,21.77,24.71,0.00\n2009-12-05 05:20:00,87.48,60.54,19.66,22.95,0.00\n2009-12-05 05:30:00,86.19,48.62,18.47,17.51,0.00\n2009-12-05 05:40:00,72.92,50.10,18.46,21.00,0.00\n2009-12-05 05:50:00,81.79,48.14,15.75,19.36,0.00\n2009-12-05 06:00:00,83.11,55.70,17.15,23.02,0.00\n2009-12-05 06:10:00,77.98,55.89,18.36,23.16,0.00\n2009-12-05 06:20:00,77.05,45.96,18.06,17.27,0.00\n2009-12-05 06:30:00,87.58,53.76,15.56,20.79,0.00\n2009-12-05 06:40:00,79.33,58.86,21.02,22.84,0.00\n2009-12-05 06:50:00,85.33,49.99,16.23,18.82,0.00\n2009-12-05 07:00:00,87.54,56.70,17.96,23.31,0.00\n2009-12-05 07:10:00,73.33,56.51,17.57,21.74,0.00\n2009-12-05 07:20:00,84.02,52.77,21.21,20.80,0.00\n2009-12-05 07:30:00,88.86,58.34,27.45,23.10,0.00\n2009-12-05 07:40:00,,,,,\n2009-12-05 07:50:00,,,,,\n2009-12-05 08:00:00,,,,,\n2009-12-05 08:10:00,,,,,\n2009-12-05 08:20:00,,,,,\n2009-12-05 08:30:00,,,,,\n2009-12-05 08:40:00,,,,,\n2009-12-05 08:50:00,,,,,\n2009-12-05 09:00:00,,,,,\n2009-12-05 09:10:00,,,,,\n2009-12-05 09:20:00,,,,,\n2009-12-05 09:30:00,,,,,\n2009-12-05 09:40:00,,,,,\n2009-12-05 09:50:00,,,,,\n2009-12-05 10:00:00,,,,,\n2009-12-05 10:10:00,,,,,\n2009-12-05 10:20:00,77.11,55.87,29.31,18.09,0.00\n2009-12-05 10:30:00,85.31,53.70,31.03,18.46,0.00\n2009-12-05 10:40:00,82.72,61.32,26.30,22.98,0.00\n2009-12-05 10:50:00,87.28,46.53,25.04,18.04,0.00\n2009-12-05 11:00:00,92.07,62.62,27.09,25.14,0.00\n2009-12-05 11:10:00,84.59,50.42,25.97,19.96,0.00\n2009-12-05 11:20:00,80.34,49.64,25.75,20.31,0.00\n2009-12-05 11:30:00,103.61,64.36,31.79,24.71,0.00\n2009-12-05 11:40:00,80.03,54.33,33.83,22.37,0.00\n2009-12-05 11:50:00,90.42,48.24,31.26,18.43,0.00\n2009-12-05 12:00:00,92.51,56.34,33.53,22.45,0.00\n2009-12-05 12:10:00,84.34,62.26,22.66,23.31,0.00\n2009-12-05 12:20:00,86.24,51.96,25.69,16.02,0.00\n2009-12-05 12:30:00,92.08,58.61,23.16,19.34,0.00\n2009-12-05 12:40:00,78.48,53.33,22.72,19.51,0.00\n2009-12-05 12:50:00,97.85,57.71,29.80,20.19,0.00\n2009-12-05 13:00:00,89.23,54.84,34.62,20.93,0.00\n2009-12-05 13:10:00,78.92,50.02,22.47,18.19,0.00\n2009-12-05 13:20:00,87.24,50.92,26.37,19.38,0.00\n2009-12-05 13:30:00,96.29,54.78,27.13,20.04,0.00\n2009-12-05 13:40:00,96.39,69.48,30.21,27.19,0.00\n2009-12-05 13:50:00,83.21,55.13,26.48,18.00,0.00\n2009-12-05 14:00:00,97.00,63.61,30.89,22.23,0.00\n2009-12-05 14:10:00,94.65,65.33,33.51,25.04,0.00\n2009-12-05 14:20:00,86.94,58.14,36.10,22.07,0.00\n2009-12-05 14:30:00,91.91,47.25,28.41,14.45,0.00\n2009-12-05 14:40:00,92.55,55.73,29.59,20.69,0.00\n2009-12-05 14:50:00,97.35,58.90,31.63,22.22,0.00\n2009-12-05 15:00:00,97.91,56.09,23.80,21.68,0.00\n&#34;,                         { chartDiv:  document.getElementById(&#34;chartDiv_DML&#34;), labelsDiv: document.getElementById(&#34;labelsDiv_DML&#34;) } ); g_DML.resize(400,160);&lt;br /&gt;
// ]]&gt;&lt;/script&gt;&lt;/p&gt;
&lt;p&gt;The above chart is generated with &lt;em&gt;dygraphs&lt;/em&gt;. Since it is embedded within my Wordpress page, the layout is affected by that of my theme. Take a look at this &lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2010/03/mycheckpoint_interactive_demo.html&#34;&gt;&lt;strong&gt;example page&lt;/strong&gt;&lt;/a&gt; to see similar charts outside this blog site (Internet Explorer users: Maxmimize/minimize button will not work well for now. And, may I suggest &lt;a href=&#34;http://www.mozilla.com/en-US/firefox&#34;&gt;Mozilla Firefox&lt;/a&gt;?)&lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2010/03/mycheckpoint_interactive_demo.html&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Pros and cons of interactive charts&lt;/h4&gt;
&lt;p&gt;Pros&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Can present you with exact values. No more doubt about the &lt;strong&gt;com_replace_psec&lt;/strong&gt; values.&lt;/li&gt;
&lt;li&gt;Can allow for zoom in, zoom out.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Cons&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Need supporting platform. The above cannot be viewed by non-JavaScript browsers (cell phones, etc.)&lt;/li&gt;
&lt;li&gt;Browser support is also an issue with JavaScript.&lt;/li&gt;
&lt;li&gt;Emailing such report will result in mail blocking in many companies: mail filters will not allow for JavaScript code to pass.&lt;/li&gt;
&lt;li&gt;Charts are not necessarily self-contained, in terms of the chart entity With Flash charts (e.g. Fusion Charts) this works. But in the above, the legend and scales are outside the image. As such, they cannot be just moved around.&lt;/li&gt;
&lt;li&gt;HTML pages which include such charts &lt;em&gt;can be&lt;/em&gt; self contained. The HTML page can include all the JavaScript dependencies, in addition to the chart generating code. Flash based charts cannot be self contained.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Summary&lt;/h4&gt;
&lt;p&gt;Interactive charts are cool!&lt;/p&gt;
&lt;p&gt;I&#39;m now integrating &lt;a href=&#34;http://www.danvk.org/dygraphs/&#34;&gt;dygraphs&lt;/a&gt; into &lt;em&gt;mycheckpoint&lt;/em&gt; (How nice it is to work with BSD &amp;amp; MIT licenses!). Though I may later switch to &lt;a href=&#34;http://code.google.com/p/flot/&#34;&gt;flot&lt;/a&gt;, interactive charts will be the next standard charting way in &lt;em&gt;mycheckpoint&lt;/em&gt;. I will continue supporting static Google Charts, as follows from the above pros and cons list.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>mycheckpoint (rev. 88): mount points monitoring, improved charting, enhanced auto-deploy</title>
      <link>/blog/mysql/mycheckpoint-rev-88-mount-points-monitoring-improved-charting-enhanced-auto-deploy/</link>
      <pubDate>Wed, 10 Feb 2010 08:29:47 +0000</pubDate>
      
      <guid>/blog/mysql/mycheckpoint-rev-88-mount-points-monitoring-improved-charting-enhanced-auto-deploy/</guid>
      <description>&lt;p&gt;Revision &lt;a href=&#34;http://code.google.com/p/mycheckpoint/&#34;&gt;#88&lt;/a&gt; of &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint&#34;&gt;mycheckpoint&lt;/a&gt; is released. In this revision:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Disk space monitoring&lt;/li&gt;
&lt;li&gt;Improved charting&lt;/li&gt;
&lt;li&gt;Enhanced auto-deploy&lt;/li&gt;
&lt;li&gt;And more...&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Disk space monitoring&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; now monitors (on Linux only) three mount points:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;The &#34;&lt;strong&gt;/&lt;/strong&gt;&#34; (root) mount point&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;datadir&lt;/strong&gt; mount point&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;tmpdir&lt;/strong&gt; mount point&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;It may well be the case that two of the above (or perhaps all three of them) share the same mount point. For example, if there isn&#39;t any particular partition for &#34;&lt;strong&gt;/tmp&lt;/strong&gt;&#34;, it is possible that the &lt;strong&gt;tmpdir&lt;/strong&gt; (by default &#34;&lt;strong&gt;/tmp&lt;/strong&gt;&#34;) is on the same mount point as &#34;&lt;strong&gt;/&lt;/strong&gt;&#34;. &lt;em&gt;mycheckpoint&lt;/em&gt; does not care.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; monitors and reports the mount point&#39;s used percent, in a similar algorithm &lt;strong&gt;df&lt;/strong&gt; uses.&lt;/p&gt;
&lt;p&gt;Disk space monitoring is only possible when monitoring the local machine (i.e. &lt;em&gt;mycheckpoint&lt;/em&gt; runs on the same machine as the monitored MySQL server). In the future &lt;em&gt;mycheckpoint&lt;/em&gt; may also monitor additional mount points, such as the various logs mount points.&lt;/p&gt;
&lt;h4&gt;&lt;!--more--&gt;Improved charting&lt;/h4&gt;
&lt;p&gt;There has been some extensive work to turn the charts into real time-series based. &lt;a href=&#34;http://code.google.com/apis/chart/&#34;&gt;Google charts&lt;/a&gt; does not support time series charts; when it will, the required URL length would probably be too long to be used. Some SQL tweaks made it possible to display the charts in correct time-scale even if sampling is taken on non constant interval (or fail to be taken for long periods).&lt;/p&gt;
&lt;blockquote&gt;&lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2010/02/mycheckpoint-dml-chart-sample-88.png&#34;&gt;&lt;img class=&#34;alignnone size-full wp-image-1951&#34; title=&#34;mycheckpoint-dml-chart-sample-88&#34; src=&#34;/blog/blog/assets/mycheckpoint-dml-chart-sample-88.png&#34; alt=&#34;&#34; width=&#34;400&#34; height=&#34;200&#34; /&gt;&lt;/a&gt;&lt;/blockquote&gt;
&lt;p&gt;For more examples see the link for &lt;em&gt;HTML brief reports&lt;/em&gt; sample, below.&lt;/p&gt;
&lt;p&gt;I will write more on SQL Google charts generation in the future.&lt;/p&gt;
&lt;h4&gt;Enhanced auto-deploy&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;mycheckpoint&lt;/em&gt; will now detect changes to the MySQL version, in addition to changes in &lt;em&gt;mycheckpoint&lt;/em&gt;&#39;s version itself. This means there&#39;s no need in ever worrying about upgrades to either one of these components. Just use mycheckpoint to take another sample; it will auto-detect if the MySQL version is different, and start sampling all those new variables introduced in the new version (or stop sampling variables no longer used). It works both for MySQL upgrades and downgrades.&lt;/p&gt;
&lt;h4&gt;Enhanced localhost detection&lt;/h4&gt;
&lt;p&gt;To determine whether it is monitoring the local host, &lt;em&gt;mycheckpoint&lt;/em&gt; now considers the hostname for the monitored server, and sees if it is either &lt;strong&gt;&#39;127.0.0.1&#39;&lt;/strong&gt;, &lt;strong&gt;&#39;localhost&#39;&lt;/strong&gt;, or the machine&#39;s &lt;em&gt;hostname&lt;/em&gt; or fully qualified &lt;em&gt;hostname.domainname&lt;/em&gt; (these last two additions apply for Unix based machines, and have only been tested on Linux so far).&lt;/p&gt;
&lt;h4&gt;HTML brief reports&lt;/h4&gt;
&lt;p&gt;Getting a full HTML report is time consuming. I&#39;ve had requests (though not officially submitted through the Issues mechanism) to make it shorter. This is as yet a difficult job. There&#39;s just too much data to aggregate (up to ~180 days of every-5-minute-samples, in a common scenario).&lt;/p&gt;
&lt;p&gt;HTML &lt;em&gt;brief reports&lt;/em&gt; were introduced in previous versions, and have now been enhanced to include more data. These only present last 24 hours data, and load fast. See &lt;a href=&#34;http://code.openark.org/blog/wp-content/uploads/2010/02/mycheckpoint-brief-report-sample-88.html&#34;&gt;HTML brief report sample&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Get it&lt;/h4&gt;
&lt;p&gt;Downloads are available on Google code&#39;s &lt;a href=&#34;http://code.google.com/p/mycheckpoint/&#34;&gt;mycheckpoint&lt;/a&gt; page. Documentation can be found on the &lt;a href=&#34;http://code.openark.org/forge/mycheckpoint/&#34;&gt;mycheckpoint home page&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;On the press&lt;/h4&gt;
&lt;p&gt;Not so new by now (it&#39;s two months old), I&#39;m very happy that mycheckpoint has been noted by &lt;a href=&#34;http://jeremy.zawodny.com/blog/&#34;&gt;&lt;strong&gt;Jeremy Zawodny&lt;/strong&gt;&lt;/a&gt; in his &#34;&lt;a href=&#34;http://www.linux-mag.com/cache/7639/1.html&#34;&gt;My Top Resources of 2009&lt;/a&gt;&#34; column on Linux Magazine.&lt;/p&gt;
&lt;h4&gt;Future plans&lt;/h4&gt;
&lt;p&gt;Immediate plans for mycheckpoint are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Email alerts notifications; this will allow &lt;em&gt;mycheckpoint&lt;/em&gt; to become a real monitoring solution. Following the concept of &#34;&lt;em&gt;SQL oritented monitoring&lt;/em&gt;&#34;, these will be SQL based as well.&lt;/li&gt;
&lt;li&gt;Custom monitoring: allowing user defined queries to be recorded by &lt;em&gt;mycheckpoint&lt;/em&gt;; these can then participate in alerts monitoring. This will allow for easy email notifications on program-level errors.&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
  </channel>
</rss>