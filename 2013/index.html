<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	

	<title>2013 ‚Äì code.openark.org</title>
<link rel="dns-prefetch" href="//secure.gravatar.com">
<link rel="dns-prefetch" href="//s.w.org">


<link rel="stylesheet" id="wp-block-library-css" href="https://shlomi-noach.github.io/blog/wp-includes/css/dist/block-library/style.min.css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="wp-polls-css" href="https://shlomi-noach.github.io/blog/wp-content/plugins/wp-polls/polls-css.css" media="all">
<style id="wp-polls-inline-css">
.wp-polls .pollbar {
	margin: 1px;
	font-size: 6px;
	line-height: 8px;
	height: 8px;
	background-image: url('https://shlomi-noach.github.io/blog/wp-content/plugins/wp-polls/images/default/pollbg.gif');
	border: 1px solid #c8c8c8;
}

</style>
<link rel="stylesheet" id="openark-primer-style-css" href="https://shlomi-noach.github.io/blog/wp-content/themes/openark-primer/style.css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="https://shlomi-noach.github.io/blog/wp-content/plugins/jetpack/css/jetpack.css" media="all">
<script src="https://shlomi-noach.github.io/blog/wp-includes/js/jquery/jquery.js"></script>
<script src="https://shlomi-noach.github.io/blog/wp-includes/js/jquery/jquery-migrate.min.js"></script>



<style data-context="foundation-flickity-css">/*! Flickity v2.0.2
http://flickity.metafizzy.co
---------------------------------------------- */.flickity-enabled{position:relative}.flickity-enabled:focus{outline:0}.flickity-viewport{overflow:hidden;position:relative;height:100%}.flickity-slider{position:absolute;width:100%;height:100%}.flickity-enabled.is-draggable{-webkit-tap-highlight-color:transparent;tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.flickity-enabled.is-draggable .flickity-viewport{cursor:move;cursor:-webkit-grab;cursor:grab}.flickity-enabled.is-draggable .flickity-viewport.is-pointer-down{cursor:-webkit-grabbing;cursor:grabbing}.flickity-prev-next-button{position:absolute;top:50%;width:44px;height:44px;border:none;border-radius:50%;background:#fff;background:hsla(0,0%,100%,.75);cursor:pointer;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.flickity-prev-next-button:hover{background:#fff}.flickity-prev-next-button:focus{outline:0;box-shadow:0 0 0 5px #09f}.flickity-prev-next-button:active{opacity:.6}.flickity-prev-next-button.previous{left:10px}.flickity-prev-next-button.next{right:10px}.flickity-rtl .flickity-prev-next-button.previous{left:auto;right:10px}.flickity-rtl .flickity-prev-next-button.next{right:auto;left:10px}.flickity-prev-next-button:disabled{opacity:.3;cursor:auto}.flickity-prev-next-button svg{position:absolute;left:20%;top:20%;width:60%;height:60%}.flickity-prev-next-button .arrow{fill:#333}.flickity-page-dots{position:absolute;width:100%;bottom:-25px;padding:0;margin:0;list-style:none;text-align:center;line-height:1}.flickity-rtl .flickity-page-dots{direction:rtl}.flickity-page-dots .dot{display:inline-block;width:10px;height:10px;margin:0 8px;background:#333;border-radius:50%;opacity:.25;cursor:pointer}.flickity-page-dots .dot.is-selected{opacity:1}</style><style data-context="foundation-slideout-css">.slideout-menu{position:fixed;left:0;top:0;bottom:0;right:auto;z-index:0;width:256px;overflow-y:auto;-webkit-overflow-scrolling:touch;display:none}.slideout-menu.pushit-right{left:auto;right:0}.slideout-panel{position:relative;z-index:1;will-change:transform}.slideout-open,.slideout-open .slideout-panel,.slideout-open body{overflow:hidden}.slideout-open .slideout-menu{display:block}.pushit{display:none}</style>
<link rel="dns-prefetch" href="//v0.wordpress.com">


<meta property="og:type" content="website">
<meta property="og:title" content="2013 ‚Äì code.openark.org">
<meta property="og:site_name" content="code.openark.org">
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg">
<meta property="og:locale" content="en_US">


<style>.ios7.web-app-mode.has-fixed header{ background-color: rgba(242,101,34,.88);}</style></head>

<body class="archive date hfeed no-sidebar">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#primary">Skip to content</a>

	<header id="masthead" class="site-header">
		<div class="site-branding">
							<p class="site-title"><a href="https://shlomi-noach.github.io/blog/" rel="home">code.openark.org</a></p>
								<p class="site-description">Blog by Shlomi Noach</p>
			
			<nav id="site-navigation" class="main-navigation">
				<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">primary-menu</button>
				<div class="menu-primary-menu-container"><ul id="menu-primary-menu" class="menu"><li id="menu-item-8109" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8109"><a href="https://shlomi-noach.github.io/blog/archives">archives</a></li>
<li id="menu-item-8050" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8050"><a href="https://shlomi-noach.github.io/blog/presentations">presentations</a></li>
<li id="menu-item-8055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8055"><a href="https://shlomi-noach.github.io/blog/about">about</a></li>
<li id="menu-item-8071" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8071"><a href="https://github.com/shlomi-noach"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a></li>
<li id="menu-item-8074" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8074"><a href="https://www.linkedin.com/in/shlominoach"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg></a></li>
<li id="menu-item-8072" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8072"><a href="https://twitter.com/ShlomiNoach"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z"></path></svg></a></li>
<li id="menu-item-8073" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8073"><a href="https://shlomi-noach.github.io/blog/feed"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-12.832 20c-1.197 0-2.168-.969-2.168-2.165s.971-2.165 2.168-2.165 2.167.969 2.167 2.165-.97 2.165-2.167 2.165zm5.18 0c-.041-4.029-3.314-7.298-7.348-7.339v-3.207c5.814.041 10.518 4.739 10.561 10.546h-3.213zm5.441 0c-.021-7.063-5.736-12.761-12.789-12.792v-3.208c8.83.031 15.98 7.179 16 16h-3.211z"></path></svg></a></li>
</ul></div>			</nav>
		</div>
	</header>

	<main id="primary" class="site-main">

		
			<header class="page-header">
				<h1 class="page-title">Year: 2013</h1>			</header>

			
<article id="post-6682" class="post-6682 post type-post status-publish format-standard hentry category-mysql tag-analysis tag-monitoring tag-scripts">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/bash-script-report-largest-innodb-files" rel="bookmark">Bash script: report largest InnoDB files</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/analysis" rel="tag">Analysis</a><a href="https://shlomi-noach.github.io/blog/tag/monitoring" rel="tag">Monitoring</a><a href="https://shlomi-noach.github.io/blog/tag/scripts" rel="tag">scripts</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/bash-script-report-largest-innodb-files" rel="bookmark"><time class="entry-date published updated" datetime="2013-12-19T10:58:17+02:00">December 19, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>The following script will report the largest InnoDB tables under the data directory: schema, table & length in bytes. The tables could be non-partitioned, in which case this is simply the size of the corresponding <strong>.ibd</strong> file, or they can be partitioned, in which case the reported size is the sum of all partition files. It is assumed tables reside in their own tablespace files, i.e. created with <strong>innodb_file_per_table=1</strong>.</p>
<blockquote>
<pre>(
¬†¬†¬† mysql_datadir=$(grep datadir /etc/my.cnf | cut -d "=" -f 2)
¬†¬†¬† cd $mysql_datadir
¬†¬†¬† for frm_file in $(find . -name "*.frm")
¬†¬†¬† do
¬†¬†¬†¬†¬†¬†¬† tbl_file=${frm_file//.frm/.ibd}
¬†¬†¬†¬†¬†¬†¬† table_schema=$(echo $frm_file | cut -d "/" -f 2)
¬†¬†¬†¬†¬†¬†¬† table_name=$(echo $frm_file | cut -d "/" -f 3 | cut -d "." -f 1)
¬†¬†¬†¬†¬†¬†¬† if [ -f $tbl_file ]
¬†¬†¬†¬†¬†¬†¬† then
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† # unpartitioned table
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† file_size=$(du -cb $tbl_file 2> /dev/null | tail -n 1) 
¬†¬†¬†¬†¬†¬†¬† else
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† # attempt partitioned innodb table
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† tbl_file_partitioned=${frm_file//.frm/#*.ibd}
¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† file_size=$(du -cb $tbl_file_partitioned 2> /dev/null | tail -n 1)
¬†¬†¬†¬†¬†¬†¬† fi
¬†¬†¬†¬†¬†¬†¬† file_size=${file_size//total/}
¬†¬†¬†¬†¬†¬†¬† # Replace the below with whatever action you want to take,
¬†¬†¬†¬†¬†¬†¬† # for example, push the values into graphite.
¬†¬†¬†¬†¬†¬†¬† echo $file_size $table_schema $table_name
¬†¬†¬† done
) | sort -k 1 -nr | head -n 20</pre>
</blockquote>
<p>We use this to push table statistics to our graphite service; we keep an eye on table growth (we actually do not limit to top <strong>20</strong> but just monitor them all). File size does not report the real table data size (this can be smaller due to tablespace fragmentation). It does give the correct information if you‚Äôre concerned about disk space. For table data we also monitor <strong>SHOW TABLE STATUS</strong> / <strong>INFORMATION_SCHEMA.TABLES</strong>, themselves being inaccurate. Gotta go by something.</p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/bash-script-report-largest-innodb-files#comments">3 Comments<span class="screen-reader-text"> on Bash script: report largest InnoDB files</span></a></span>	</footer>
</article>

<article id="post-6668" class="post-6668 post type-post status-publish format-standard hentry category-mysql tag-community tag-opinions tag-perconalive">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/why-a-professional-conference-must-have-a-committee-and-what-that-committee-does" rel="bookmark">Why a professional conference must have a committee, and what that committee does</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/community" rel="tag">community</a><a href="https://shlomi-noach.github.io/blog/tag/opinions" rel="tag">Opinions</a><a href="https://shlomi-noach.github.io/blog/tag/perconalive" rel="tag">PerconaLive</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/why-a-professional-conference-must-have-a-committee-and-what-that-committee-does" rel="bookmark"><time class="entry-date published" datetime="2013-12-14T11:11:49+02:00">December 14, 2013</time><time class="updated" datetime="2013-12-14T11:12:16+02:00">December 14, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>What exactly is it that a conference committee does? This post comes as response to a comment on <a href="http://www.mysqlperformanceblog.com/2013/12/11/percona-live-2014-conference-sneak-peek/">A sneak peek at the Percona Live MySQL Conference & Expo 2014</a>, reading:</p>
<blockquote><p>Why the same committee each year? Community should vote on proposals and committee should just work schedule,etc.</p></blockquote>
<p>I‚Äôll pick the glove and shed some light into the work of the committee. While this specific comment related to the Percona Live conference, I trust that my opinions expressed below apply just as well to any (technical?) professional conference; the point below can equally apply to conferences from Oracle MySQL Connect, O‚ÄôReilly Velocity to FOSDEM & PyCon.</p>
<p>I can sum up the entire answer with one word: ‚ÄúDiscussion‚Äù. For a breakdown, please read through.</p>
<h4>First, what‚Äôs not feasible with community-based voting, and what looks very wrong</h4>
<p>So why not open up a voting system and let the community do the rating? I always disliked the ‚Äúsend an SMS to this number to vote for X‚Äù approach. It is so unbalanced and unreliable: if I were to submit a proposal describing how my company invented/develops/uses X to do great things, I can expect my co-workers to vote for me. In fact, my company would possibly ask my co-workers to do so. I stand a better chance if I work in a large company; less so in a small company.</p>
<p>Anonymous votes tend to be touched by politics. I could vote for my company, against a competing product, for my friends, against people I dislike, and none the wiser. We can take away anonymity, which means my votes will be public, which means they are visible to all. In which case my ranking will be affected by what people I rate would think of me; which means my rating would not be based on strictly professional/technical grounds.</p>
<p>But before we drop into this endless pit, let‚Äôs consider: will I, as a KMyPyVelocirails community member, really engage in reviewing over 300 submissions? How many members of my community would take so many hours of their time to do so? Let me clarify, this is a part-time job. It requires time, and it requires a mindset. I‚Äôm guessing here that you cannot count on everyone rating all talks. Some more prominent talks will be reviewed by more people, others may be left little to not reviewed in the first place.</p>
<p>The idea of a purely community based rating is romantic and beautiful, but not feasible.</p>
<p>And then there‚Äôs the <em>discussion</em>. Let‚Äôs look at some of the things the committee is engaged in to clarify.</p>
<h4>Duties, responsibility and actions of a conference committee</h4>
<p>The following discussion cannot be an exhaustive description of a committee‚Äôs work, but it can give a good glimpse into its scope. We begin with the commitment the members take upon themselves: to invest their time and will in the committee‚Äôs duties. Once you join in, you are expected to work and deliver. <a href="https://shlomi-noach.github.io/blog/mysql/why-a-professional-conference-must-have-a-committee-and-what-that-committee-does#more-6668" class="more-link">Continue reading ¬ª<span class="screen-reader-text"> ‚ÄúWhy a professional conference must have a committee, and what that committee does‚Äù</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/why-a-professional-conference-must-have-a-committee-and-what-that-committee-does#respond">Leave a Comment<span class="screen-reader-text"> on Why a professional conference must have a committee, and what that committee does</span></a></span>	</footer>
</article>

<article id="post-6651" class="post-6651 post type-post status-publish format-standard hentry category-mysql tag-perconalive">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/percona-live-mysql-conference-expo-2014-call-for-papers-guidelines" rel="bookmark">Percona Live: MySQL Conference & Expo 2014: call for papers & guidelines</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/perconalive" rel="tag">PerconaLive</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/percona-live-mysql-conference-expo-2014-call-for-papers-guidelines" rel="bookmark"><time class="entry-date published" datetime="2013-11-14T11:59:54+02:00">November 14, 2013</time><time class="updated" datetime="2013-11-14T12:00:17+02:00">November 14, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>Call for papers for <a href="https://www.percona.com/live/mysql-conference-2014/">Percona Live MySQL Conference & Expo 2014</a> is open. As in previous year, I have the honour of being conference committee chairman, which means I‚Äôm in particular part of the reviewing committee. I wish to add to <a href="http://datacharmer.blogspot.co.il/2013/11/call-for-papers-with-lightning-talks.html">Giuseppe‚Äôs fine observations and suggestions</a>. On submitting a talk, please consider the following:</p>
<ul>
<li>Make it right the first time (an old advice by Baron). We will not be able to review your proposal more than once. We will not be iterating the proposals again and again to see what‚Äôs changed, nor will we have a feed for updated content. We will not be able to diff any changes you made to your proposal. Get it right the first time, this is the one time we will read your proposal.</li>
</ul>
<p>On <em>rare occasions</em> we may think your proposal is just too important to be thrown just for bad description/grammar/language, and we may contact you to refine.</p>
<ul>
<li>The proposal must be as clear to us as for your target audience. Good proposals are easy to understand. Make it clear.</li>
</ul>
<p>Being super-famous does not grant you immediate approval. It helps if you‚Äôve given the talk <strong>10</strong> times in the past, and we‚Äôve all seen it and it was widely acknowledged as one of the best talks ever. But then again, if that‚Äôs the kind of speaker you are, you probably know how to write a good proposal.</p>
<p>The committee seeks the audience‚Äôs best interest. We assume the audience‚Äôs common sense is similar, via extrapolation, to our own. We therefore assume that if we think a proposal is bad, so will the audience.</p>
<ul>
<li>If you‚Äôre a commercial vendor and you want to make a proposal, that‚Äôs fine.
<ul>
<li>I suppose the best way would be through the sponsor program</li>
<li>But otherwise we actually accept talks on commercial/closed source solutions. Be advised, however, that the committee members will typically wish to promote open source & free solutions, and so commercial/closed source talks are at some disadvantage.</li>
</ul>
</li>
<li>If you are owner/employee of commercial/closed source solution, and you‚Äôre going to speak on a subject that is related to your product, please be very explicit:
<ul>
<li>either note (in private notes, if you like) that you will be, say, comparing your own product along with other products, and provide full disclosure</li>
<li>or let us know you will in fact <em>not</em> speak about your own product, and make us sigh in relief.</li>
<li>In short, don‚Äôt let us suspect this is going to be a sales pitch in disguise. It is one of the quickest ways to get your proposal rejected.</li>
</ul>
</li>
</ul>
<p>You might be interested to learn that last year, a proposal made by an influential and a well known speaker was turned down for that exact reason. Even if he had no intention of doing a sales pitch, that‚Äôs what it looked like to us, and by extrapolation to the audience. <a href="https://shlomi-noach.github.io/blog/mysql/percona-live-mysql-conference-expo-2014-call-for-papers-guidelines#more-6651" class="more-link">Continue reading ¬ª<span class="screen-reader-text"> ‚ÄúPercona Live: MySQL Conference & Expo 2014: call for papers & guidelines‚Äù</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/percona-live-mysql-conference-expo-2014-call-for-papers-guidelines#comments">1 Comment<span class="screen-reader-text"> on Percona Live: MySQL Conference & Expo 2014: call for papers & guidelines</span></a></span>	</footer>
</article>

<article id="post-6645" class="post-6645 post type-post status-publish format-standard hentry category-mysql tag-common_schema tag-perconalive tag-speaking">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/common_schema-speaking-at-percona-live-london-nov-2013" rel="bookmark">common_schema: speaking at Percona Live London, Nov. 2013</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/common_schema" rel="tag">common_schema</a><a href="https://shlomi-noach.github.io/blog/tag/perconalive" rel="tag">PerconaLive</a><a href="https://shlomi-noach.github.io/blog/tag/speaking" rel="tag">Speaking</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/common_schema-speaking-at-percona-live-london-nov-2013" rel="bookmark"><time class="entry-date published" datetime="2013-11-04T17:30:50+02:00">November 4, 2013</time><time class="updated" datetime="2013-11-15T18:20:48+02:00">November 15, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>In one week‚Äôs time I‚Äôll be presenting <a href="http://www.percona.com/live/london-2013/sessions/commonschema-dbas-framework-mysql">common_schema: DBA‚Äôs framework for MySQL</a> at Percona Live, London.</p>
<p>This talk introduces the rich toolset known as <a href="http://code.google.com/p/common-schema/">common_schema</a>. It is free, open source, extremely useful in solving DBA & developer tasks, and is the next best thing ever invented next to SQL pie charts.</p>
<p>I‚Äôll introduce:</p>
<ul>
<li>Views, with which you can detect and terminate idle transactions, blocking transactions; roll your range partitions; find duplicate keys; block/unblock accounts; get fine grained privileges per account; find AUTO_ICNREMENT free space; ‚Ä¶</li>
<li>Routines: do meta executions such as eval(); get query checksums; duplicating accounts; killing suspicious connections; security auditing; parsing JSON data; ‚Ä¶</li>
<li>QueryScript: if you‚Äôre not using it, you‚Äôre missing on a powerful scripting language tightly integrated with SQL/MySQL. We‚Äôll see the basic constructs, variables, loops; the more sophisticated MySQL/locks/overhead/danger aware constructs such as foreach & split; throttling, exceptions, it‚Äôs all in there. I‚Äôll present real scripts that saved the day and challenge you to implement them in another scripting language.</li>
<li>Briefly introducing rdebug: stored routine debugger and debugging API</li>
<li>Roadmap (some cool things coming along) <a href="https://shlomi-noach.github.io/blog/mysql/common_schema-speaking-at-percona-live-london-nov-2013#more-6645" class="more-link">Continue reading ¬ª<span class="screen-reader-text"> ‚Äúcommon_schema: speaking at Percona Live London, Nov. 2013‚Äù</span></a></li>
</ul>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/common_schema-speaking-at-percona-live-london-nov-2013#comments">5 Comments<span class="screen-reader-text"> on common_schema: speaking at Percona Live London, Nov. 2013</span></a></span>	</footer>
</article>

<article id="post-6613" class="post-6613 post type-post status-publish format-standard hentry category-mysql tag-configuration tag-innodb tag-performance tag-tokudb">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/tokudb-configuration-variables-of-interest" rel="bookmark">TokuDB configuration variables of interest</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/configuration" rel="tag">Configuration</a><a href="https://shlomi-noach.github.io/blog/tag/innodb" rel="tag">InnoDB</a><a href="https://shlomi-noach.github.io/blog/tag/performance" rel="tag">Performance</a><a href="https://shlomi-noach.github.io/blog/tag/tokudb" rel="tag">TokuDB</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/tokudb-configuration-variables-of-interest" rel="bookmark"><time class="entry-date published" datetime="2013-10-23T19:42:12+02:00">October 23, 2013</time><time class="updated" datetime="2013-10-24T07:27:22+02:00">October 24, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>During our experiments I came upon a few TokuDB variables of interest; if you are using TokuDB you might want to look into these:</p>
<ul>
<li>
<h4>tokudb_analyze_time</h4>
</li>
</ul>
<p style="padding-left: 30px;">This is a boundary on the number of seconds an <strong>ANALYZE TABLE</strong> will operate on each index on each partition on a TokuDB table.</p>
<p style="padding-left: 30px;">That is, if <strong>tokudb_analyze_time = 5</strong>, and your table has <strong>4</strong> indexes (including <strong>PRIMARY</strong>) and <strong>7</strong> partitions, then the total runtime is limited to <strong>5*4*7 = 140</strong> seconds.</p>
<p style="padding-left: 30px;">Default in <strong>7.1.0</strong>: <strong>5</strong> seconds</p>
<ul>
<li>
<h4>tokudb_cache_size</h4>
</li>
</ul>
<p style="padding-left: 30px;">Similar to <strong>innodb_buffer_pool_size</strong>, this variable sets the amount of memory allocated by TokuDB for caching pages. Like InnoDB the table is clustered within the index, so the cache includes pages for both indexes and data.</p>
<p style="padding-left: 30px;">Default: <strong>50%</strong> of total memory</p>
<ul>
<li>
<h4>tokudb_directio</h4>
</li>
</ul>
<p style="padding-left: 30px;">Boolean, values are <strong>0/1</strong>. Setting <strong>tokudb_directio = 1</strong> is like specifying <strong>innodb_flush_method = O_DIRECT</strong>. Which in turn means the OS should not cache pages requested by TokuDB. Default: <strong>0</strong>.</p>
<p style="padding-left: 30px;">Now here‚Äôs the interesting part: we are used to tell InnoDB to get the most memory we can provide (because we want it to cache as much as it can) and to avoid OS caching (because that would mean a page would appear both in the buffer pool and in OS memory, which is a waste). So the following setup is common: <a href="https://shlomi-noach.github.io/blog/mysql/tokudb-configuration-variables-of-interest#more-6613" class="more-link">Continue reading ¬ª<span class="screen-reader-text"> ‚ÄúTokuDB configuration variables of interest‚Äù</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/tokudb-configuration-variables-of-interest#comments">14 Comments<span class="screen-reader-text"> on TokuDB configuration variables of interest</span></a></span>	</footer>
</article>

<article id="post-6624" class="post-6624 post type-post status-publish format-standard hentry category-mysql tag-opinions">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/5-years-of-blogging" rel="bookmark">5 years of blogging</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/opinions" rel="tag">Opinions</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/5-years-of-blogging" rel="bookmark"><time class="entry-date published updated" datetime="2013-10-22T19:37:50+02:00">October 22, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p><a href="https://shlomi-noach.github.io/blog/">openark.org blog</a> is now five years old. Hurrah!</p>
<p>Throughout these five years I posted almost exclusively MySQL oriented blogs, though I had every intention of writing on various engineering topics.</p>
<p>I still see blogging as one of the most important forms of knowledge sharing, and indeed for me the blogs aggregated at <a href="http://planet.mysql.com/">Planet MySQL</a> are my main source of MySQL information. I especially like to read technical content straight from the developer; but am also keen on being updated with news on conferences, releases, distributions and some insightful opinions.</p>
<p>The advent of the Stack Exchange websites makes for a common place where people get to learn ‚Äúhow to issue this query‚Äù or ‚Äúhow replication works‚Äù. I can see the <a href="http://dba.stackexchange.com/">DBA site</a> gaining popularity, though still going slow. Eventually I suspect it will be the one place where people share their questions and answers.</p>
<p>Nevertheless blogging is a great way of sharing a new finding of yours; express an opinion; review a product. So I hope for five more years of active blogging, and thank the readers of this blog for keeping watch!</p>
<p>Some numbers: to date I‚Äôve posted <strong>296</strong> MySQL related posts (so <strong>1.13</strong> blog posts per week, evenly spread). The vast majority were technical; and a few opinions. I posted <a href="https://shlomi-noach.github.io/blog/">6 comic strips</a>; most of which were,¬†I‚Äôm afraid, largely misunderstood¬† (the blame is on me) and projected exactly the opposite perception I was trying to express. I‚Äôm bound to fail again.</p>
<p>Traffic can be better (not sharing all my secrets). Been a slow down in the past months. I know, I haven‚Äôt produced much <a href="https://shlomi-noach.github.io/blog/mysql/sql-pie-chart">Pie charts</a> lately.</p>
<p>Again, thank you for reading or commenting. No point in blogging if no one pays attention to your blabbering! And do keep coming üôÇ</p>
<p></meta-post></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/5-years-of-blogging#comments">3 Comments<span class="screen-reader-text"> on 5 years of blogging</span></a></span>	</footer>
</article>

<article id="post-6603" class="post-6603 post type-post status-publish format-standard hentry category-mysql tag-common_schema tag-innodb tag-tokudb">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-3-operational-stuff" rel="bookmark">Converting an OLAP database to TokuDB, part 3: operational stuff</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/common_schema" rel="tag">common_schema</a><a href="https://shlomi-noach.github.io/blog/tag/innodb" rel="tag">InnoDB</a><a href="https://shlomi-noach.github.io/blog/tag/tokudb" rel="tag">TokuDB</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-3-operational-stuff" rel="bookmark"><time class="entry-date published updated" datetime="2013-10-14T12:03:43+02:00">October 14, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>This is the third post in a series of posts describing our experience in migrating a large DWH server to TokuDB (see <a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-1">1st</a> and <a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-2-the-process-of-migration">2nd</a> parts). This post discusses operations; namely ALTER TABLE operations in TokuDB. We ran into quite a few use cases by this time that we can shed light on.</p>
<p>Quick recap: we‚Äôve altered one of out DWH slaves to TokuDB, with the goal of migrating most of out servers, including the master, to TokuDB.</p>
<h4>Adding an index</h4>
<p>Shortly after migrating our server to TokuDB we noticed an unreasonably disproportionate slave lag on our TokuDB slave (red line in chart below) as compared to other slaves.</p>
<blockquote><p><a href="https://shlomi-noach.github.io/blog/wp-content/uploads/2013/09/tokudb-slave-lag.png"><img alt="tokudb-slave-lag" src="https://shlomi-noach.github.io/blog/wp-content/uploads/2013/09/tokudb-slave-lag.png" width="700" height="329"></a></p></blockquote>
<p>Quick investigation led to the fact that, coincidentally, a manual heavy-duty operation was just taking place, which updated some year‚Äôs worth of data retroactively. OK, but why so slow on TokuDB? Another quick investigation led to an apples vs. oranges problem: as depicted in <a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-1">part 1</a>, our original setup included MONTHly partitioning on our larger tables, whereas we could not do the same in TokuDB, where we settled for YEARly partitioning.</p>
<p>The heavy-duty operation included a query that was relying on the MONTHly partitioning to do reasonable pruning: a <strong>WHERE</strong> condition on a date column did the right partition pruning; but where on InnoDB that would filter <strong>1</strong> month‚Äôs worth of data, on TokuDB it would filter <strong>1</strong> <em>year</em>.</p>
<p>Wasn‚Äôt it suggested that TokuDB has online table operations? I decided to give it a shot, and add a proper index on our date column (I actually created a compound index, but irrelevant).</p>
<p>It took <strong>13</strong> minutes to add an index on a <strong>1GB</strong> TokuDB table (approx. <strong>20GB</strong> InnoDB uncompressed equivalent):</p>
<ul>
<li>The <strong>ALTER</strong> was non blocking: table was unlocked at that duration</li>
<li>The client issuing the <strong>ALTER</strong> <em>was</em> blocked (I thought it would happen completely in the background) ‚Äî but who cares?</li>
<li>I would say <strong>13</strong> minutes is fast</li>
</ul>
<p>Not surprisingly adding the index eliminated the problem altogether.</p>
<h4>Modifying a PRIMARY KEY</h4>
<p>It was suggested by our DBA that there was a long time standing need to modify our <strong>PRIMARY KEY</strong>. It was impossible to achieve with our InnoDB setup (not enough disk space for the operation, would take weeks to complete if we did have the disk space). Would it be possible to modify our TokuDB tables? On some of our medium-sized tables we issued an <strong>ALTER</strong> of the form: <a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-3-operational-stuff#more-6603" class="more-link">Continue reading ¬ª<span class="screen-reader-text"> ‚ÄúConverting an OLAP database to TokuDB, part 3: operational stuff‚Äù</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-3-operational-stuff#comments">7 Comments<span class="screen-reader-text"> on Converting an OLAP database to TokuDB, part 3: operational stuff</span></a></span>	</footer>
</article>

<article id="post-6579" class="post-6579 post type-post status-publish format-standard hentry category-mysql tag-configuration tag-development tag-plugin">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/on-mysql-plugin-configuration" rel="bookmark">On MySQL plugin configuration</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/configuration" rel="tag">Configuration</a><a href="https://shlomi-noach.github.io/blog/tag/development" rel="tag">Development</a><a href="https://shlomi-noach.github.io/blog/tag/plugin" rel="tag">plugin</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/on-mysql-plugin-configuration" rel="bookmark"><time class="entry-date published updated" datetime="2013-10-01T08:50:08+02:00">October 1, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>MySQL offers <a href="http://dev.mysql.com/doc/refman/5.5/en/plugin-api.html">plugin API</a>, with which you can add <a href="http://dev.mysql.com/doc/refman/5.5/en/plugin-types.html">different types</a> of plugins to the server. The API is roughly the same for all plugin types: you implement an init() function, a deinit(); you declare status variables and global variables associated with your plugin, and of course you implement the particular implementation of plugin call.</p>
<p>I wish to discuss the creation and use of global variables for plugins.</p>
<p>Consider the following declaration of a global variable in <a href="https://github.com/outbrain/audit_login">audit_login</a>:</p>
<blockquote>
<pre>static MYSQL_SYSVAR_BOOL(enabled, plugin_enabled, PLUGIN_VAR_NOCMDARG,
"enable/disable the plugin's operation, namely writing to file", NULL, NULL, 1);

static struct st_mysql_sys_var * audit_login_sysvars[] = {
¬†¬†¬† MYSQL_SYSVAR(enabled),
¬†¬†¬† NULL
};</pre>
</blockquote>
<p>The above creates a new global variables called <strong>‚Äúsimple_login_audit_enabled‚Äù</strong>: it is composed of the plugin name (known to be <strong>‚Äúsimple_login_audit‚Äù</strong> in our example) and declared name (<strong>‚Äúenabled‚Äù</strong>). It is a boolean, defaults to <strong>1</strong>, and is associated with the internal <strong>plugin_enabled</strong> variable.</p>
<p>Once this variable is declared, you can expect to be able to: <a href="https://shlomi-noach.github.io/blog/mysql/on-mysql-plugin-configuration#more-6579" class="more-link">Continue reading ¬ª<span class="screen-reader-text"> ‚ÄúOn MySQL plugin configuration‚Äù</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/on-mysql-plugin-configuration#comments">9 Comments<span class="screen-reader-text"> on On MySQL plugin configuration</span></a></span>	</footer>
</article>

<article id="post-6523" class="post-6523 post type-post status-publish format-standard hentry category-mysql tag-development tag-open-source tag-plugin tag-security">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/introducing-audit_login-simple-mysql-login-logfile-based-auditing" rel="bookmark">Introducing audit_login: simple MySQL login logfile based auditing</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/development" rel="tag">Development</a><a href="https://shlomi-noach.github.io/blog/tag/open-source" rel="tag">Open Source</a><a href="https://shlomi-noach.github.io/blog/tag/plugin" rel="tag">plugin</a><a href="https://shlomi-noach.github.io/blog/tag/security" rel="tag">Security</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/introducing-audit_login-simple-mysql-login-logfile-based-auditing" rel="bookmark"><time class="entry-date published updated" datetime="2013-09-17T09:24:09+02:00">September 17, 2013</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p><a href="https://github.com/outbrain/audit_login">audit_login</a> is a simple MySQL login auditing plugin, logging any login or login attempt to log file in JSON format.</p>
<p>It seems that audit plugins are <a href="http://serge.frezefond.com/2013/09/news-mariadb-audit-plugin-beta-is-out/">all the rage</a> lately‚Ä¶ We‚Äôve developed out simple plugin a month ago as part of our database securing efforts; by auditing any login or login attempt we could either intercept or later investigate suspicious logins.</p>
<p>However we quickly realized there is much more to be gathered by this info.</p>
<p>In very short, you install this plugin onto your MySQL server, and your server starts writing into a text file called <strong>audit_login.log</strong> entries such as follows:</p>
<blockquote>
<pre>{"ts":"2013-09-11 09:11:47","type":"successful_login","myhost":"gromit03","thread":"74153868","user":"web_user","priv_user":"web_user","host":"web-87.localdomain","ip":"10.0.0.87"}
{"ts":"2013-09-11 09:11:55","type":"failed_login","myhost":"gromit03","thread":"74153869","user":"backup_user","priv_user":"","host":"web-32","ip":"10.0.0.32"}
{"ts":"2013-09-11 09:11:57","type":"failed_login","myhost":"gromit03","thread":"74153870","user":"backup_user","priv_user":"","host":"web-32","ip":"10.0.0.32"}
{"ts":"2013-09-11 09:12:48","type":"successful_login","myhost":"gromit03","thread":"74153871","user":"root","priv_user":"root","host":"localhost","ip":"10.0.0.111"}
{"ts":"2013-09-11 09:13:26","type":"successful_login","myhost":"gromit03","thread":"74153872","user":"web_user","priv_user":"web_user","host":"web-11.localdomain","ip":"10.0.0.11"}
{"ts":"2013-09-11 09:13:44","type":"successful_login","myhost":"gromit03","thread":"74153873","user":"web_user","priv_user":"web_user","host":"web-40.localdomain","ip":"10.0.0.40"}
{"ts":"2013-09-11 09:13:51","type":"successful_login","myhost":"gromit03","thread":"74153874","user":"web_user","priv_user":"web_user","host":"web-03.localdomain","ip":"10.0.0.03"}
{"ts":"2013-09-11 09:14:09","type":"successful_login","myhost":"gromit03","thread":"74153875","user":"web_user","priv_user":"web_user","host":"web-40.localdomain","ip":"10.0.0.40"}
{"ts":"2013-09-11 10:55:25","type":"successful_login","myhost":"gromit03","thread":"74153876","user":"web_user","priv_user":"web_user","host":"web-87.localdomain","ip":"10.0.0.87"}
{"ts":"2013-09-11 10:55:59","type":"successful_login","myhost":"gromit03","thread":"74153877","user":"web_user","priv_user":"web_user","host":"web-12.localdomain","ip":"10.0.0.12"}
{"ts":"2013-09-11 10:55:59","type":"failed_login","myhost":"gromit03","thread":"74153878","user":"(null)","priv_user":"(null)","host":"(null)","ip":"10.0.0.1"}</pre>
</blockquote>
<p>In the above your MySQL server is on <strong>gromit03</strong>, and is accepting connections from other hosts; some successful, some not. What kind of information can you gather from the above?</p>
<ul>
<li>You can tell how many connections are being created on your server</li>
<li>Where they came from</li>
<li>Where <strong>‚Äòroot‚Äô</strong> connections come from</li>
<li>Port scans (see last row) can be identified by no credentials. These don‚Äôt have to be port scans <em>per se</em>; any <strong>telnet localhost 3006</strong> followed by <strong>Ctrl+D</strong> will show the same. Typically these would be either load balancer or monitoring tools checks to see that the <strong>3306</strong> port is active.</li>
<li>You can tell which accounts connect, and how many times</li>
<li>And you can infer which accounts are stale and can be dropped ‚Äî if an account does not connect within a week‚Äôs time, it‚Äôs probably stale (pick your own timeframe)</li>
</ul>
<p>The above is quite interesting on one host; but we have dozens. We‚Äôve installed this plugin on all our MySQL servers, and we use <a href="http://logstash.net/"><strong>logstash</strong></a> to aggregate them. We aggregate to two destinations: <a href="https://shlomi-noach.github.io/blog/mysql/introducing-audit_login-simple-mysql-login-logfile-based-auditing#more-6523" class="more-link">Continue reading ¬ª<span class="screen-reader-text"> ‚ÄúIntroducing audit_login: simple MySQL login logfile based auditing‚Äù</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/introducing-audit_login-simple-mysql-login-logfile-based-auditing#comments">9 Comments<span class="screen-reader-text"> on Introducing audit_login: simple MySQL login logfile based auditing</span></a></span>	</footer>
</article>

<article id="post-6530" class="post-6530 post type-post status-publish format-standard hentry category-mysql tag-common_schema tag-percona-toolkit tag-tokudb">
	<header class="entry-header">
		<h2 class="entry-title"><a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-2-the-process-of-migration" rel="bookmark">Converting an OLAP database to TokuDB, part 2: the process of migration</a></h2>			<div class="entry-meta">
				<span class="cat-links"><a href="https://shlomi-noach.github.io/blog/category/mysql" rel="category tag">MySQL</a></span><span class="tags-links"><a href="https://shlomi-noach.github.io/blog/tag/common_schema" rel="tag">common_schema</a><a href="https://shlomi-noach.github.io/blog/tag/percona-toolkit" rel="tag">Percona Toolkit</a><a href="https://shlomi-noach.github.io/blog/tag/tokudb" rel="tag">TokuDB</a></span><span class="posted-on alignright"><a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-2-the-process-of-migration" rel="bookmark"><time class="entry-date published" datetime="2013-09-09T05:29:30+02:00">September 9, 2013</time><time class="updated" datetime="2016-12-10T11:26:50+02:00">December 10, 2016</time></a></span>			</div>
			</header>

	
	<div class="entry-content">
		<p>This is a second in a series of posts describing our experience in migrating a large DWH server to TokuDB. This post discusses the process of migration itself.</p>
<p>As a quick recap (<a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-1">read part 1 here</a>), we have a <strong>2TB</strong> compressed InnoDB (<strong>4TB</strong> uncompressed) based DWH server. Space is running low, and we‚Äôre looking at TokuDB for answers. Early experiments show that TokuDB‚Äôs compression could make a good impact on disk space usage. I‚Äôm still not discussing performance ‚Äî keeping this till later post.</p>
<p>Those with weak hearts can skip right to the end, where we finally have a complete conversion. You can also peek at the very end to find out how much <strong>4TB</strong> uncompressed InnoDB data is worth in TokuDB. But you might want to read through. The process was not smooth, and not as expected (it‚Äôs a war story thing). Throughout the migration we got a lot of insight on TokuDB‚Äôs behaviour, limitations, conveniences, inconveniences and more.</p>
<p>Disclosure: I have no personal interests and no company interests; throughout the process we were in touch with Tokutek engineers, getting free, friendly & professional advice and providing with input of our own. Most of this content has already been presented to Tokutek throughout the process. TokuDB is open source and free to use, though commercial license is also available.</p>
<h4>How do you convert 4TB worth of data to TokuDB?</h4>
<p>Obviously one table at a time. But we had another restriction: you may recall I took a live slave for the migration process. And we wanted to end the process with a live slave. So the restriction was: keep it replicating!</p>
<p>How easy would that be? Based on our initial tests, I extrapolated over <strong>20</strong> days of conversion from InnoDB to TokuDB. Even with one table at a time, our largest table was expected to convert in some <strong>12-14</strong> days. Can we retain <strong>14</strong> days of binary logs on a server already running low on disk space? If only I knew then what I know today üôÇ <a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-2-the-process-of-migration#more-6530" class="more-link">Continue reading ¬ª<span class="screen-reader-text"> ‚ÄúConverting an OLAP database to TokuDB, part 2: the process of migration‚Äù</span></a></p>
	</div>

	<footer class="entry-footer">
		<span class="comments-link"><a href="https://shlomi-noach.github.io/blog/mysql/converting-an-olap-database-to-tokudb-part-2-the-process-of-migration#comments">7 Comments<span class="screen-reader-text"> on Converting an OLAP database to TokuDB, part 2: the process of migration</span></a></span>	</footer>
</article>

	<nav class="navigation posts-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Posts navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://shlomi-noach.github.io/blog/2013/page/2">Older posts</a></div></div>
	</nav>
	</main>


	<footer id="colophon" class="site-footer">
		<div class="site-info">
			<a href="https://wordpress.org/">
				Powered by WordPress			</a>
			<span class="sep"> | </span>
				Theme: <a href="http://openark.org">openark-primer</a> by <a href="http://underscores.me/">Underscores.me</a>.		</div>
	</footer>
</div>

	<div style="display:none">
	</div>
<script>
var pollsL10n = {"ajax_url":"https:\/\/shlomi-noach.github.io\/blog\/wp-admin\/admin-ajax.php","text_wait":"Your last request is still being processed. Please wait a while ...","text_valid":"Please choose a valid poll answer.","text_multiple":"Maximum number of choices allowed: ","show_loading":"1","show_fading":"1"};
</script>
<script src="https://shlomi-noach.github.io/blog/wp-content/plugins/wp-polls/polls-js.js"></script>
<script src="https://secure.gravatar.com/js/gprofiles.js?ver=2020Junaa"></script>
<script>
var WPGroHo = {"my_hash":""};
</script>
<script src="https://shlomi-noach.github.io/blog/wp-content/plugins/jetpack/modules/wpgroho.js"></script>
<script src="https://shlomi-noach.github.io/blog/wp-content/themes/openark-primer/js/navigation.js"></script>
<script src="https://shlomi-noach.github.io/blog/wp-content/themes/openark-primer/js/skip-link-focus-fix.js"></script>
<script type="text/javascript" src="https://stats.wp.com/e-202024.js" async="async" defer></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:8.2.1',blog:'32412571',post:'0',tz:'2',srv:'code.openark.org'} ]);
	_stq.push([ 'clickTrackerInit', '32412571', '0' ]);
</script>

</body>
</html>
